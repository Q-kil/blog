<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.2">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false,"b2t":false,"scrollpercent":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="心如止水，潜心修行">
<meta property="og:type" content="website">
<meta property="og:title" content="Kil Notes">
<meta property="og:url" content="http://example.com/page/7/index.html">
<meta property="og:site_name" content="Kil Notes">
<meta property="og:description" content="心如止水，潜心修行">
<meta property="og:locale">
<meta property="article:author" content="kil">
<meta property="article:tag" content="Hexo, NexT">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/page/7/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-Hans'
  };
</script>

  <title>Kil Notes</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta custom-logo">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Kil Notes</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">Quick notes</p>
      <a>
        <img class="custom-logo-image" src="[object Object]" alt="Kil Notes">
      </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="archive fa-fw"></i>Archives</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="th fa-fw"></i>Categories</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/03/02/coding/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kil">
      <meta itemprop="description" content="心如止水，潜心修行">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Kil Notes">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/03/02/coding/" class="post-title-link" itemprop="url">coding</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-03-02 13:02:23" itemprop="dateCreated datePublished" datetime="2020-03-02T13:02:23+08:00">2020-03-02</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/code/" itemprop="url" rel="index"><span itemprop="name">code</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="调试"><a href="#调试" class="headerlink" title="调试"></a>调试</h1><p>获取授权url<br>Method: post<br>URL: <a target="_blank" rel="noopener" href="http://d-gamenc.ethicall.cn/game/nc/auth/oauth">http://d-gamenc.ethicall.cn/game/nc/auth/oauth</a><br>Params: {<br>    redirectUrl: “d-gamenc.ethicall.cn/wx.html#/auth?fr=http%3A%2F%2Flocalhost%3A7457%2F”<br>}<br>Response: {<br>        code: “500”<br>}</p>
<h1 id="编码"><a href="#编码" class="headerlink" title="编码"></a>编码</h1><p>调试<br>重构<br>迭代</p>
<p>版本管理</p>
<h1 id="编码规范"><a href="#编码规范" class="headerlink" title="编码规范"></a>编码规范</h1><h2 id="文件命名"><a href="#文件命名" class="headerlink" title="文件命名"></a>文件命名</h2><p>文件（目录）名全部使用小写字母和连词线（all-lowercase-with-dashes）<br>单个.js 文件可以用驼峰<br>首字母一定要小写*<br><a target="_blank" rel="noopener" href="https://www.ruanyifeng.com/blog/2017/02/filename-should-be-lowercase.html">阮一峰</a><br>文件名全部使用小写字母和连词线（all-lowercase-with-dashes），是一种值得推广的正确做法。</p>
<h3 id="可移植性"><a href="#可移植性" class="headerlink" title="可移植性"></a>可移植性</h3><ul>
<li>Linux系统大小写敏感</li>
<li>Windows系统和Mac系统，大小写不敏感</li>
</ul>
<h3 id="易读性"><a href="#易读性" class="headerlink" title="易读性"></a>易读性</h3><p>小写文件名通常比大写文件名更易读，比如<code>accessibility.txt</code>就比<code>ACCESSIBILITY.TXT</code>易读。</p>
<h3 id="易用性"><a href="#易用性" class="headerlink" title="易用性"></a>易用性</h3><p>系统文件 大写<br>用户文件 小写</p>
<h3 id="便捷性"><a href="#便捷性" class="headerlink" title="便捷性"></a>便捷性</h3><p>文件名全部小写，还有利于命令行操作。比如，某些命令可以不使用<code>-i</code>参数了</p>
<h2 id="Angular-guide"><a href="#Angular-guide" class="headerlink" title="Angular guide"></a>Angular guide</h2><p><a target="_blank" rel="noopener" href="https://angular.io/guide/styleguide">编码规范</a><br><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/90cc5899c40c">Angular代码风格</a></p>
<h1 id="快捷键"><a href="#快捷键" class="headerlink" title="快捷键"></a>快捷键</h1><h2 id="css"><a href="#css" class="headerlink" title="css"></a>css</h2><p>w400 =&gt; width: 400px;</p>
<h2 id="html"><a href="#html" class="headerlink" title="html"></a>html</h2><p>ul&gt;li</p>
<h1 id="other"><a href="#other" class="headerlink" title="other"></a>other</h1><p>中国人的探索精神没有</p>
<img src="/2020/03/02/coding/explore.png" class="">

<h1 id="指导"><a href="#指导" class="headerlink" title="指导"></a>指导</h1><h2 id="页面"><a href="#页面" class="headerlink" title="页面"></a>页面</h2>
<p>我写的太乱了，看不明白，不能理解<br>在service中处理 数据<br>时间的话 util 工具，在视图层处理<br>不利于别人复用维护</p>
<h1 id="待看"><a href="#待看" class="headerlink" title="待看"></a>待看</h1><p><a target="_blank" rel="noopener" href="https://github.com/TheWindRises-2/coco-message">https://github.com/TheWindRises-2/coco-message</a></p>
<h1 id="如何提升自己架构设计的感觉？"><a href="#如何提升自己架构设计的感觉？" class="headerlink" title="如何提升自己架构设计的感觉？"></a>如何提升自己架构设计的感觉？</h1><p>代码的可读性、扩展性、完善自己的加速框架（知识库）。<br>勤于思考，在下笔之前，一定要做结构、图表分析。<br>多沟通，无论是自己的组员还是自己的上司，或者是设计还是产品，往往灵感一触即发。<br>多读第三方的源码，思考为什么作者这样设计，这样做有什么好处和坏处。<br>做垂直领域，完善自己的技术壁垒<br>做宽度领域，多看一些Python、Go、Swift、Java、JS、PHP等语言，见得多才能更全面的分析。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/03/01/Guitar/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kil">
      <meta itemprop="description" content="心如止水，潜心修行">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Kil Notes">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/03/01/Guitar/" class="post-title-link" itemprop="url">Guitar</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-03-01 13:45:45" itemprop="dateCreated datePublished" datetime="2020-03-01T13:45:45+08:00">2020-03-01</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Guitar/" itemprop="url" rel="index"><span itemprop="name">Guitar</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="基础"><a href="#基础" class="headerlink" title="基础"></a>基础</h1><h2 id="弦称"><a href="#弦称" class="headerlink" title="弦称"></a>弦称</h2><p>六弦吉他从最细的开始依次以1~6弦命名之，最细为1弦，最粗为6弦。<br>音高从细到粗分别为：<br>1弦:E<br>2弦:B<br>3弦:G<br>4弦:D<br>5弦:A<br>6弦:E</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/02/27/TypeScript/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kil">
      <meta itemprop="description" content="心如止水，潜心修行">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Kil Notes">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/02/27/TypeScript/" class="post-title-link" itemprop="url">TypeScript</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-02-27 12:19:48" itemprop="dateCreated datePublished" datetime="2020-02-27T12:19:48+08:00">2020-02-27</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/TypeScript/" itemprop="url" rel="index"><span itemprop="name">TypeScript</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="基础"><a href="#基础" class="headerlink" title="基础"></a>基础</h1><h2 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h2><ul>
<li>编译型</li>
<li>强类型（直接帮你做类型检测）</li>
<li>真正面向对象：有接口、有范型、有枚举、有访问修饰符 </li>
</ul>
<h2 id="资料"><a href="#资料" class="headerlink" title="资料"></a>资料</h2><p><a target="_blank" rel="noopener" href="https://ts.xcatliu.com/">https://ts.xcatliu.com/</a><br><a target="_blank" rel="noopener" href="https://jkchao.github.io/typescript-book-chinese/">https://jkchao.github.io/typescript-book-chinese/</a><br>这俩电子书够了，然后日常看源码和代码的时候，也可以学一些高级写法 其实就够了，遇事不决any[旺柴]</p>
<h2 id="CLI"><a href="#CLI" class="headerlink" title="CLI"></a>CLI</h2><h3 id="初始化"><a href="#初始化" class="headerlink" title="初始化"></a>初始化</h3><p>生成tsconfig.json 文件<br>tsc –init</p>
<h3 id="工程引用构建模式"><a href="#工程引用构建模式" class="headerlink" title="工程引用构建模式"></a>工程引用构建模式</h3><p>可以单独的构建一个工程，相关的依赖也会自动构建</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tsc -build src/server --verbose</span><br><span class="line"></span><br><span class="line">--verbose 打印出详细的信息</span><br></pre></td></tr></table></figure>

<h3 id="清空构建的文件"><a href="#清空构建的文件" class="headerlink" title="清空构建的文件"></a>清空构建的文件</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tsc -b test --clean</span><br></pre></td></tr></table></figure>

<h2 id="页面使用ts，时刻记住四个点"><a href="#页面使用ts，时刻记住四个点" class="headerlink" title="页面使用ts，时刻记住四个点"></a>页面使用ts，时刻记住四个点</h2><ol>
<li>你自己定义的变量的类型</li>
<li>宿主环境（浏览器、node）环境下的变量类型，比如 window</li>
<li>第三方框架的类型，可能是1和2的组合</li>
<li>范型等类型的推导，熟练使用工具函数 Omit、Pick、Parial</li>
</ol>
<h1 id="运行"><a href="#运行" class="headerlink" title="运行"></a>运行</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">npm install -g typescript</span><br><span class="line"></span><br><span class="line">tsc hello.ts</span><br><span class="line"></span><br><span class="line">node hello.js</span><br></pre></td></tr></table></figure>

<h2 id="参数"><a href="#参数" class="headerlink" title="参数"></a>参数</h2><p>-p FILE OR DIRECTORY, –project FILE OR DIRECTORY  Compile the project given the path to its configuration file, or to a folder with a ‘tsconfig.json’.</p>
<h1 id="learn"><a href="#learn" class="headerlink" title="learn"></a>learn</h1><p><a target="_blank" rel="noopener" href="https://ts.xcatliu.com/">教程</a></p>
<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>TypeScript 只会进行静态检查，如果发现有错误，编译的时候就会报错。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ tsc hello.ts</span><br><span class="line">hello.ts:6:22 - error TS2345: Argument of type &#x27;number[]&#x27; is not assignable to parameter of type &#x27;string&#x27;.</span><br><span class="line">可转让的</span><br><span class="line">“number[]”类型的参数不能分配给“string”类型的参数。</span><br></pre></td></tr></table></figure>
<p>TypeScript 编译的时候即使报错了，还是会生成编译结果，我们仍然可以使用这个编译之后的文件。</p>
<p>如果要在报错的时候终止 js 文件的生成，可以在 <code>tsconfig.json</code> 中配置 noEmitOnError 即可。关于 <code>tsconfig.json</code>，请参阅<a target="_blank" rel="noopener" href="http://www.typescriptlang.org/docs/handbook/tsconfig-json.html">官方手册</a></p>
<p>ts 编译器 tsc</p>
<h2 id="类型"><a href="#类型" class="headerlink" title="类型"></a>类型</h2><p>ts 类型系统</p>
<h3 id="基本类型"><a href="#基本类型" class="headerlink" title="基本类型"></a>基本类型</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="attr">courseName</span>: <span class="built_in">string</span> = <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line"><span class="keyword">let</span> <span class="attr">age</span>: <span class="built_in">number</span> = <span class="number">18</span>;</span><br><span class="line"><span class="keyword">let</span> <span class="attr">isOnline</span>: <span class="built_in">boolean</span> = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">let</span> <span class="attr">nobody</span>: <span class="literal">null</span> = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">let</span> <span class="attr">course</span>: <span class="built_in">number</span>|<span class="built_in">string</span> = <span class="string">&#x27;kil&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="引用类型"><a href="#引用类型" class="headerlink" title="引用类型"></a>引用类型</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// array</span></span><br><span class="line"><span class="keyword">let</span> <span class="attr">me</span>: [<span class="built_in">string</span>, <span class="built_in">number</span>] = [<span class="string">&#x27;kil&#x27;</span>, <span class="number">18</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">// object 定义类型</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="built_in">number</span>,</span><br><span class="line">  <span class="attr">jobs</span>: <span class="built_in">string</span>[],</span><br><span class="line">  <span class="comment">// readonly 不可修改</span></span><br><span class="line">  <span class="keyword">readonly</span> <span class="attr">cardId</span>: <span class="built_in">string</span>,</span><br><span class="line">  hourse?: <span class="built_in">string</span>,</span><br><span class="line">  <span class="attr">sex</span>: <span class="string">&#x27;男&#x27;</span> | <span class="string">&#x27;女&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 使用object类型</span></span><br><span class="line"><span class="keyword">const</span> <span class="attr">kil</span>:<span class="title class_">Person</span> = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;kil&#x27;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">18</span>,</span><br><span class="line">  <span class="attr">jobs</span>: [<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;2&#x27;</span>],</span><br><span class="line">  <span class="attr">cardId</span>: <span class="string">&#x27;341281&#x27;</span>,</span><br><span class="line">  <span class="attr">sex</span>: <span class="string">&#x27;男&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 函数 定义类型</span></span><br><span class="line"><span class="comment">// 参数和返回值定义类型</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">add</span>(<span class="params">num1: <span class="built_in">number</span>, num2: <span class="built_in">number</span></span>): <span class="built_in">number</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> num1+num2</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 类型定义</span></span><br><span class="line"><span class="keyword">type</span> addType = <span class="function">(<span class="params">a: <span class="built_in">number</span>, b: <span class="built_in">number</span></span>)=&gt;</span><span class="built_in">number</span></span><br><span class="line"><span class="comment">// 接口定义</span></span><br><span class="line"><span class="keyword">interface</span> addType1 &#123;</span><br><span class="line">  (<span class="attr">a</span>: <span class="built_in">number</span>, <span class="attr">b</span>: <span class="built_in">number</span>):<span class="built_in">number</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 使用</span></span><br><span class="line"><span class="keyword">let</span> <span class="attr">add</span>:addType = <span class="keyword">function</span> <span class="title function_">add</span>(<span class="params">num1: <span class="built_in">number</span>, num2: <span class="built_in">number</span></span>): <span class="built_in">number</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> num1+num2</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<h3 id="实战演练-网络请求进阶"><a href="#实战演练-网络请求进阶" class="headerlink" title="实战演练: 网络请求进阶"></a>实战演练: 网络请求进阶</h3><p>规范接口传参</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// function request(url: string, obj: any) &#123;</span></span><br><span class="line"><span class="comment">//   return axios.post(url, obj)</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="keyword">const</span> config = &#123;</span><br><span class="line">  <span class="attr">headers</span>:&#123;</span><br><span class="line">    <span class="attr">header1</span>: value1,</span><br><span class="line">    <span class="attr">header2</span>: value2</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">axios.<span class="title function_">post</span>(url, data, config)</span><br><span class="line"></span><br><span class="line"><span class="comment">// &lt;预先定义一些类型变量，给后面函数用&gt;</span></span><br><span class="line"><span class="keyword">function</span> request&lt;T <span class="keyword">extends</span> keyof <span class="variable constant_">API</span>&gt;(<span class="attr">url</span>: T, <span class="attr">data</span>: <span class="variable constant_">API</span>[T]) &#123;</span><br><span class="line">  <span class="keyword">return</span> axios.<span class="title function_">post</span>(url, obj)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> API &#123;</span><br><span class="line">  <span class="string">&#x27;/course/buy&#x27;</span>: &#123;</span><br><span class="line">    <span class="attr">id</span>: <span class="built_in">number</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&#x27;/course/comment&#x27;</span>: &#123;</span><br><span class="line">    <span class="attr">id</span>: <span class="built_in">number</span>,</span><br><span class="line">    <span class="attr">message</span>: <span class="built_in">string</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">request</span>(<span class="string">&#x27;https://httpbin.org/post&#x27;</span>, &#123;<span class="attr">msg</span>: <span class="string">&#x27;1&#x27;</span>&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h3 id="布尔值"><a href="#布尔值" class="headerlink" title="布尔值"></a>布尔值</h3><p>注意，使用构造函数 Boolean 创造的对象不是布尔值：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="attr">createdByNewBoolean</span>: <span class="built_in">boolean</span> = <span class="keyword">new</span> <span class="title class_">Boolean</span>(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Type &#x27;Boolean&#x27; is not assignable to type &#x27;boolean&#x27;.</span></span><br><span class="line"><span class="comment">//   &#x27;boolean&#x27; is a primitive, but &#x27;Boolean&#x27; is a wrapper object. Prefer using &#x27;boolean&#x27; when possible.</span></span><br></pre></td></tr></table></figure>
<p>事实上 <code>new Boolean()</code> 返回的是一个 Boolean 对象：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="attr">createdByNewBoolean</span>: <span class="title class_">Boolean</span> = <span class="keyword">new</span> <span class="title class_">Boolean</span>(<span class="number">1</span>);</span><br></pre></td></tr></table></figure>

<p>直接调用 Boolean 也可以返回一个 boolean 类型：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="attr">createdByBoolean</span>: <span class="built_in">boolean</span> = <span class="title class_">Boolean</span>(<span class="number">1</span>);</span><br></pre></td></tr></table></figure>
<p>在 TypeScript 中，<code>boolean</code> 是 JavaScript 中的基本类型，而 <code>Boolean</code> 是 JavaScript 中的构造函数。其他基本类型（除了 <code>null</code> 和 <code>undefined</code>）一样，不再赘述。</p>
<h3 id="空值"><a href="#空值" class="headerlink" title="空值"></a>空值</h3><p>JavaScript 没有空值（Void）的概念，在 TypeScript 中，可以用 <code>void</code> 表示没有任何返回值的函数：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">alertName</span>(<span class="params"></span>): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="title function_">alert</span>(<span class="string">&#x27;My name is Tom&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>声明一个 <code>void</code> 类型的变量没有什么用，因为你只能将它赋值为 <code>undefined</code> 和 <code>null</code>：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="attr">unusable</span>: <span class="built_in">void</span> = <span class="literal">undefined</span>;</span><br></pre></td></tr></table></figure>

<h3 id="类型推理-类型推测（隐式类型声明）"><a href="#类型推理-类型推测（隐式类型声明）" class="headerlink" title="类型推理/类型推测（隐式类型声明）"></a>类型推理/类型推测（隐式类型声明）</h3><p>如果没有明确的指定类型，那么 TypeScript 会依照类型推论（Type Inference）的规则推断出一个类型。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> myFavoriteNumber = <span class="string">&#x27;seven&#x27;</span>; <span class="comment">// 等价于 let myFavoriteNumber: string = &#x27;seven&#x27;;</span></span><br><span class="line">myFavoriteNumber = <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// index.ts(2,1): error TS2322: Type &#x27;number&#x27; is not assignable to type &#x27;string&#x27;.</span></span><br></pre></td></tr></table></figure>
<p>如果定义的时候没有赋值，不管之后有没有赋值，都会被推断成 any 类型而完全不被类型检查：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> myFavoriteNumber;</span><br><span class="line">myFavoriteNumber = <span class="string">&#x27;seven&#x27;</span>;</span><br><span class="line">myFavoriteNumber = <span class="number">7</span>;</span><br></pre></td></tr></table></figure>

<h3 id="联合类型"><a href="#联合类型" class="headerlink" title="联合类型"></a>联合类型</h3><p>联合类型（Union Types）表示取值可以为多种类型中的一种。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="attr">myFavoriteNumber</span>: <span class="built_in">string</span> | <span class="built_in">number</span>;</span><br><span class="line">myFavoriteNumber = <span class="string">&#x27;seven&#x27;</span>;</span><br><span class="line">myFavoriteNumber = <span class="number">7</span>;</span><br></pre></td></tr></table></figure>

<h3 id="对象的类型–接口"><a href="#对象的类型–接口" class="headerlink" title="对象的类型–接口"></a>对象的类型–接口</h3><p>在 TypeScript 中，我们使用接口（Interfaces）来定义对象的类型。</p>
<p>在面向对象语言中，接口（Interfaces）是一个很重要的概念，它是对行为的抽象，而具体如何行动需要由类（classes）去实现（implement）。<br>TypeScript 中的接口是一个非常灵活的概念，除了可用于对类的一部分行为进行抽象以外，也常用于对「对象的形状（Shape）」进行描述。</p>
<p>纯数据可以用interface，如果是面向对象的数据，比如有自己的成员方法，可以定义为类。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">    <span class="attr">age</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="attr">tom</span>: <span class="title class_">Person</span> = &#123;</span><br><span class="line"></span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;Tom&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">25</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>上面的例子中，我们定义了一个接口 <code>Person</code>，接着定义了一个变量 <code>tom</code>，它的类型是 <code>Person</code>。这样，我们就约束了 <code>tom</code> 的形状必须和接口 <code>Person</code> 一致。<br>接口一般首字母大写。<a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/previous-versions/dotnet/netframework-1.1/8bc1fexb(v=vs.71)?redirectedfrom=MSDN">有的编程语言中会建议接口的名称加上 I 前缀</a>。</p>
<p>Q：typescript中，类作为类型是怎么回事呢，一般下不是使用接口来定义对象的类型嘛<br>A：类作为类型挺常见的，let a:Box意味着a变量只能存储Box（及其子类）的实例，interface反而比class类型出现的更晚一些</p>
<h4 id="可选属性"><a href="#可选属性" class="headerlink" title="可选属性"></a>可选属性</h4><p>有时我们希望不要完全匹配一个形状，那么可以用可选属性：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">    age?: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="attr">tom</span>: <span class="title class_">Person</span> = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;Tom&#x27;</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h4 id="任意属性"><a href="#任意属性" class="headerlink" title="任意属性"></a>任意属性</h4><p>有时候我们希望一个接口允许有任意的属性，可以使用如下方式：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">    age?: <span class="built_in">number</span>;</span><br><span class="line">    [<span class="attr">propName</span>: <span class="built_in">string</span>]: <span class="built_in">any</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="attr">tom</span>: <span class="title class_">Person</span> = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;Tom&#x27;</span>,</span><br><span class="line">    <span class="attr">gender</span>: <span class="string">&#x27;male&#x27;</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>使用 [propName: string] 定义了任意属性取 string 类型的值。<br>需要注意的是，一旦定义了任意属性，那么确定属性和可选属性的类型都必须是它的类型的子集：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">    age?: <span class="built_in">number</span>;</span><br><span class="line">    [<span class="attr">propName</span>: <span class="built_in">string</span>]: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="attr">tom</span>: <span class="title class_">Person</span> = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;Tom&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">25</span>,</span><br><span class="line">    <span class="attr">gender</span>: <span class="string">&#x27;male&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// index.ts(3,5): error TS2411: Property &#x27;age&#x27; of type &#x27;number&#x27; is not assignable to string index type &#x27;string&#x27;.</span></span><br><span class="line"><span class="comment">// index.ts(7,5): error TS2322: Type &#x27;&#123; [x: string]: string | number; name: string; age: number; gender: string; &#125;&#x27; is not assignable to type &#x27;Person&#x27;.</span></span><br><span class="line"><span class="comment">//   Index signatures are incompatible.</span></span><br><span class="line"><span class="comment">//     Type &#x27;string | number&#x27; is not assignable to type &#x27;string&#x27;.</span></span><br><span class="line"><span class="comment">//       Type &#x27;number&#x27; is not assignable to type &#x27;string&#x27;.</span></span><br></pre></td></tr></table></figure>

<h4 id="只读属性"><a href="#只读属性" class="headerlink" title="只读属性"></a>只读属性</h4><p>有时候我们希望对象中的一些字段只能在创建的时候被赋值，那么可以用 <code>readonly</code> 定义只读属性：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    <span class="keyword">readonly</span> <span class="attr">id</span>: <span class="built_in">number</span>;</span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">    age?: <span class="built_in">number</span>;</span><br><span class="line">    [<span class="attr">propName</span>: <span class="built_in">string</span>]: <span class="built_in">any</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="attr">tom</span>: <span class="title class_">Person</span> = &#123;</span><br><span class="line">    <span class="attr">id</span>: <span class="number">89757</span>,</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;Tom&#x27;</span>,</span><br><span class="line">    <span class="attr">gender</span>: <span class="string">&#x27;male&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">tom.<span class="property">id</span> = <span class="number">9527</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 上例中，使用 readonly 定义的属性 id 初始化后，又被赋值了，所以报错了。</span></span><br><span class="line"><span class="comment">// index.ts(14,5): error TS2540: Cannot assign to &#x27;id&#x27; because it is a constant or a read-only property.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// game-editor</span></span><br><span class="line"><span class="keyword">readonly</span> userKey = <span class="string">&quot;currentUser&quot;</span>;</span><br></pre></td></tr></table></figure>


<h4 id="Partial"><a href="#Partial" class="headerlink" title="Partial"></a>Partial</h4><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">Game</span> &#123;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 游戏ID</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="attr">_id</span>: <span class="built_in">string</span>;</span><br><span class="line"></span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span> = <span class="string">&quot;空白世界&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="attr">description</span>: <span class="built_in">string</span> = <span class="string">&quot;什么都没有的世界，需要玩家自己创造&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="attr">owner</span>: <span class="title class_">Partial</span>&lt;<span class="title class_">User</span>&gt;;</span><br></pre></td></tr></table></figure>
<span class="label yellow">2020.11.4</span>

<p>Partial 作用是将传入的属性变为可选项.<br>首先我们需要理解两个关键字 keyof 和 in, keyof 可以用来取得一个对象接口的所有 key 值.<br>比如</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Foo</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">age</span>: <span class="built_in">number</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">type</span> T = keyof <span class="title class_">Foo</span> <span class="comment">// -&gt; &quot;name&quot; | &quot;age&quot;</span></span><br></pre></td></tr></table></figure>

<p>而 in 则可以遍历枚举类型, 例如</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">Keys</span> = <span class="string">&quot;a&quot;</span> | <span class="string">&quot;b&quot;</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Obj</span> =  &#123;</span><br><span class="line">  [p <span class="keyword">in</span> <span class="title class_">Keys</span>]: <span class="built_in">any</span></span><br><span class="line">&#125; <span class="comment">// -&gt; &#123; a: any, b: any &#125;</span></span><br></pre></td></tr></table></figure>
<p>keyof 产生枚举类型, in 使用枚举类型遍历, 所以他们经常一起使用, 看下 Partial 源码</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">Partial</span>&lt;T&gt; = &#123; [P <span class="keyword">in</span> keyof T]?: T[P] &#125;;</span><br></pre></td></tr></table></figure>

<p>上面语句的意思是 keyof T 拿到 T 所有属性名, 然后 in 进行遍历, 将值赋给 P, 最后 T[P] 取得相应属性的值.<br>结合中间的 ? 我们就明白了 Partial 的含义了.</p>
<h3 id="数组的类型"><a href="#数组的类型" class="headerlink" title="数组的类型"></a>数组的类型</h3><p>在 TypeScript 中，数组类型有多种定义方式，比较灵活。</p>
<h4 id="「类型-方括号」表示法"><a href="#「类型-方括号」表示法" class="headerlink" title="「类型 + 方括号」表示法"></a>「类型 + 方括号」表示法</h4><p>最简单的方法是使用「类型 + 方括号」来表示数组：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="attr">fibonacci</span>: <span class="built_in">number</span>[] = [<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>];</span><br></pre></td></tr></table></figure>

<h4 id="数组泛型"><a href="#数组泛型" class="headerlink" title="数组泛型"></a>数组泛型</h4><p>Array关键字，Array范型接口<br>我们也可以使用数组泛型（Array Generic） <code>Array&lt;elemType&gt;</code> 来表示数组：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="attr">fibonacci</span>: <span class="title class_">Array</span>&lt;<span class="built_in">number</span>&gt; = [<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>];</span><br></pre></td></tr></table></figure>
<p>Array 是ts预定义的范型接口 </p>
<h4 id="用接口表示数组"><a href="#用接口表示数组" class="headerlink" title="用接口表示数组"></a>用接口表示数组</h4><p>接口也可以用来描述数组：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">NumberArray</span> &#123;</span><br><span class="line">    [<span class="attr">index</span>: <span class="built_in">number</span>]: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> <span class="attr">fibonacci</span>: <span class="title class_">NumberArray</span> = [<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>];</span><br></pre></td></tr></table></figure>

<h4 id="类数组"><a href="#类数组" class="headerlink" title="类数组"></a>类数组</h4><p>类数组（Array-like Object）不是数组类型，比如 arguments：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">sum</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="attr">args</span>: <span class="built_in">number</span>[] = <span class="variable language_">arguments</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Type &#x27;IArguments&#x27; is missing the following properties from type &#x27;number[]&#x27;: pop, push, concat, join, and 24 more.</span></span><br></pre></td></tr></table></figure>
<p>上例中，arguments 实际上是一个类数组，不能用普通的数组的方式来描述，而应该用接口：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">sum</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="attr">args</span>: &#123;</span><br><span class="line">        [<span class="attr">index</span>: <span class="built_in">number</span>]: <span class="built_in">number</span>;</span><br><span class="line">        <span class="attr">length</span>: <span class="built_in">number</span>;</span><br><span class="line">        <span class="attr">callee</span>: <span class="title class_">Function</span>;</span><br><span class="line">    &#125; = <span class="variable language_">arguments</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="数组的联合类型"><a href="#数组的联合类型" class="headerlink" title="数组的联合类型"></a>数组的联合类型</h4><p>语法：两种类型之间加一个 竖线</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="attr">arr2</span>: <span class="title class_">Array</span>&lt;<span class="built_in">number</span> | <span class="built_in">string</span>&gt; = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="string">&#x27;4&#x27;</span>]</span><br></pre></td></tr></table></figure>

<h4 id="any-在数组中的应用"><a href="#any-在数组中的应用" class="headerlink" title="any 在数组中的应用"></a>any 在数组中的应用</h4><p>一个比较常见的做法是，用 any 表示数组中允许出现任意类型：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="attr">list</span>: <span class="built_in">any</span>[] = [<span class="string">&#x27;xcatliu&#x27;</span>, <span class="number">25</span>, &#123; <span class="attr">website</span>: <span class="string">&#x27;http://xcatliu.com&#x27;</span> &#125;];</span><br></pre></td></tr></table></figure>

<h3 id="元组类型"><a href="#元组类型" class="headerlink" title="元组类型"></a>元组类型</h3><p>限定数组长度和类型</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="attr">tuple</span>: [<span class="built_in">number</span>, <span class="built_in">string</span>] = [<span class="number">1</span>, <span class="string">&#x27;2&#x27;</span>]</span><br></pre></td></tr></table></figure>

<h3 id="函数的类型"><a href="#函数的类型" class="headerlink" title="函数的类型"></a>函数的类型</h3><p><a target="_blank" rel="noopener" href="https://llh911001.gitbooks.io/mostly-adequate-guide-chinese/content/ch2.html">函数是 JavaScript 中的一等公民</a></p>
<h4 id="函数声明"><a href="#函数声明" class="headerlink" title="函数声明"></a>函数声明</h4><p>在 JavaScript 中，有两种常见的定义函数的方式——函数声明（Function Declaration）和函数表达式（Function Expression）：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 函数声明（Function Declaration）</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">sum</span>(<span class="params">x, y</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> x + y;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 函数表达式（Function Expression）</span></span><br><span class="line"><span class="keyword">let</span> mySum = <span class="keyword">function</span> (<span class="params">x, y</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> x + y;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>一个函数有输入和输出，要在 TypeScript 中对其进行约束，需要把输入和输出都考虑到，其中函数声明的类型定义较简单：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">sum</span>(<span class="params">x: <span class="built_in">number</span>, y: <span class="built_in">number</span></span>): <span class="built_in">number</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> x + y;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>函数返回类型可以省略，因为ts有类型推断功能</p>
<h4 id="函数表达式"><a href="#函数表达式" class="headerlink" title="函数表达式"></a>函数表达式</h4><p>如果要我们现在写一个对函数表达式（Function Expression）的定义，可能会写成这样：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> mySum = <span class="keyword">function</span> (<span class="params">x: <span class="built_in">number</span>, y: <span class="built_in">number</span></span>): <span class="built_in">number</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> x + y;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>这是可以通过编译的，不过事实上，上面的代码只对等号右侧的匿名函数进行了类型定义，而等号左边的 mySum，是通过赋值操作进行类型推论而推断出来的。如果需要我们手动给 mySum 添加类型，则应该是这样：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="attr">mySum</span>: <span class="function">(<span class="params">x: <span class="built_in">number</span>, y: <span class="built_in">number</span></span>) =&gt;</span> <span class="built_in">number</span> = <span class="keyword">function</span> (<span class="params">x: <span class="built_in">number</span>, y: <span class="built_in">number</span></span>): <span class="built_in">number</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> x + y;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>注意不要混淆了 TypeScript 中的 =&gt; 和 ES6 中的 =&gt;。<br>在 TypeScript 的类型定义中，=&gt; 用来表示函数的定义，左边是输入类型，需要用括号括起来，右边是输出类型。<br>在 ES6 中，=&gt; 叫做箭头函数，应用十分广泛，可以参考 <a target="_blank" rel="noopener" href="http://es6.ruanyifeng.com/#docs/function#%E7%AE%AD%E5%A4%B4%E5%87%BD%E6%95%B0">ES6 中的箭头函数</a>。</p>
<h4 id="用接口定义函数的形状"><a href="#用接口定义函数的形状" class="headerlink" title="用接口定义函数的形状"></a>用接口定义函数的形状</h4><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">SearchFunc</span> &#123;</span><br><span class="line">    (<span class="attr">source</span>: <span class="built_in">string</span>, <span class="attr">subString</span>: <span class="built_in">string</span>): <span class="built_in">boolean</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="attr">mySearch</span>: <span class="title class_">SearchFunc</span>;</span><br><span class="line">mySearch = <span class="keyword">function</span>(<span class="params">source: <span class="built_in">string</span>, subString: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> source.<span class="title function_">search</span>(subString) !== -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="参数默认值"><a href="#参数默认值" class="headerlink" title="参数默认值"></a>参数默认值</h4><p>在 ES6 中，我们允许给函数的参数添加默认值，TypeScript 会将添加了默认值的参数识别为可选参数：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">buildName</span>(<span class="params">firstName: <span class="built_in">string</span>, lastName: <span class="built_in">string</span> = <span class="string">&#x27;Cat&#x27;</span></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> firstName + <span class="string">&#x27; &#x27;</span> + lastName;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> tomcat = <span class="title function_">buildName</span>(<span class="string">&#x27;Tom&#x27;</span>, <span class="string">&#x27;Cat&#x27;</span>);</span><br><span class="line"><span class="keyword">let</span> tom = <span class="title function_">buildName</span>(<span class="string">&#x27;Tom&#x27;</span>);</span><br></pre></td></tr></table></figure>
<p>此时就不受「可选参数必须接在必需参数后面」的限制了：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">buildName</span>(<span class="params">firstName: <span class="built_in">string</span> = <span class="string">&#x27;Tom&#x27;</span>, lastName: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> firstName + <span class="string">&#x27; &#x27;</span> + lastName;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> tomcat = <span class="title function_">buildName</span>(<span class="string">&#x27;Tom&#x27;</span>, <span class="string">&#x27;Cat&#x27;</span>);</span><br><span class="line"><span class="keyword">let</span> cat = <span class="title function_">buildName</span>(<span class="literal">undefined</span>, <span class="string">&#x27;Cat&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h4 id="剩余参数"><a href="#剩余参数" class="headerlink" title="剩余参数"></a>剩余参数</h4><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">push</span>(<span class="params">array, ...items</span>) &#123;</span><br><span class="line">    items.<span class="title function_">forEach</span>(<span class="keyword">function</span>(<span class="params">item</span>) &#123;</span><br><span class="line">        array.<span class="title function_">push</span>(item);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> a = [];</span><br><span class="line"><span class="title function_">push</span>(a, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>);</span><br></pre></td></tr></table></figure>

<h4 id="重载"><a href="#重载" class="headerlink" title="重载"></a>重载</h4><p>重载允许一个函数接受不同数量或类型的参数时，作出不同的处理。<br>比如，我们需要实现一个函数 reverse，输入数字 123 的时候，输出反转的数字 321，输入字符串 ‘hello’ 的时候，输出反转的字符串 ‘olleh’。<br>利用联合类型，我们可以这么实现：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">reverse</span>(<span class="params">x: <span class="built_in">number</span> | <span class="built_in">string</span></span>): <span class="built_in">number</span> | <span class="built_in">string</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> x === <span class="string">&#x27;number&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title class_">Number</span>(x.<span class="title function_">toString</span>().<span class="title function_">split</span>(<span class="string">&#x27;&#x27;</span>).<span class="title function_">reverse</span>().<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>));</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> x === <span class="string">&#x27;string&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> x.<span class="title function_">split</span>(<span class="string">&#x27;&#x27;</span>).<span class="title function_">reverse</span>().<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然而这样有一个缺点，就是不能够精确的表达，输入为数字的时候，输出也应该为数字，输入为字符串的时候，输出也应该为字符串。<br>这时，我们可以使用重载定义多个 reverse 的函数类型：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">reverse</span>(<span class="params">x: <span class="built_in">number</span></span>): <span class="built_in">number</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">reverse</span>(<span class="params">x: <span class="built_in">string</span></span>): <span class="built_in">string</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">reverse</span>(<span class="params">x: <span class="built_in">number</span> | <span class="built_in">string</span></span>): <span class="built_in">number</span> | <span class="built_in">string</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> x === <span class="string">&#x27;number&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title class_">Number</span>(x.<span class="title function_">toString</span>().<span class="title function_">split</span>(<span class="string">&#x27;&#x27;</span>).<span class="title function_">reverse</span>().<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>));</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> x === <span class="string">&#x27;string&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> x.<span class="title function_">split</span>(<span class="string">&#x27;&#x27;</span>).<span class="title function_">reverse</span>().<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>上例中，我们重复定义了多次函数 reverse，前几次都是函数定义，最后一次是函数实现。在编辑器的代码提示中，可以正确的看到前两个提示。<br>注意，TypeScript 会优先从最前面的函数定义开始匹配，所以多个函数定义如果有包含关系，需要优先把精确的定义写在前面。</p>
<h4 id="函数签名"><a href="#函数签名" class="headerlink" title="函数签名"></a>函数签名</h4><p>success: (a, b) =&gt; void</p>
<h3 id="类型断言"><a href="#类型断言" class="headerlink" title="类型断言"></a>类型断言</h3><h4 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h4><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;类型&gt;值</span><br><span class="line"><span class="comment">// 或</span></span><br><span class="line">值 <span class="keyword">as</span> 类型</span><br></pre></td></tr></table></figure>

<h4 id="编辑器例子"><a href="#编辑器例子" class="headerlink" title="编辑器例子"></a>编辑器例子</h4><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">destory</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">_cap</span> = &#123;&#125; <span class="keyword">as</span> <span class="title class_">Capsule</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="例子：将一个联合类型的变量指定为一个更加具体的类型"><a href="#例子：将一个联合类型的变量指定为一个更加具体的类型" class="headerlink" title="例子：将一个联合类型的变量指定为一个更加具体的类型"></a>例子：将一个联合类型的变量指定为一个更加具体的类型</h4><p>有时候，我们确实需要在还不确定类型的时候就访问其中一个类型的属性或方法，比如</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">getLength</span>(<span class="params">something: <span class="built_in">string</span> | <span class="built_in">number</span></span>): <span class="built_in">number</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (something.<span class="property">length</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> something.<span class="property">length</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> something.<span class="title function_">toString</span>().<span class="property">length</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// index.ts(2,19): error TS2339: Property &#x27;length&#x27; does not exist on type &#x27;string | number&#x27;.</span></span><br><span class="line"><span class="comment">//   Property &#x27;length&#x27; does not exist on type &#x27;number&#x27;.</span></span><br><span class="line"><span class="comment">// index.ts(3,26): error TS2339: Property &#x27;length&#x27; does not exist on type &#x27;string | number&#x27;.</span></span><br><span class="line"><span class="comment">//   Property &#x27;length&#x27; does not exist on type &#x27;number&#x27;.</span></span><br></pre></td></tr></table></figure>

<p>上例中，获取 something.length 的时候会报错。<br>此时可以使用类型断言，将 something 断言成 string：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">getLength</span>(<span class="params">something: <span class="built_in">string</span> | <span class="built_in">number</span></span>): <span class="built_in">number</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> ((&lt;<span class="built_in">string</span>&gt;something).<span class="property">length</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> (&lt;<span class="built_in">string</span>&gt;something).<span class="property">length</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> something.<span class="title function_">toString</span>().<span class="property">length</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>类型断言不是类型转换，断言成一个联合类型中不存在的类型是不允许的.</p>
<h3 id="外部变量声明"><a href="#外部变量声明" class="headerlink" title="外部变量声明"></a>外部变量声明</h3><p>declare var 名字</p>
<p>声明文件<br>global.d.ts</p>
<h2 id="接口"><a href="#接口" class="headerlink" title="接口"></a>接口</h2><p>interface</p>
<h3 id="概念-1"><a href="#概念-1" class="headerlink" title="概念"></a>概念</h3><p>约定、限制</p>
<span class="label blue">2020/7/21 添加</span>
<p>如果实现 <code>implements</code> 了接口interface，则 在类中必须有接口的所有成员（属性），否则ts报错<br>Angular例子：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">GameComponent</span> <span class="keyword">implements</span> <span class="title class_">OnInit</span>, <span class="title class_">OnDestroy</span> &#123;</span><br><span class="line">  <span class="title function_">ngOnInit</span>(<span class="params"></span>) &#123;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">ngOnDestroy</span>(<span class="params"></span>) &#123;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure>

<h3 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Point</span> &#123;</span><br><span class="line">  <span class="attr">x</span>: <span class="built_in">number</span>,</span><br><span class="line">  <span class="attr">y</span>: <span class="built_in">number</span>,</span><br><span class="line">  z?: <span class="built_in">number</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="attr">p</span>: <span class="title class_">Point</span>;</span><br><span class="line">p = &#123;<span class="attr">x</span>:<span class="number">12</span>, <span class="attr">y</span>:<span class="number">5</span>&#125;</span><br></pre></td></tr></table></figure>

<h2 id="面向对象"><a href="#面向对象" class="headerlink" title="面向对象"></a>面向对象</h2><h3 id="访问修饰符"><a href="#访问修饰符" class="headerlink" title="访问修饰符"></a>访问修饰符</h3><p>public     公有          任何人可以访问<br>private    私有          只有类内部可以访问<br>protected  受保护的-友元   只有子类能用</p>
<h2 id="泛型"><a href="#泛型" class="headerlink" title="泛型"></a>泛型</h2><p>别根‘any’搞混了<br>泛：宽泛</p>
<h2 id="例子-1"><a href="#例子-1" class="headerlink" title="例子"></a>例子</h2><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Calc</span>&lt;T&gt; &#123;</span><br><span class="line">  <span class="attr">a</span>: T;</span><br><span class="line">  <span class="attr">b</span>: T;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj = <span class="keyword">new</span> <span class="title class_">Calc</span>&lt;<span class="built_in">number</span>&gt;();</span><br><span class="line">obj.<span class="property">a</span> = <span class="number">12</span>;</span><br></pre></td></tr></table></figure>

<h1 id="封装"><a href="#封装" class="headerlink" title="封装"></a>封装</h1><h2 id="Class"><a href="#Class" class="headerlink" title="Class"></a>Class</h2><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">EditGameParameters</span> &#123;</span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">string</span>; <span class="comment">// sn</span></span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">version</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">username</span>: <span class="built_in">string</span>;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">init?: Partial&lt;EditGameParameters&gt;</span>) &#123;</span><br><span class="line">    <span class="title class_">Object</span>.<span class="title function_">assign</span>(<span class="variable language_">this</span>, init);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>购物车功能<br><strong>Model</strong>：购物车内商品item（商品，数量），购物车（商品item集合）<br><strong>View</strong>：购物车模板<br><strong>Controller</strong>: 购物车组件</p>
<h3 id="Model"><a href="#Model" class="headerlink" title="Model"></a>Model</h3><h4 id="cartItem-model-ts"><a href="#cartItem-model-ts" class="headerlink" title="cartItem.model.ts"></a>cartItem.model.ts</h4><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">ICommodity</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;../mall/mall.model&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">User</span> &#125; <span class="keyword">from</span> <span class="string">&quot;../user/user.model&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">CartItem</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="attr">quantity</span>: <span class="built_in">number</span>;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span></span><br><span class="line"><span class="params">    <span class="keyword">private</span> _id: <span class="built_in">string</span>,</span></span><br><span class="line"><span class="params">    <span class="keyword">private</span> checked: <span class="built_in">boolean</span>,</span></span><br><span class="line"><span class="params">    <span class="keyword">private</span> commodity: ICommodity,</span></span><br><span class="line"><span class="params">    <span class="keyword">private</span> owner: User</span></span><br><span class="line"><span class="params">  </span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">quantity</span> = <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">get</span> <span class="title function_">__id</span>(): <span class="built_in">string</span> &#123; <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">_id</span>; &#125;</span><br><span class="line">  <span class="keyword">get</span> <span class="title function_">_checked</span>(): <span class="built_in">boolean</span> &#123; <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">checked</span>; &#125;</span><br><span class="line">  <span class="keyword">get</span> <span class="title function_">_commodity</span>(): <span class="title class_">ICommodity</span> &#123; <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">commodity</span>; &#125;</span><br><span class="line">  <span class="keyword">get</span> <span class="title function_">_owner</span>(): <span class="title class_">User</span> &#123; <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">owner</span>; &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 数量的增减</span></span><br><span class="line">  <span class="title function_">decreaseQuantity</span>(): <span class="built_in">number</span> &#123;</span><br><span class="line">    <span class="comment">// service update</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">cartService</span>.<span class="title function_">update</span>(&#123;</span><br><span class="line">        <span class="attr">commodity</span>: <span class="variable language_">this</span>.<span class="property">commdity</span>.<span class="property">_id</span>,</span><br><span class="line">        <span class="attr">checked</span>: <span class="variable language_">this</span>.<span class="property">checked</span>,</span><br><span class="line">        <span class="attr">quantity</span>: --<span class="variable language_">this</span>.<span class="property">quantity</span></span><br><span class="line">    &#125;).<span class="title function_">subscribe</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">quantity</span>; </span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">increaseQuantity</span>(): <span class="built_in">number</span> &#123; <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">quantity</span>++; &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// item 总价格</span></span><br><span class="line">  <span class="keyword">get</span> <span class="title function_">commodityTotal</span>(): <span class="built_in">number</span> &#123; <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">quantity</span> * <span class="variable language_">this</span>.<span class="property">commodity</span>.<span class="property">price</span>; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="cart-model-ts"><a href="#cart-model-ts" class="headerlink" title="cart.model.ts"></a>cart.model.ts</h4><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">CartItem</span> &#125; <span class="keyword">from</span> <span class="string">&quot;./cartItem.model&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">Cart</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="attr">content</span>: <span class="title class_">Array</span>&lt;<span class="title class_">CartItem</span>&gt;;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">content</span> = <span class="keyword">new</span> <span class="title class_">Array</span>&lt;<span class="title class_">CartItem</span>&gt;(); </span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 购物车中所有的商品</span></span><br><span class="line">  <span class="title function_">getContent</span>(): <span class="title class_">Array</span>&lt;<span class="title class_">CartItem</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">content</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 选中的商品总价格</span></span><br><span class="line">  <span class="keyword">get</span> <span class="title function_">selectedTotal</span>(): <span class="built_in">number</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> total = <span class="number">0</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">content</span>.<span class="title function_">forEach</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (item.<span class="property">_checked</span>) &#123;</span><br><span class="line">        total += item.<span class="property">commodityTotal</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> total;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">addItem</span>(<span class="params">item:CartItem</span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> cartItem = <span class="keyword">new</span> <span class="title class_">CartItem</span>(item.<span class="property">_id</span>, item.<span class="property">checked</span>, item.<span class="property">commodity</span>, item.<span class="property">owner</span>);</span><br><span class="line">        <span class="keyword">let</span> <span class="attr">found</span>:<span class="built_in">boolean</span> = <span class="literal">false</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_content</span>.<span class="title function_">forEach</span>(<span class="keyword">function</span>(<span class="params">item</span>) &#123;</span><br><span class="line">            <span class="comment">// 判断购物车中是否有该商品，有商品就数量加一</span></span><br><span class="line">            <span class="keyword">if</span> (item.<span class="property">_id</span> == cartItem.<span class="property">_id</span>) &#123;</span><br><span class="line">                item.<span class="title function_">increaseAmount</span>();</span><br><span class="line">                found = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 没有找到商品，添加</span></span><br><span class="line">        <span class="keyword">if</span>(!found) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">cartService</span>.<span class="title function_">add</span>(cartItem).<span class="title function_">subscribe</span>(</span><br><span class="line">                <span class="function">() =&gt;</span> &#123;</span><br><span class="line">                    <span class="comment">// 添加成功后？ push or get</span></span><br><span class="line">                    <span class="variable language_">this</span>.<span class="property">_content</span>.<span class="title function_">push</span>(cartItem);</span><br><span class="line"></span><br><span class="line">                    <span class="variable language_">this</span>.<span class="title function_">getitems</span>();</span><br><span class="line">                &#125;</span><br><span class="line">            ) </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">getItems</span>(): <span class="built_in">void</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">cartService</span>.<span class="title function_">get</span>().<span class="title function_">subscribe</span>(</span><br><span class="line">          <span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">content</span> = res;</span><br><span class="line">          &#125;</span><br><span class="line">      );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">toggleChecked</span>(<span class="params">parame</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">httpCommonService</span>.<span class="title function_">postCommon</span>(<span class="string">&quot;cart/toggle_checked_all&quot;</span>, parame).<span class="title function_">subscribe</span>(</span><br><span class="line">      <span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;toggle&quot;</span>, res);</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">getCartItems</span>();</span><br><span class="line">      &#125;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">removeItem</span>(<span class="params">parame</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">httpCommonService</span>.<span class="title function_">postCommon</span>(<span class="string">&quot;cart/delete&quot;</span>, &#123; <span class="attr">commodityIds</span>: parame &#125;).<span class="title function_">subscribe</span>(</span><br><span class="line">      <span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;delete&quot;</span>, res);</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">alertService</span>.<span class="title function_">alertSuccess</span>(<span class="string">&quot;删除成功&quot;</span>);</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">getCartItems</span>();</span><br><span class="line">      &#125;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h4 id="cart-component-ts"><a href="#cart-component-ts" class="headerlink" title="cart.component.ts"></a>cart.component.ts</h4><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">CartComponent</span> <span class="keyword">implements</span> <span class="title class_">OnInit</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span></span><br><span class="line"><span class="params">    <span class="keyword">public</span> cartService: CartService,</span></span><br><span class="line"><span class="params">    <span class="keyword">private</span> router: Router,</span></span><br><span class="line"><span class="params">    <span class="keyword">private</span> alertService: AlertService,</span></span><br><span class="line"><span class="params">    <span class="keyword">private</span> personalService: PersonalService,</span></span><br><span class="line"><span class="params">    <span class="keyword">private</span> cartsSubjectService: CartSubjectService,</span></span><br><span class="line"><span class="params">    <span class="keyword">private</span> cartSubjectService: CartSubjectService,</span></span><br><span class="line"><span class="params">  </span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">cartSubjectService</span>.<span class="title function_">cartsInit</span>(<span class="literal">true</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">ngOnInit</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">cartSubjectService</span>.<span class="property">carts</span>.<span class="title function_">subscribe</span>(</span><br><span class="line">      <span class="function">(<span class="params">carts: <span class="built_in">any</span>[]</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">commodityIds</span> = carts.<span class="title function_">map</span>(<span class="function"><span class="params">doc</span> =&gt;</span> doc.<span class="property">commodity</span>.<span class="property">_id</span>);</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">checkedIds</span> = _.<span class="title function_">filter</span>(carts, &#123;<span class="string">&#x27;checked&#x27;</span>: <span class="literal">true</span>&#125;);</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">carts</span> = _.<span class="title function_">groupBy</span>(carts, <span class="string">&quot;commodity.owner.nickname&quot;</span>);</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">itemChecked</span>();</span><br><span class="line">      &#125;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="namespace-命名空间"><a href="#namespace-命名空间" class="headerlink" title="namespace 命名空间"></a>namespace 命名空间</h2><p>如果你发现自己写的功能(函数/类/接口等…)越来越多, 你想对他们进行分组管理就可以用命名空间</p>
<h2 id="存取器"><a href="#存取器" class="headerlink" title="存取器"></a>存取器</h2><p>set、get</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">get</span> <span class="title function_">currentUser</span>(): <span class="title class_">User</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> localStore.<span class="title function_">get</span>(<span class="variable language_">this</span>.<span class="property">userKey</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="TS-开发实战"><a href="#TS-开发实战" class="headerlink" title="TS 开发实战"></a>TS 开发实战</h1><p>深入理解 TypeScript 核心概念；<br>熟练进行 TypeScript 工程配置；<br>玩转四种典型前端应用的开发；<br>重塑“类型思维”，提升编程素养。</p>
<h2 id="Atwood-定律"><a href="#Atwood-定律" class="headerlink" title="Atwood 定律"></a>Atwood 定律</h2><p>任何能用 JavaScript 实现的应用，最终都会用 JavaScript 实现</p>
<p>无处不在：<br>移动终端（手机、笔记本、平板电脑） ——&gt; 后端服务<br>IoT（物联网 Internet of things） ——&gt; 神经网络（人工智能的底层模型是”神经网络”（neural network））</p>
<p>语言的应用之广应该具有的特点：<br>安全性、健壮性和可维护性有更高的要求。</p>
<h2 id="为什么会有-ts"><a href="#为什么会有-ts" class="headerlink" title="为什么会有 ts"></a>为什么会有 ts</h2><p>JavaScript 是门动态类型语言<br>一：搞清楚参数类型，你只能硬着头皮去看里面的逻辑<br>二：为了保证代码的健壮性，对一个函数的输入参数进行各种假设<br>三：优化了一个参数类型，但不知道有多少处引用，在提交代码前<br>四：联调就报错了：“TypeError: Cannot read property ‘length’ of undefined“ 给对接人说这是数组</p>
<h3 id="解决动态类型语言的其他库"><a href="#解决动态类型语言的其他库" class="headerlink" title="解决动态类型语言的其他库"></a>解决动态类型语言的其他库</h3><p>2014   Fackbook   Flow<br>2014   Microsoft  TypeScript</p>
<p>都为JavaScript提供静态类型检查</p>
<h2 id="what-is-ts"><a href="#what-is-ts" class="headerlink" title="what is ts"></a>what is ts</h2><p>拥有类型系统的JavaScript的超集，可以编译纯JavaScript</p>
<ul>
<li>类型检查</li>
<li>语言扩展<br>接口，抽象类</li>
<li>工具属性</li>
</ul>
<p>束缚js这匹野马的缰绳，即可闲庭信步，亦可策马扬鞭；前端开发之路走得更稳，走得更远</p>
<h2 id="课程介绍"><a href="#课程介绍" class="headerlink" title="课程介绍"></a>课程介绍</h2><p>基础篇<br>工程篇（理论和实践之间，存在不小的鸿沟）<br>实战篇（四个案例）</p>
<p>目标：类型思维；思维方式决定编程习惯，编程习惯奠定工程质量，工程质量划定了能力边界。不仅讲知识点和应用，更是训练思维。</p>
<h2 id="基础篇"><a href="#基础篇" class="headerlink" title="基础篇"></a>基础篇</h2><h3 id="强类型与弱类型"><a href="#强类型与弱类型" class="headerlink" title="强类型与弱类型"></a>强类型与弱类型</h3><p>强类型语言：不允许改变变量的数据类型，除非进行强制类型转换<br>弱类型语言：变量可以被赋予不同的数据类型</p>
<h3 id="动态类型与静态类型"><a href="#动态类型与静态类型" class="headerlink" title="动态类型与静态类型"></a>动态类型与静态类型</h3><p>静态类型语言：在编译阶段确定所有变量的类型<br>动态类型语言：在执行阶段确定所有变量的类型</p>
<h3 id="基本类型-1"><a href="#基本类型-1" class="headerlink" title="基本类型"></a>基本类型</h3><h4 id="类型注解"><a href="#类型注解" class="headerlink" title="类型注解"></a>类型注解</h4><p>语法 ：(变量/函数): type<br>作用 ：相当于强类型语言中的类型声明<br>好处 ：</p>
<p>静态编译时检查类型。类型操作不合理时，编译器会警告，如： Type ‘string’ is not assignable to type ‘boolean’。<br>作为文档。在 VSCode 中将光标移到 bar 上时，会提示 let bar: boolean。</p>
<h4 id="对象"><a href="#对象" class="headerlink" title="对象"></a>对象</h4><p>let obj: object = {x: 1, y: 2}<br>正确的定义：<br>let obj: {x: number, y: number} = {x: 1, y: 2}<br>obj.x = 3</p>
<h4 id="undefined"><a href="#undefined" class="headerlink" title="undefined"></a>undefined</h4><p>let un: undefined = undefined (只能赋值他本身)</p>
<h4 id="void"><a href="#void" class="headerlink" title="void"></a>void</h4><p>let onReture = () =&gt; {}</p>
<h4 id="any"><a href="#any" class="headerlink" title="any"></a>any</h4><p>不是特殊情况不建议使用any，要不然就不要使用ts了</p>
<h4 id="never"><a href="#never" class="headerlink" title="never"></a>never</h4><p>let error = () =&gt; {<br>  throw new Error(‘error’)<br>}</p>
<h3 id="枚举类型"><a href="#枚举类型" class="headerlink" title="枚举类型"></a>枚举类型</h3><img src="/2020/02/27/TypeScript/role.png" class="">
<img src="/2020/02/27/TypeScript/phone.png" class="">
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> <span class="title class_">Role</span> &#123;</span><br><span class="line">  <span class="title class_">Reporter</span>,</span><br><span class="line">  <span class="title class_">Developer</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="接口-1"><a href="#接口-1" class="headerlink" title="接口"></a>接口</h3><h4 id="对象接口类型"><a href="#对象接口类型" class="headerlink" title="对象接口类型"></a>对象接口类型</h4><p>数据请求</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">List</span> &#123;</span><br><span class="line">  <span class="comment">// 只读属性</span></span><br><span class="line">  <span class="keyword">readonly</span> <span class="attr">id</span>: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="comment">// 判断有没有某个属性</span></span><br><span class="line">  age?: <span class="built_in">number</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Result</span> &#123;</span><br><span class="line">  <span class="attr">data</span>: <span class="title class_">List</span>[]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">render</span>(<span class="params">result: Result</span>) &#123;</span><br><span class="line">  result.<span class="property">data</span>.<span class="title function_">forEach</span>(<span class="function">(<span class="params">value</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(value.<span class="property">id</span>, value.<span class="property">name</span>)</span><br><span class="line">    <span class="keyword">if</span>(value.<span class="property">age</span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(value.<span class="property">age</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> result = &#123;</span><br><span class="line">  <span class="attr">data</span>: [</span><br><span class="line">    &#123;<span class="attr">id</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">&#x27;A&#x27;</span>, <span class="attr">sex</span>: <span class="string">&#x27;male&#x27;</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">id</span>: <span class="number">2</span>, <span class="attr">name</span>: <span class="string">&#x27;B&#x27;</span>&#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">render</span>(result)</span><br></pre></td></tr></table></figure>

<h3 id="函数类型接口"><a href="#函数类型接口" class="headerlink" title="函数类型接口"></a>函数类型接口</h3><p>混合类型接口</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Lib</span> &#123;</span><br><span class="line">  (): <span class="built_in">void</span>;</span><br><span class="line">  <span class="attr">version</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="title function_">doSomething</span>(): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">实现</span><br><span class="line"><span class="keyword">let</span> <span class="attr">lib</span>: <span class="title class_">Lib</span> = (<span class="function">() =&gt;</span> &#123;&#125;) <span class="keyword">as</span> <span class="title class_">Lib</span>; <span class="comment">// 类型断言，明确知道lib类型是Lib</span></span><br><span class="line">lib.<span class="property">version</span> = <span class="string">&#x27;1.0&#x27;</span>;</span><br><span class="line">lib.<span class="property">doSomething</span> = <span class="function">() =&gt;</span> &#123;&#125;;</span><br></pre></td></tr></table></figure>
<p>上例缺点是 向全局暴露了一个变量lib，它是一个单例；如果想创建多个lib，需要用函数封装一下</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">getLib</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> <span class="attr">lib</span>: <span class="title class_">Lib</span> = (<span class="function">() =&gt;</span> &#123;&#125;) <span class="keyword">as</span> <span class="title class_">Lib</span>;</span><br><span class="line">  lib.<span class="property">version</span> = <span class="string">&#x27;1.0&#x27;</span>;</span><br><span class="line">  lib.<span class="property">doSomething</span> = <span class="function">() =&gt;</span> &#123;&#125;;</span><br><span class="line">  <span class="keyword">return</span> lib;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 创建多个实例</span></span><br><span class="line"><span class="keyword">let</span> lib1 = <span class="title function_">getLib</span>();</span><br><span class="line"><span class="title function_">lib1</span>();</span><br><span class="line">lib1.<span class="title function_">doSomething</span>();</span><br><span class="line"><span class="keyword">let</span> lib2 = <span class="title function_">getLib</span>();</span><br></pre></td></tr></table></figure>

<h3 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h3><ul>
<li>定义</li>
<li>传参</li>
<li>可选参数</li>
<li>默认参数</li>
<li>剩余参数</li>
<li>函数重载（函数名相同）</li>
</ul>
<p>函数定义</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.function</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">add1</span>(<span class="params">x: <span class="built_in">number</span>, y: <span class="built_in">number</span></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> x + y; <span class="comment">// 函数返回值，ts类型推断省去</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="attr">add2</span>: <span class="function">(<span class="params">x: <span class="built_in">number</span>, y: <span class="built_in">number</span></span>) =&gt;</span> <span class="built_in">number</span>; <span class="comment">// 通过变量，定义函数类型</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> add3 = <span class="function">(<span class="params">x: <span class="built_in">number</span>, y: <span class="built_in">number</span></span>) =&gt;</span> <span class="built_in">number</span>; <span class="comment">// 类型别名，定义函数类型</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> add4 &#123; <span class="comment">// 接口定义函数类型</span></span><br><span class="line">  (<span class="attr">x</span>: <span class="built_in">number</span>, <span class="attr">y</span>: <span class="built_in">number</span>): <span class="built_in">number</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 2-4 都是函数类型的定义，没有实现</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 调用：行参和实参一一对应</span></span><br><span class="line"><span class="title function_">add1</span>(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">add6</span>(<span class="params">x: <span class="built_in">number</span>, y = <span class="number">0</span>, z: <span class="built_in">number</span>, q = <span class="number">1</span></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> x + y + z + q;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">add6</span>(<span class="number">1</span>, <span class="literal">undefined</span>, <span class="number">3</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">add7</span>(<span class="params">x: <span class="built_in">number</span>, ...rest: <span class="built_in">number</span>[]</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> x + rest.<span class="title function_">reduce</span>(<span class="function">(<span class="params">pre, cur</span>) =&gt;</span> pre + cur)</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">add7</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>));</span><br></pre></td></tr></table></figure>

<h3 id="类"><a href="#类" class="headerlink" title="类"></a>类</h3><h4 id="类基本实现"><a href="#类基本实现" class="headerlink" title="类基本实现"></a>类基本实现</h4><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Dog</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">name: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">name</span> = name</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span> = <span class="string">&#x27;dog&#x27;</span></span><br><span class="line">  <span class="title function_">run</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Dog</span>.<span class="property"><span class="keyword">prototype</span></span>)</span><br><span class="line"><span class="keyword">let</span> dog = <span class="keyword">new</span> <span class="title class_">Dog</span>(<span class="string">&#x27;wangwang&#x27;</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(dog)</span><br></pre></td></tr></table></figure>

<h4 id="类的继承"><a href="#类的继承" class="headerlink" title="类的继承"></a>类的继承</h4><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Husky</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Dog</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">name: <span class="built_in">string</span>, color: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(name)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">color</span> = color</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="attr">color</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="成员修饰符"><a href="#成员修饰符" class="headerlink" title="成员修饰符"></a>成员修饰符</h4><p>public<br>private<br>protected 受保护的，不能实例调用，子类可以继承<br>readonly 只读<br>static 静态的，能通过类访问，不能通过实例访问，子类继承可以访问</p>
<h4 id="抽象类"><a href="#抽象类" class="headerlink" title="抽象类"></a>抽象类</h4><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Animal</span> &#123;</span><br><span class="line">  <span class="title function_">eat</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;eat&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="多态"><a href="#多态" class="headerlink" title="多态"></a>多态</h4><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="attr">animals</span>: <span class="title class_">Animal</span>[] = [dog, cat]</span><br><span class="line">animals.<span class="title function_">forEach</span>(<span class="function"><span class="params">i</span> =&gt;</span> &#123;</span><br><span class="line">  i.<span class="title function_">sleep</span>()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="特殊的类型，this类型，链式调用"><a href="#特殊的类型，this类型，链式调用" class="headerlink" title="特殊的类型，this类型，链式调用"></a>特殊的类型，this类型，链式调用</h4><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">WorkFlow</span> &#123;</span><br><span class="line">  <span class="title function_">step1</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">step2</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">new</span> <span class="title class_">WorkFlow</span>().<span class="title function_">step1</span>().<span class="title function_">step2</span>()</span><br></pre></td></tr></table></figure>

<h5 id="this类型-多态"><a href="#this类型-多态" class="headerlink" title="this类型 多态"></a>this类型 多态</h5><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Myflow</span> <span class="keyword">extends</span> <span class="title class_ inherited__">WorkFlow</span> &#123;</span><br><span class="line">  <span class="title function_">next</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Myflow</span>().<span class="title function_">next</span>().<span class="title function_">step1</span>().<span class="title function_">next</span>().<span class="title function_">step2</span>()</span><br></pre></td></tr></table></figure>

<h4 id="类的静态方法"><a href="#类的静态方法" class="headerlink" title="类的静态方法"></a>类的静态方法</h4><p>使用static修饰符修饰的是静态方法<br>静态方法不需要实例化，直接就可以通过类调用</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span>&#123;</span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">eat</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;eat...&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">Person</span>.<span class="title function_">eat</span>();</span><br></pre></td></tr></table></figure>



<h3 id="接口-2"><a href="#接口-2" class="headerlink" title="接口"></a>接口</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<img src="/2020/02/27/TypeScript/interface.png" class="">

<h3 id="范型"><a href="#范型" class="headerlink" title="范型"></a>范型</h3><p>好处：</p>
<ul>
<li>函数和类可以轻松的支持多种类型，增强程序的扩展性</li>
<li>不必写多条函数重载，冗长的联合类型声明，增强代码可读性</li>
<li>灵活控制类型之间的约束<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// any类型，调用者无法获知 约束关系</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">log</span>(<span class="params">value: <span class="built_in">any</span></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> value;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<p>定义：不预先确定的数据类型，具体的类型在使用的时候才能确定</p>
<p>范型函数</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> log&lt;T&gt;(<span class="attr">value</span>: T):T &#123;</span><br><span class="line">  <span class="keyword">return</span> value;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>调用</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">log&lt;<span class="built_in">string</span>[]&gt;([<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>]) <span class="comment">//指名类型</span></span><br><span class="line"><span class="title function_">log</span>([<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>])<span class="comment">// 类型推断，推荐使用</span></span><br></pre></td></tr></table></figure>

<p>类型别名 定义范型函数及实现</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">Log</span> = &lt;T&gt;<span class="function">(<span class="params">value: T</span>) =&gt;</span> T</span><br><span class="line"><span class="keyword">let</span> <span class="attr">myLog</span>: <span class="title class_">Log</span> = log</span><br></pre></td></tr></table></figure>

<p>接口 定义范型</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Log</span>&lt;T&gt; &#123;</span><br><span class="line">  (<span class="attr">value</span>: T): T</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> <span class="attr">myLog</span>: <span class="title class_">Log</span>&lt;<span class="built_in">number</span>&gt; = log</span><br><span class="line"><span class="title function_">myLog</span>(<span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<h4 id="范型类"><a href="#范型类" class="headerlink" title="范型类"></a>范型类</h4><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Log</span>&lt;T&gt; &#123;</span><br><span class="line">  <span class="title function_">run</span>(<span class="params">value: T</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> value</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> log1 = <span class="keyword">new</span> <span class="title class_">Log</span>&lt;<span class="built_in">number</span>&gt;()</span><br><span class="line">log1.<span class="title function_">run</span>(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">let</span> log2 = <span class="keyword">new</span> <span class="title class_">Log</span>() <span class="comment">// 不指定类型，就可以传入任意类型</span></span><br><span class="line">log2.<span class="title function_">run</span>(<span class="string">&#x27;1&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="范型约束"><a href="#范型约束" class="headerlink" title="范型约束"></a>范型约束</h4><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> log&lt;T&gt;(<span class="attr">value</span>: T): T &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(value, value.<span class="property">length</span>) <span class="comment">// length 报错：范型T没有这个属性</span></span><br><span class="line">  <span class="keyword">return</span> value</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//通过类型检查</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Length</span> &#123;</span><br><span class="line">  <span class="attr">length</span>: <span class="built_in">number</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> log&lt;T <span class="keyword">extends</span> <span class="title class_">Length</span>&gt;(<span class="attr">value</span>: T): T &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(value, value.<span class="property">length</span>)</span><br><span class="line">  <span class="keyword">return</span> value</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="类型检查机制"><a href="#类型检查机制" class="headerlink" title="类型检查机制"></a>类型检查机制</h3><h4 id="类型断言-1"><a href="#类型断言-1" class="headerlink" title="类型断言"></a>类型断言</h4><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Foo</span> &#123;</span><br><span class="line">  <span class="attr">bar</span>: <span class="built_in">number</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> foo = &#123;&#125; <span class="keyword">as</span> <span class="title class_">Foo</span></span><br><span class="line">foo.<span class="property">bar</span> = <span class="number">1</span></span><br></pre></td></tr></table></figure>

<h3 id="高级类型"><a href="#高级类型" class="headerlink" title="高级类型"></a>高级类型</h3><h4 id="交叉类型与联合类型"><a href="#交叉类型与联合类型" class="headerlink" title="交叉类型与联合类型"></a>交叉类型与联合类型</h4><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">DogInterface</span> &#123;</span><br><span class="line">  <span class="title function_">run</span>(): <span class="built_in">void</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">CatInterface</span> &#123;</span><br><span class="line">  <span class="title function_">jump</span>(): <span class="built_in">void</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 交叉类型：使用 &amp; and符连接</span></span><br><span class="line"><span class="keyword">let</span> <span class="attr">pet</span>: <span class="title class_">DogInterface</span> &amp; <span class="title class_">CatInterface</span> = &#123;</span><br><span class="line">  <span class="title function_">run</span>(<span class="params"></span>) &#123;&#125;,</span><br><span class="line">  <span class="title function_">jump</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 联合类型：｜</span></span><br><span class="line"><span class="keyword">let</span> <span class="attr">a</span>: <span class="built_in">number</span> | <span class="built_in">string</span> = <span class="string">&#x27;a&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 限制变量取值在一定范围内</span></span><br><span class="line"><span class="keyword">let</span> <span class="attr">a</span>: <span class="string">&#x27;a&#x27;</span> | <span class="string">&#x27;b&#x27;</span> | <span class="string">&#x27;c&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 索引类型</span></span><br><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">  <span class="attr">a</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="attr">b</span>: <span class="number">2</span>,</span><br><span class="line">  <span class="attr">c</span>: <span class="number">3</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> getValues&lt;T, K <span class="keyword">extends</span> keyof T&gt;(<span class="attr">obj</span>: T, <span class="attr">keys</span>: K[]): T[k][] &#123;</span><br><span class="line">  <span class="keyword">return</span> keys.<span class="title function_">map</span>(<span class="function"><span class="params">key</span> =&gt;</span> obj[key])</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 索引类型查询操作符</span></span><br><span class="line"><span class="comment">// keyof T</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Obj</span> &#123;</span><br><span class="line">  <span class="attr">a</span>: <span class="built_in">number</span>,</span><br><span class="line">  <span class="attr">b</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> <span class="attr">key</span>: keyof <span class="title class_">Obj</span></span><br><span class="line"><span class="comment">// key 的类型就变成，&#x27;a&#x27;, &#x27;b&#x27; 字面量的联合类型</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 索引访问操作符 T[k]</span></span><br><span class="line"><span class="keyword">let</span> <span class="attr">value</span>: <span class="title class_">Obj</span>[<span class="string">&#x27;a&#x27;</span>]</span><br><span class="line"><span class="comment">// value的类型 就是number类型</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 范型约束</span></span><br><span class="line"><span class="comment">// T extends U ,范型变量T 可以继承某些属性或变量</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 映射类型</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Obj</span> &#123;</span><br><span class="line">  <span class="attr">a</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">b</span>: <span class="built_in">number</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">ReadonlyObj</span> = <span class="title class_">Readonly</span>&lt;<span class="title class_">Obj</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 条件类型</span></span><br><span class="line"><span class="comment">// T extends U ? X : Y</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">TypeName</span>&lt;T&gt; =</span><br><span class="line">  T <span class="keyword">extends</span> <span class="built_in">string</span> ? <span class="string">&quot;string&quot;</span> :</span><br><span class="line">  T <span class="keyword">extends</span> <span class="built_in">number</span> ? <span class="string">&quot;number&quot;</span> :</span><br><span class="line">  T <span class="keyword">extends</span> <span class="built_in">boolean</span> ? <span class="string">&quot;boolean&quot;</span> :</span><br><span class="line">  T <span class="keyword">extends</span> <span class="literal">undefined</span> ? <span class="string">&quot;undefined&quot;</span> :</span><br><span class="line">  T <span class="keyword">extends</span> <span class="title class_">Function</span> ? <span class="string">&quot;function&quot;</span> :</span><br><span class="line">  <span class="string">&quot;object&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="variable constant_">T1</span> = <span class="title class_">TypeName</span>&lt;<span class="built_in">string</span>&gt;</span><br><span class="line"><span class="keyword">type</span> <span class="variable constant_">T2</span> = <span class="title class_">TypeName</span>&lt;<span class="built_in">string</span>[]&gt;</span><br></pre></td></tr></table></figure>

<h2 id="工程篇"><a href="#工程篇" class="headerlink" title="工程篇"></a>工程篇</h2><h3 id="模块系统"><a href="#模块系统" class="headerlink" title="模块系统"></a>模块系统</h3><p>前端应用越来越复杂，多人协作是一种常态，模块化被广泛接受。<br>经过时间的沉淀现在用</p>
<ul>
<li>ES6</li>
<li>CommonJS<h4 id="ES6模块系统"><a href="#ES6模块系统" class="headerlink" title="ES6模块系统"></a>ES6模块系统</h4><h5 id="es6-模块导出"><a href="#es6-模块导出" class="headerlink" title="es6 模块导出"></a>es6 模块导出</h5>通过export实现<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 单独导出</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">let</span> a = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 批量导出</span></span><br><span class="line"><span class="keyword">let</span> b = <span class="number">2</span></span><br><span class="line"><span class="keyword">let</span> c = <span class="number">3</span></span><br><span class="line"><span class="keyword">export</span> &#123; b, c &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导出接口</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> P &#123;</span><br><span class="line">  <span class="attr">x</span>: <span class="built_in">number</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导出函数</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">f</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导出时起别名</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">g</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line"><span class="keyword">export</span> &#123;g <span class="keyword">as</span> G&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 默认导出，无需函数名</span></span><br><span class="line"><span class="comment">// es6 允许一个顶级导出，多个次级导出</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;I&#x27;am default&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ts编译后, 程序无感知</span></span><br><span class="line"><span class="comment">// .js</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">default_1</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;I&#x27;am default&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">exports</span>[<span class="string">&quot;default&quot;</span>] = default_1;</span><br><span class="line">a_2[<span class="string">&quot;default&quot;</span>]();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 引入外部模块，重新导出</span></span><br><span class="line"><span class="keyword">export</span> &#123; str <span class="keyword">as</span> hello &#125; <span class="keyword">from</span> <span class="string">&#x27;./b&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 顶级导出; </span></span><br><span class="line"><span class="comment">// export let a = 1; 使用顶级导出就不能导出其他了</span></span><br><span class="line"><span class="keyword">export</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="es6-导入"><a href="#es6-导入" class="headerlink" title="es6 导入"></a>es6 导入</h5><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; a, b, c &#125; <span class="keyword">from</span> <span class="string">&#x27;./a&#x27;</span>; <span class="comment">// 批量导入</span></span><br><span class="line"><span class="keyword">import</span> &#123; P &#125; <span class="keyword">from</span> <span class="string">&#x27;./a&#x27;</span>;       <span class="comment">// 导入接口</span></span><br><span class="line"><span class="keyword">import</span> &#123; f <span class="keyword">as</span> F &#125; <span class="keyword">from</span> <span class="string">&#x27;./a&#x27;</span>;  <span class="comment">// 导入时起别名</span></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> <span class="title class_">All</span> <span class="keyword">from</span> <span class="string">&#x27;./a&#x27;</span>;    <span class="comment">// 导入模块中的所有成员，绑定在 All 上</span></span><br><span class="line"><span class="keyword">import</span> myFunction <span class="keyword">from</span> <span class="string">&#x27;./a&#x27;</span>;  <span class="comment">// 不加&#123;&#125;, 导入默认</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="CommonJS模块系统"><a href="#CommonJS模块系统" class="headerlink" title="CommonJS模块系统"></a>CommonJS模块系统</h4><p>nodejs是commonjs的一种实现</p>
<h5 id="commonjs模块导出"><a href="#commonjs模块导出" class="headerlink" title="commonjs模块导出"></a>commonjs模块导出</h5><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a = &#123;</span><br><span class="line">  <span class="attr">x</span>: <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 整体导出</span></span><br><span class="line"><span class="comment">// 只允许一个顶级导出，会覆盖次级导出</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = a</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导出多个变量</span></span><br><span class="line"><span class="comment">// 次级导出</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">c</span> = <span class="number">3</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">d</span> = <span class="number">4</span></span><br><span class="line"><span class="comment">// exports == module.exports;  exports是module.exports的引用</span></span><br></pre></td></tr></table></figure>

<h5 id="commonjs模块导入"><a href="#commonjs模块导入" class="headerlink" title="commonjs模块导入"></a>commonjs模块导入</h5><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> c1 = <span class="built_in">require</span>(<span class="string">&#x27;./a.node&#x27;</span>)</span><br><span class="line"><span class="keyword">let</span> c2 = <span class="built_in">require</span>(<span class="string">&#x27;./b.node&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="生成环境中两个模块系统会被构建成什么样子"><a href="#生成环境中两个模块系统会被构建成什么样子" class="headerlink" title="生成环境中两个模块系统会被构建成什么样子"></a>生成环境中两个模块系统会被构建成什么样子</h4><p>tsconfig.json</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;compilerOptions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;target&quot;</span><span class="punctuation">:</span> <span class="string">&quot;es5&quot;</span><span class="punctuation">,</span> <span class="comment">//ts默认生成的tsconfig.json 用 es5；tsc指令 用 es3；ES2015是 ES6</span></span><br><span class="line">    <span class="comment">// 要编译成的目标语言是什么版本</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">&quot;module&quot;</span><span class="punctuation">:</span> <span class="string">&quot;commonjs&quot;</span><span class="punctuation">,</span> <span class="comment">// tsconfig.json和tsc都是commonjs</span></span><br><span class="line">    <span class="comment">// 要把我们的代码编译成什么样的模块系统</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">&quot;esModuleInterop&quot;</span><span class="punctuation">:</span> <span class="keyword">true</span><span class="punctuation">,</span></span><br><span class="line">    <span class="comment">// export =  的，两种导入方式</span></span><br><span class="line">    <span class="comment">// false的话，只能这样导入：import c4 = require(&#x27;../es6/d&#x27;)</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">&quot;outDir&quot;</span><span class="punctuation">:</span> <span class="string">&quot;./dist&quot;</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">&quot;composite&quot;</span><span class="punctuation">:</span> <span class="keyword">true</span><span class="punctuation">,</span> <span class="comment">// 工程可以被引用, 并且可以增量编译</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">&quot;declaration&quot;</span><span class="punctuation">:</span> <span class="keyword">true</span><span class="punctuation">,</span> <span class="comment">// 声明文件</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;include&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;src&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="comment">// 输出的目录不包含 src</span></span><br><span class="line">  <span class="attr">&quot;references&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span> <span class="comment">// 依赖的工程</span></span><br><span class="line">    <span class="punctuation">&#123;</span> <span class="attr">&quot;path&quot;</span><span class="punctuation">:</span> <span class="string">&quot;../common&quot;</span> <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h4 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h4><p>如果使用了ES6的导出，CommonJS的导入就会出现问题</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// commonjs调用es6的默认导出</span></span><br><span class="line"><span class="keyword">let</span> c3 = <span class="built_in">require</span>(<span class="string">&#x27;../es6/a&#x27;</span>);</span><br><span class="line"><span class="title function_">c3</span>() <span class="comment">// 报错 not function</span></span><br><span class="line">c3.<span class="title function_">default</span>() <span class="comment">// 正常</span></span><br></pre></td></tr></table></figure>
<h4 id="如何出来两个模块不兼容问题"><a href="#如何出来两个模块不兼容问题" class="headerlink" title="如何出来两个模块不兼容问题"></a>如何出来两个模块不兼容问题</h4><p>方案：<br>1、两个模块系统不要混用<br>2、如果es6有一个顶级导出，可能会被nodejs模块引用的话，ts提供了一个兼容的语法：export</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 会被编译为：module.exports; 意味着不能有其他的导出了</span></span><br><span class="line"><span class="keyword">export</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;I&#x27;am default&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 两种导入方式</span></span><br><span class="line"><span class="keyword">import</span> c4 = <span class="built_in">require</span>(<span class="string">&#x27;../es6/d&#x27;</span>)</span><br><span class="line"><span class="keyword">import</span> c4 <span class="keyword">from</span> <span class="string">&#x27;../es6/d&#x27;</span></span><br><span class="line"><span class="title function_">c4</span>()</span><br></pre></td></tr></table></figure>

<h4 id="模块和命名空间不要混用，namespace"><a href="#模块和命名空间不要混用，namespace" class="headerlink" title="模块和命名空间不要混用，namespace"></a>模块和命名空间不要混用，namespace</h4><h3 id="声明合并"><a href="#声明合并" class="headerlink" title="声明合并"></a>声明合并</h3><p>接口之间函数是可以重复定义的，命名空间不行</p>
<h3 id="编写声明文件"><a href="#编写声明文件" class="headerlink" title="编写声明文件"></a>编写声明文件</h3><p>类库分为三类</p>
<ul>
<li>全局类库</li>
<li>模块类库</li>
<li>UMD类库</li>
</ul>
<p>jquery是UMD类库，既可以全局也可以模块化引用<br>在使用非ts编写的类库时，必须为这个类库编写声明文件，对外暴露API<br>社区会编写大部分类库的声明文件，安装：yarn add @types/jquery<br><a target="_blank" rel="noopener" href="https://www.typescriptlang.org/dt/search?search=">查询声明类库</a></p>
<h3 id="配置tsconfig-json"><a href="#配置tsconfig-json" class="headerlink" title="配置tsconfig.json"></a>配置tsconfig.json</h3><h4 id="文件"><a href="#文件" class="headerlink" title="文件"></a>文件</h4><ul>
<li>files</li>
<li>include</li>
<li>exclude</li>
</ul>
<h4 id="工程引用"><a href="#工程引用" class="headerlink" title="工程引用"></a>工程引用</h4><p>在全栈项目中，单独构建客户端的应用 或者 server端的应用。这些问题无法通过单个 配置文件 实现。</p>
<p>参考 <a target="_blank" rel="noopener" href="https://github.com/microsoft/TypeScript/tree/main/src">ts项目</a></p>
<h5 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h5><ul>
<li>解决了输出目录结构的问题</li>
<li>解决了单个工程构建的问题</li>
<li>通过增量编译，提升了构建速度</li>
</ul>
<h1 id="区别"><a href="#区别" class="headerlink" title="区别"></a>区别</h1><h2 id="interface和type"><a href="#interface和type" class="headerlink" title="interface和type"></a>interface和type</h2><h3 id="相同点"><a href="#相同点" class="headerlink" title="相同点"></a>相同点</h3><p>1.都可以描述一个对象或者函数</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">User</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">age</span>: <span class="built_in">number</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">SetUser</span> &#123;</span><br><span class="line">  (<span class="attr">name</span>: <span class="built_in">string</span>, <span class="attr">age</span>: <span class="built_in">number</span>): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">User</span> = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">age</span>: <span class="built_in">number</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">SetUser</span> = <span class="function">(<span class="params">name: <span class="built_in">string</span>, age: <span class="built_in">number</span></span>)=&gt;</span> <span class="built_in">void</span>;</span><br></pre></td></tr></table></figure>

<p>2.都允许拓展（extends）<br>interface 和 type 都可以拓展，并且两者并不是相互独立的，也就是说 interface 可以 extends type, type 也可以 extends interface 。 虽然效果差不多，但是两者语法不同。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// interface extends interface</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Name</span> &#123; </span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">User</span> <span class="keyword">extends</span> <span class="title class_">Name</span> &#123; </span><br><span class="line">  <span class="attr">age</span>: <span class="built_in">number</span>; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// type extends type</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Name</span> = &#123; </span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">User</span> = <span class="title class_">Name</span> &amp; &#123; <span class="attr">age</span>: <span class="built_in">number</span>  &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// interface extends type</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Name</span> = &#123; </span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">User</span> <span class="keyword">extends</span> <span class="title class_">Name</span> &#123; </span><br><span class="line">  <span class="attr">age</span>: <span class="built_in">number</span>; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// type extends interface</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Name</span> &#123; </span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">User</span> = <span class="title class_">Name</span> &amp; &#123; </span><br><span class="line">  <span class="attr">age</span>: <span class="built_in">number</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="不同点"><a href="#不同点" class="headerlink" title="不同点"></a>不同点</h3><p>type 可以而 interface 不行<br>1.type 可以声明基本类型别名，联合类型，元组等类型</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 基本类型别名</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Name</span> = <span class="built_in">string</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 联合类型</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Dog</span> &#123;</span><br><span class="line">    <span class="title function_">wong</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Cat</span> &#123;</span><br><span class="line">    <span class="title function_">miao</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Pet</span> = <span class="title class_">Dog</span> | <span class="title class_">Cat</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 具体定义数组每个位置的类型</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">PetList</span> = [<span class="title class_">Dog</span>, <span class="title class_">Pet</span>]</span><br></pre></td></tr></table></figure>
<p>2.type 语句中还可以使用 typeof 获取实例的 类型进行赋值</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 当你想获取一个变量的类型时，使用 typeof</span></span><br><span class="line"><span class="keyword">let</span> div = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line"><span class="keyword">type</span> B = <span class="keyword">typeof</span> div</span><br></pre></td></tr></table></figure>
<p>3.其他骚操作</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">StringOrNumber</span> = <span class="built_in">string</span> | <span class="built_in">number</span>;  </span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Text</span> = <span class="built_in">string</span> | &#123; <span class="attr">text</span>: <span class="built_in">string</span> &#125;;  </span><br><span class="line"><span class="keyword">type</span> <span class="title class_">NameLookup</span> = <span class="title class_">Dictionary</span>&lt;<span class="built_in">string</span>, <span class="title class_">Person</span>&gt;;  </span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Callback</span>&lt;T&gt; = <span class="function">(<span class="params">data: T</span>) =&gt;</span> <span class="built_in">void</span>;  </span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Pair</span>&lt;T&gt; = [T, T];  </span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Coordinates</span> = <span class="title class_">Pair</span>&lt;<span class="built_in">number</span>&gt;;  </span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Tree</span>&lt;T&gt; = T | &#123; <span class="attr">left</span>: <span class="title class_">Tree</span>&lt;T&gt;, <span class="attr">right</span>: <span class="title class_">Tree</span>&lt;T&gt; &#125;;</span><br></pre></td></tr></table></figure>

<p>interface 可以而 type 不行<br>interface 能够声明合并</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">User</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">age</span>: <span class="built_in">number</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">User</span> &#123;</span><br><span class="line">  <span class="attr">sex</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">User 接口为 &#123;</span></span><br><span class="line"><span class="comment">  name: string</span></span><br><span class="line"><span class="comment">  age: number</span></span><br><span class="line"><span class="comment">  sex: string </span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<p>总结：一般来说，如果不清楚什么时候用interface/type，能用 interface 实现，就用 interface , 如果不能就用 type 。</p>
<h1 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h1><h2 id="path-can’t-resolve"><a href="#path-can’t-resolve" class="headerlink" title="path can’t resolve"></a>path can’t resolve</h2><p>ERROR in ./src/app/pages/home/home.component.ts<br>Module not found: Error: Can’t resolve ‘@service/api/user.service’ in ‘/Users/niekaifa/workspace/apowo/platform-client/src/app/pages/home’<br> @ ./src/app/pages/home/home.component.ts 17:23-59<br> @ ./src/app/pages/home/home.module.ts<br> @ ./src/app/app.routes.ts<br> @ ./src/app/app.module.ts<br> @ ./src/main.ts</p>
<p>背景：改了webpack，以前可以使用，现在出错<br>原因：<br>tsconfig path 代码显示不出错<br>webpack 才是真的按路径引入，所以问题出在 webapck<br>解决<br>    new AngularCompilerPlugin({<br>      mainPath: path.resolve(“./src/main.ts”),<br>      sourceMap: true,<br>      nameLazyFiles: true,<br>      tsConfigPath: path.resolve(“./src/tsconfig.app.json”),<br>      skipCodeGeneration: true,<br>    }),</p>
<h2 id="import-与-import"><a href="#import-与-import" class="headerlink" title="import * 与 import"></a>import * 与 import</h2><p>为什么有的系统语言使用import * as React from ‘react’;有的系统语言使用import React from ‘react’;<br>作者回复: 第一种写法是将所有用export导出的成员绑定在React上，导入后用React.xxx访问；第二种仅是导出默认的（export default）</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/02/26/js-error/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kil">
      <meta itemprop="description" content="心如止水，潜心修行">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Kil Notes">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/02/26/js-error/" class="post-title-link" itemprop="url">js-error</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-02-26 17:18:43" itemprop="dateCreated datePublished" datetime="2020-02-26T17:18:43+08:00">2020-02-26</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/JavaScript/" itemprop="url" rel="index"><span itemprop="name">JavaScript</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="js"><a href="#js" class="headerlink" title="js"></a>js</h1><h2 id="object"><a href="#object" class="headerlink" title="[object]"></a>[object]</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`$_model_cart:<span class="subst">$&#123;carts&#125;</span>`</span>);</span><br></pre></td></tr></table></figure>
<p>输出：<code>[object object]</code></p>
<h3 id="object-Object"><a href="#object-Object" class="headerlink" title="[object Object]"></a>[object Object]</h3><p>console.log(‘Update is loaded stringify:’ + JSON.stringify(data));</p>
<h2 id="const-声明"><a href="#const-声明" class="headerlink" title="const 声明"></a>const 声明</h2><p>const sprite;<br>Uncaught SyntaxError: Missing initializer in const declaration<br>使用const关键字声明常量。需要一个常量的初始化程序；也就是说，您必须在声明它的同一条语句中指定它的值（这很有意义，因为以后无法更改）</p>
<h2 id="语法错误"><a href="#语法错误" class="headerlink" title="语法错误"></a>语法错误</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">4.</span><span class="title function_">toString</span>(<span class="number">2</span>);</span><br><span class="line"><span class="title class_">Uncaught</span> <span class="title class_">Syntax</span> <span class="title class_">Error</span>: <span class="title class_">Invalid</span> or unexpected token</span><br></pre></td></tr></table></figure>

<h2 id="端口被占用"><a href="#端口被占用" class="headerlink" title="端口被占用"></a>端口被占用</h2><p>Error: listen EADDRIUNSE :::5000<br>eaddrinuse 给定的地址已经被使用</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/02/25/clean-code-typescript/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kil">
      <meta itemprop="description" content="心如止水，潜心修行">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Kil Notes">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/02/25/clean-code-typescript/" class="post-title-link" itemprop="url">clean-code-typescript</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-02-25 15:03:20" itemprop="dateCreated datePublished" datetime="2020-02-25T15:03:20+08:00">2020-02-25</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/TypeScript/" itemprop="url" rel="index"><span itemprop="name">TypeScript</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Table-of-Contents-目录"><a href="#Table-of-Contents-目录" class="headerlink" title="Table of Contents 目录"></a>Table of Contents 目录</h2><ul>
<li>Introduction 介绍</li>
<li>Variables 变量</li>
<li>Functions 方法</li>
<li>Objects and Data Structures 对象和数据结构</li>
<li>Classes 类</li>
<li>SOLID 固体</li>
<li>Testing 测试中</li>
<li>Concurrency 并发</li>
<li>Error Handling 错误处理</li>
<li>Formatting 格式化</li>
<li>Comments 注释</li>
</ul>
<h3 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h3><img src="/2020/02/25/clean-code-typescript/clean-code.png" class="">

<h3 id="Variables"><a href="#Variables" class="headerlink" title="Variables"></a>Variables</h3><h4 id="使用有意义的变量名"><a href="#使用有意义的变量名" class="headerlink" title="使用有意义的变量名"></a>使用有意义的变量名</h4><p>以使读者知道差异,提供什么方式来区分名称。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"><span class="keyword">function</span> between&lt;T&gt;(<span class="attr">a1</span>: T, <span class="attr">a2</span>: T, <span class="attr">a3</span>: T): <span class="built_in">boolean</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> a2 &lt;= a1 &amp;&amp; a1 &lt;= a3;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"><span class="keyword">function</span> between&lt;T&gt;(<span class="attr">value</span>: T, <span class="attr">left</span>: T, <span class="attr">right</span>: T): <span class="built_in">boolean</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> left &lt;= value &amp;&amp; value &lt;= right;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="使用明显的变量名"><a href="#使用明显的变量名" class="headerlink" title="使用明显的变量名"></a>使用明显的变量名</h4><p>如果您无法说出来，就不会听起来像个白痴，就无法讨论它。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">DtaRcrd102</span> = &#123;</span><br><span class="line">  <span class="attr">genymdhms</span>: <span class="title class_">Date</span>;</span><br><span class="line">  <span class="attr">modymdhms</span>: <span class="title class_">Date</span>;</span><br><span class="line">  <span class="attr">pszqint</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Customer</span> = &#123;</span><br><span class="line">  <span class="attr">generationTimestamp</span>: <span class="title class_">Date</span>;</span><br><span class="line">  <span class="attr">modificationTimestamp</span>: <span class="title class_">Date</span>;</span><br><span class="line">  <span class="attr">recordId</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="对相同类型的变量使用相同的词汇表"><a href="#对相同类型的变量使用相同的词汇表" class="headerlink" title="对相同类型的变量使用相同的词汇表"></a>对相同类型的变量使用相同的词汇表</h4><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getUserInfo</span>(<span class="params"></span>): <span class="title class_">User</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getUserDetails</span>(<span class="params"></span>): <span class="title class_">User</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getUserData</span>(<span class="params"></span>): <span class="title class_">User</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getUser</span>(<span class="params"></span>): <span class="title class_">User</span>;</span><br></pre></td></tr></table></figure>

<h4 id="使用可搜索的名称"><a href="#使用可搜索的名称" class="headerlink" title="使用可搜索的名称"></a>使用可搜索的名称</h4><p>我们将阅读比编写更多的代码。 我们编写的代码具有可读性和可搜索性，这一点很重要。 通过不命名最终对理解我们的程序有意义的变量，我们伤害了我们的读者。 使您的名字可搜索。 TSLint之类的工具可以帮助识别未命名的常量。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"><span class="comment">// What the heck is 86400000 for?</span></span><br><span class="line"><span class="built_in">setTimeout</span>(restart, <span class="number">86400000</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"><span class="comment">// Declare them as capitalized named constants.</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">MILLISECONDS_IN_A_DAY</span> = <span class="number">24</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">1000</span>; <span class="comment">// 一天中的毫秒数</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">setTimeout</span>(restart, <span class="variable constant_">MILLISECONDS_IN_A_DAY</span>);</span><br></pre></td></tr></table></figure>

<h4 id="使用解释变量"><a href="#使用解释变量" class="headerlink" title="使用解释变量"></a>使用解释变量</h4><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"><span class="keyword">declare</span> <span class="keyword">const</span> <span class="attr">users</span>: <span class="title class_">Map</span>&lt;<span class="built_in">string</span>, <span class="title class_">User</span>&gt;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">const</span> keyValue <span class="keyword">of</span> users) &#123;</span><br><span class="line">  <span class="comment">// iterate through users map</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"><span class="keyword">declare</span> <span class="keyword">const</span> <span class="attr">users</span>: <span class="title class_">Map</span>&lt;<span class="built_in">string</span>, <span class="title class_">User</span>&gt;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">const</span> [id, user] <span class="keyword">of</span> users) &#123;</span><br><span class="line">  <span class="comment">// iterate through users map</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="避免思维导图"><a href="#避免思维导图" class="headerlink" title="避免思维导图"></a>避免思维导图</h4><p>显式胜于隐式。<br>清晰为王。<code>Clarity is king</code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"><span class="keyword">const</span> u = <span class="title function_">getUser</span>();</span><br><span class="line"><span class="keyword">const</span> s = <span class="title function_">getSubscription</span>();</span><br><span class="line"><span class="keyword">const</span> t = <span class="title function_">charge</span>(u, s);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"><span class="keyword">const</span> user = <span class="title function_">getUser</span>();</span><br><span class="line"><span class="keyword">const</span> subscription = <span class="title function_">getSubscription</span>();</span><br><span class="line"><span class="keyword">const</span> transaction = <span class="title function_">charge</span>(user, subscription);</span><br></pre></td></tr></table></figure>

<h4 id="不要添加不需要的上下文"><a href="#不要添加不需要的上下文" class="headerlink" title="不要添加不需要的上下文"></a>不要添加不需要的上下文</h4><p>如果您的类/类型/对象名称告诉您某些内容，请不要在变量名称中重复。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Car</span> = &#123;</span><br><span class="line">  <span class="attr">carMake</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">carModel</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">carColor</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">print</span>(<span class="params">car: Car</span>): <span class="built_in">void</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`<span class="subst">$&#123;car.carMake&#125;</span> <span class="subst">$&#123;car.carModel&#125;</span> (<span class="subst">$&#123;car.carColor&#125;</span>)`</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Car</span> = &#123;</span><br><span class="line">  <span class="attr">make</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">model</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">color</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">print</span>(<span class="params">car: Car</span>): <span class="built_in">void</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`<span class="subst">$&#123;car.make&#125;</span> <span class="subst">$&#123;car.model&#125;</span> (<span class="subst">$&#123;car.color&#125;</span>)`</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="使用默认参数代替短路或条件"><a href="#使用默认参数代替短路或条件" class="headerlink" title="使用默认参数代替短路或条件"></a>使用默认参数代替短路或条件</h4><p>默认参数通常比短路更干净。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">loadPages</span>(<span class="params">count?: <span class="built_in">number</span></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> loadCount = count !== <span class="literal">undefined</span> ? count : <span class="number">10</span>;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">loadPages</span>(<span class="params">count: <span class="built_in">number</span> = <span class="number">10</span></span>) &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="使用枚举来记录意图"><a href="#使用枚举来记录意图" class="headerlink" title="使用枚举来记录意图"></a>使用枚举来记录意图</h4><p>枚举可以帮助您记录代码的意图。 例如，当我们关注的是不同的值而不是确切的值时。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">GENRE</span> = &#123;</span><br><span class="line">  <span class="attr">ROMANTIC</span>: <span class="string">&#x27;romantic&#x27;</span>,</span><br><span class="line">  <span class="attr">DRAMA</span>: <span class="string">&#x27;drama&#x27;</span>,</span><br><span class="line">  <span class="attr">COMEDY</span>: <span class="string">&#x27;comedy&#x27;</span>,</span><br><span class="line">  <span class="attr">DOCUMENTARY</span>: <span class="string">&#x27;documentary&#x27;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">projector.<span class="title function_">configureFilm</span>(<span class="variable constant_">GENRE</span>.<span class="property">COMEDY</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Projector</span> &#123;</span><br><span class="line">  <span class="comment">// delactation of Projector</span></span><br><span class="line">  <span class="title function_">configureFilm</span>(<span class="params">genre</span>) &#123;</span><br><span class="line">    <span class="keyword">switch</span> (genre) &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="variable constant_">GENRE</span>.<span class="property">ROMANTIC</span>:</span><br><span class="line">        <span class="comment">// some logic to be executed </span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"><span class="keyword">enum</span> <span class="variable constant_">GENRE</span> &#123;</span><br><span class="line">  <span class="variable constant_">ROMANTIC</span>,</span><br><span class="line">  <span class="variable constant_">DRAMA</span>,</span><br><span class="line">  <span class="variable constant_">COMEDY</span>,</span><br><span class="line">  <span class="variable constant_">DOCUMENTARY</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">projector.<span class="title function_">configureFilm</span>(<span class="variable constant_">GENRE</span>.<span class="property">COMEDY</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Projector</span> &#123;</span><br><span class="line">  <span class="comment">// delactation of Projector</span></span><br><span class="line">  <span class="title function_">configureFilm</span>(<span class="params">genre</span>) &#123;</span><br><span class="line">    <span class="keyword">switch</span> (genre) &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="variable constant_">GENRE</span>.<span class="property">ROMANTIC</span>:</span><br><span class="line">        <span class="comment">// some logic to be executed </span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h3><h4 id="函数参数（理想情况下为2个或更少）"><a href="#函数参数（理想情况下为2个或更少）" class="headerlink" title="函数参数（理想情况下为2个或更少）"></a>函数参数（理想情况下为2个或更少）</h4><p>限制功能参数的数量非常重要，因为这使测试功能更加容易。超过三个会导致组合爆炸，您必须使用每个单独的参数测试大量不同的案例。</p>
<p>一个或两个参数是理想的情况，如果可能，应避免三个参数。除此之外，还应该合并。通常，如果您有两个以上的参数，则您的函数将尝试执行过多操作。在没有这种情况的情况下，大多数情况下，更高级别的对象作为参数就足够了。</p>
<p>如果发现自己需要大量参数，请考虑使用对象文字。</p>
<p>为了使函数具有明显的属性，您可以使用解构语法。这有一些优点：</p>
<ul>
<li>当有人查看函数签名时，会立即清楚正在使用哪些属性。</li>
<li>它可以用来模拟命名参数。</li>
<li>解构还会克隆传递到函数中的参数对象的指定原始值。这可以帮助防止副作用。注意：不会复制从参数对象解构的对象和数组。</li>
<li>TypeScript会警告您有关未使用的属性的信息，如果不进行结构化，这是不可能的。</li>
</ul>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">createMenu</span>(<span class="params">title: <span class="built_in">string</span>, body: <span class="built_in">string</span>, buttonText: <span class="built_in">string</span>, cancellable: <span class="built_in">boolean</span></span>) &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">createMenu</span>(<span class="string">&#x27;Foo&#x27;</span>, <span class="string">&#x27;Bar&#x27;</span>, <span class="string">&#x27;Baz&#x27;</span>, <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">createMenu</span>(<span class="params">options: &#123; title: <span class="built_in">string</span>, body: <span class="built_in">string</span>, buttonText: <span class="built_in">string</span>, cancellable: <span class="built_in">boolean</span> &#125;</span>) &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">createMenu</span>(&#123;</span><br><span class="line">  <span class="attr">title</span>: <span class="string">&#x27;Foo&#x27;</span>,</span><br><span class="line">  <span class="attr">body</span>: <span class="string">&#x27;Bar&#x27;</span>,</span><br><span class="line">  <span class="attr">buttonText</span>: <span class="string">&#x27;Baz&#x27;</span>,</span><br><span class="line">  <span class="attr">cancellable</span>: <span class="literal">true</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Good Advanced 进阶</span></span><br><span class="line"><span class="comment">// 您可以使用类型别名进一步提高可读性：</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">MenuOptions</span> = &#123; <span class="attr">title</span>: <span class="built_in">string</span>, <span class="attr">body</span>: <span class="built_in">string</span>, <span class="attr">buttonText</span>: <span class="built_in">string</span>, <span class="attr">cancellable</span>: <span class="built_in">boolean</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">createMenu</span>(<span class="params">options: MenuOptions</span>) &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">createMenu</span>(&#123;</span><br><span class="line">  <span class="attr">title</span>: <span class="string">&#x27;Foo&#x27;</span>,</span><br><span class="line">  <span class="attr">body</span>: <span class="string">&#x27;Bar&#x27;</span>,</span><br><span class="line">  <span class="attr">buttonText</span>: <span class="string">&#x27;Baz&#x27;</span>,</span><br><span class="line">  <span class="attr">cancellable</span>: <span class="literal">true</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="函数应该做一件事"><a href="#函数应该做一件事" class="headerlink" title="函数应该做一件事"></a>函数应该做一件事</h4><p>到目前为止，这是软件工程中最重要的规则。 当函数做的事情不止一件事时，它们就很难进行编写，测试和推理。 当您可以将一个函数隔离为一个动作时，可以轻松地对其进行重构，并且代码将变得更加清晰。 如果您除了本指南之外没有其他事，您将领先于许多开发人员。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">emailClients</span>(<span class="params">clients: Client[]</span>) &#123;</span><br><span class="line">  clients.<span class="title function_">forEach</span>(<span class="function">(<span class="params">client</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> clientRecord = database.<span class="title function_">lookup</span>(client);</span><br><span class="line">    <span class="keyword">if</span> (clientRecord.<span class="title function_">isActive</span>()) &#123;</span><br><span class="line">      <span class="title function_">email</span>(client);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">emailClients</span>(<span class="params">clients: Client[]</span>) &#123;</span><br><span class="line">  clients.<span class="title function_">filter</span>(isActiveClient).<span class="title function_">forEach</span>(email);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">isActiveClient</span>(<span class="params">client: Client</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> clientRecord = database.<span class="title function_">lookup</span>(client);</span><br><span class="line">  <span class="keyword">return</span> clientRecord.<span class="title function_">isActive</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="函数名称应说明其作用"><a href="#函数名称应说明其作用" class="headerlink" title="函数名称应说明其作用"></a>函数名称应说明其作用</h4><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">addToDate</span>(<span class="params">date: <span class="built_in">Date</span>, month: <span class="built_in">number</span></span>): <span class="title class_">Date</span> &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> date = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// It&#x27;s hard to tell from the function name what is added</span></span><br><span class="line"><span class="title function_">addToDate</span>(date, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">addMonthToDate</span>(<span class="params">date: <span class="built_in">Date</span>, month: <span class="built_in">number</span></span>): <span class="title class_">Date</span> &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> date = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line"><span class="title function_">addMonthToDate</span>(date, <span class="number">1</span>);</span><br></pre></td></tr></table></figure>

<h4 id="函数只能是一个抽象级别"><a href="#函数只能是一个抽象级别" class="headerlink" title="函数只能是一个抽象级别"></a>函数只能是一个抽象级别</h4><p>当您具有多个抽象级别时，您的函数通常会执行过多操作。 拆分功能可提高可重用性并简化测试。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">parseCode</span>(<span class="params">code: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> <span class="variable constant_">REGEXES</span> = [ <span class="comment">/* ... */</span> ];</span><br><span class="line">  <span class="keyword">const</span> statements = code.<span class="title function_">split</span>(<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">  <span class="keyword">const</span> tokens = [];</span><br><span class="line"></span><br><span class="line">  <span class="variable constant_">REGEXES</span>.<span class="title function_">forEach</span>(<span class="function">(<span class="params">regex</span>) =&gt;</span> &#123;</span><br><span class="line">    statements.<span class="title function_">forEach</span>(<span class="function">(<span class="params">statement</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// ...</span></span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> ast = [];</span><br><span class="line">  tokens.<span class="title function_">forEach</span>(<span class="function">(<span class="params">token</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// lex...</span></span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  ast.<span class="title function_">forEach</span>(<span class="function">(<span class="params">node</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// parse...</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">REGEXES</span> = [ <span class="comment">/* ... */</span> ];</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">parseCode</span>(<span class="params">code: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> tokens = <span class="title function_">tokenize</span>(code);</span><br><span class="line">  <span class="keyword">const</span> syntaxTree = <span class="title function_">parse</span>(tokens);</span><br><span class="line"></span><br><span class="line">  syntaxTree.<span class="title function_">forEach</span>(<span class="function">(<span class="params">node</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// parse...</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">tokenize</span>(<span class="params">code: <span class="built_in">string</span></span>): <span class="title class_">Token</span>[] &#123;</span><br><span class="line">  <span class="keyword">const</span> statements = code.<span class="title function_">split</span>(<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">  <span class="keyword">const</span> <span class="attr">tokens</span>: <span class="title class_">Token</span>[] = [];</span><br><span class="line"></span><br><span class="line">  <span class="variable constant_">REGEXES</span>.<span class="title function_">forEach</span>(<span class="function">(<span class="params">regex</span>) =&gt;</span> &#123;</span><br><span class="line">    statements.<span class="title function_">forEach</span>(<span class="function">(<span class="params">statement</span>) =&gt;</span> &#123;</span><br><span class="line">      tokens.<span class="title function_">push</span>( <span class="comment">/* ... */</span> );</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> tokens;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">parse</span>(<span class="params">tokens: Token[]</span>): <span class="title class_">SyntaxTree</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> <span class="attr">syntaxTree</span>: <span class="title class_">SyntaxTree</span>[] = [];</span><br><span class="line">  tokens.<span class="title function_">forEach</span>(<span class="function">(<span class="params">token</span>) =&gt;</span> &#123;</span><br><span class="line">    syntaxTree.<span class="title function_">push</span>( <span class="comment">/* ... */</span> );</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> syntaxTree;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="删除重复的代码"><a href="#删除重复的代码" class="headerlink" title="删除重复的代码"></a>删除重复的代码</h4><p>尽最大努力避免重复代码。复制代码是不好的，因为这意味着如果您需要更改某些逻辑，则可以在多个地方进行更改。</p>
<p>想象一下，如果您经营一家餐馆，并且跟踪库存：所有的西红柿，洋葱，大蒜，香料等。如果您保留了多个列表，那么当您配以西红柿的菜时都必须进行更新在他们之中。如果只有一个列表，那么只有一个地方可以更新！</p>
<p>通常，您有重复的代码，因为您有两个或多个稍有不同的事物，它们有很多共同点，但是它们之间的差异迫使您拥有两个或多个独立的函数来完成许多相同的事情。删除重复的代码意味着创建一个仅用一个函数/模块/类就可以处理这组不同事物的抽象。</p>
<p>确保正确的抽象是至关重要的，这就是为什么您应该遵循SOLID原则。错误的抽象可能比重复的代码更糟糕，因此请小心！话虽如此，如果您可以做一个好的抽象，那就去做吧！不要重复自己，否则，只要想更改一件事，就会发现自己更新了多个位置。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">showDeveloperList</span>(<span class="params">developers: Developer[]</span>) &#123;</span><br><span class="line">  developers.<span class="title function_">forEach</span>(<span class="function">(<span class="params">developer</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> expectedSalary = developer.<span class="title function_">calculateExpectedSalary</span>();</span><br><span class="line">    <span class="keyword">const</span> experience = developer.<span class="title function_">getExperience</span>();</span><br><span class="line">    <span class="keyword">const</span> githubLink = developer.<span class="title function_">getGithubLink</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> data = &#123;</span><br><span class="line">      expectedSalary,</span><br><span class="line">      experience,</span><br><span class="line">      githubLink</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">render</span>(data);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">showManagerList</span>(<span class="params">managers: Manager[]</span>) &#123;</span><br><span class="line">  managers.<span class="title function_">forEach</span>(<span class="function">(<span class="params">manager</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> expectedSalary = manager.<span class="title function_">calculateExpectedSalary</span>();</span><br><span class="line">    <span class="keyword">const</span> experience = manager.<span class="title function_">getExperience</span>();</span><br><span class="line">    <span class="keyword">const</span> portfolio = manager.<span class="title function_">getMBAProjects</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> data = &#123;</span><br><span class="line">      expectedSalary,</span><br><span class="line">      experience,</span><br><span class="line">      portfolio</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">render</span>(data);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Developer</span> &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="title function_">getExtraDetails</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">githubLink</span>: <span class="variable language_">this</span>.<span class="property">githubLink</span>,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Manager</span> &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="title function_">getExtraDetails</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">portfolio</span>: <span class="variable language_">this</span>.<span class="property">portfolio</span>,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">showEmployeeList</span>(<span class="params">employee: Developer | Manager</span>) &#123;</span><br><span class="line">  employee.<span class="title function_">forEach</span>(<span class="function">(<span class="params">employee</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> expectedSalary = employee.<span class="title function_">calculateExpectedSalary</span>();</span><br><span class="line">    <span class="keyword">const</span> experience = employee.<span class="title function_">getExperience</span>();</span><br><span class="line">    <span class="keyword">const</span> extra = employee.<span class="title function_">getExtraDetails</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> data = &#123;</span><br><span class="line">      expectedSalary,</span><br><span class="line">      experience,</span><br><span class="line">      extra,</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">render</span>(data);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>您应该对代码复制很挑剔。 有时，通过引入不必要的抽象，在重复的代码和增加的复杂性之间进行权衡。 当来自两个不同模块的两个实现看起来相似但都位于不同的域中时，与提取公共代码相比，复制可能是可接受的并且是首选的方法。 在这种情况下，提取的通用代码在两个模块之间引入了间接依赖性。</p>
<h4 id="使用Object-assign或Destructuring设置默认对象"><a href="#使用Object-assign或Destructuring设置默认对象" class="headerlink" title="使用Object.assign或Destructuring设置默认对象"></a>使用Object.assign或Destructuring设置默认对象</h4><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">MenuConfig</span> = &#123; title?: <span class="built_in">string</span>, body?: <span class="built_in">string</span>, buttonText?: <span class="built_in">string</span>, cancellable?: <span class="built_in">boolean</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">createMenu</span>(<span class="params">config: MenuConfig</span>) &#123;</span><br><span class="line">  config.<span class="property">title</span> = config.<span class="property">title</span> || <span class="string">&#x27;Foo&#x27;</span>;</span><br><span class="line">  config.<span class="property">body</span> = config.<span class="property">body</span> || <span class="string">&#x27;Bar&#x27;</span>;</span><br><span class="line">  config.<span class="property">buttonText</span> = config.<span class="property">buttonText</span> || <span class="string">&#x27;Baz&#x27;</span>;</span><br><span class="line">  config.<span class="property">cancellable</span> = config.<span class="property">cancellable</span> !== <span class="literal">undefined</span> ? config.<span class="property">cancellable</span> : <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">createMenu</span>(&#123; <span class="attr">body</span>: <span class="string">&#x27;Bar&#x27;</span> &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">MenuConfig</span> = &#123; title?: <span class="built_in">string</span>, body?: <span class="built_in">string</span>, buttonText?: <span class="built_in">string</span>, cancellable?: <span class="built_in">boolean</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">createMenu</span>(<span class="params">config: MenuConfig</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> menuConfig = <span class="title class_">Object</span>.<span class="title function_">assign</span>(&#123;</span><br><span class="line">    <span class="attr">title</span>: <span class="string">&#x27;Foo&#x27;</span>,</span><br><span class="line">    <span class="attr">body</span>: <span class="string">&#x27;Bar&#x27;</span>,</span><br><span class="line">    <span class="attr">buttonText</span>: <span class="string">&#x27;Baz&#x27;</span>,</span><br><span class="line">    <span class="attr">cancellable</span>: <span class="literal">true</span></span><br><span class="line">  &#125;, config);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">createMenu</span>(&#123; <span class="attr">body</span>: <span class="string">&#x27;Bar&#x27;</span> &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Good 另外，您可以使用默认值进行解构：</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">MenuConfig</span> = &#123; title?: <span class="built_in">string</span>, body?: <span class="built_in">string</span>, buttonText?: <span class="built_in">string</span>, cancellable?: <span class="built_in">boolean</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">createMenu</span>(<span class="params">&#123; title = <span class="string">&#x27;Foo&#x27;</span>, body = <span class="string">&#x27;Bar&#x27;</span>, buttonText = <span class="string">&#x27;Baz&#x27;</span>, cancellable = <span class="literal">true</span> &#125;: MenuConfig</span>) &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">createMenu</span>(&#123; <span class="attr">body</span>: <span class="string">&#x27;Bar&#x27;</span> &#125;);</span><br></pre></td></tr></table></figure>
<p>为了通过显式传入undefined或null值来避免任何副作用和意外行为，可以告诉TypeScript编译器不允许这样做。 请参见TypeScript中的–strictNullChecks选项。</p>
<h4 id="不要将标志用作函数参数"><a href="#不要将标志用作函数参数" class="headerlink" title="不要将标志用作函数参数"></a>不要将标志用作函数参数</h4><p>标志告诉您的用户，此功能可以完成多项任务。 函数应该做一件事。 如果函数遵循基于布尔的不同代码路径，请拆分它们。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">createFile</span>(<span class="params">name: <span class="built_in">string</span>, temp: <span class="built_in">boolean</span></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (temp) &#123;</span><br><span class="line">    fs.<span class="title function_">create</span>(<span class="string">`./temp/<span class="subst">$&#123;name&#125;</span>`</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    fs.<span class="title function_">create</span>(name);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">createTempFile</span>(<span class="params">name: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">  <span class="title function_">createFile</span>(<span class="string">`./temp/<span class="subst">$&#123;name&#125;</span>`</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">createFile</span>(<span class="params">name: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">  fs.<span class="title function_">create</span>(name);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="避免副作用（第1部分）"><a href="#避免副作用（第1部分）" class="headerlink" title="避免副作用（第1部分）"></a>避免副作用（第1部分）</h4><p>如果函数除了接受一个值并返回另一个值或多个值以外，不执行任何其他操作，都会产生副作用。 副作用可能是写入文件，修改某些全局变量，或者不小心将您的所有资金都汇给了陌生人。</p>
<p>现在，您确实需要偶尔在程序中产生副作用。 与前面的示例一样，您可能需要写入文件。 您想要做的就是集中执行此操作的位置。 没有几个写入特定文件的函数和类。 有一项服务可以做到这一点。 一个，只有一个。</p>
<p>要点是要避免常见的陷阱，例如在没有任何结构的对象之间共享状态，使用可以被任何东西写入的可变数据类型，而不是集中发生副作用的地方。 如果您能做到这一点，您将比绝大多数其他程序员更快乐。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"><span class="comment">// Global variable referenced by following function.</span></span><br><span class="line"><span class="keyword">let</span> name = <span class="string">&#x27;Robert C. Martin&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">toBase64</span>(<span class="params"></span>) &#123;</span><br><span class="line">  name = <span class="title function_">btoa</span>(name);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">toBase64</span>();</span><br><span class="line"><span class="comment">// If we had another function that used this name, now it&#x27;d be a Base64 value</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(name); <span class="comment">// expected to print &#x27;Robert C. Martin&#x27; but instead &#x27;Um9iZXJ0IEMuIE1hcnRpbg==&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"><span class="keyword">const</span> name = <span class="string">&#x27;Robert C. Martin&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">toBase64</span>(<span class="params">text: <span class="built_in">string</span></span>): <span class="built_in">string</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">btoa</span>(text);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> encodedName = <span class="title function_">toBase64</span>(name);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(name);</span><br></pre></td></tr></table></figure>

<h4 id="避免副作用（第2部分）"><a href="#避免副作用（第2部分）" class="headerlink" title="避免副作用（第2部分）"></a>避免副作用（第2部分）</h4><p>在JavaScript中，基元按值传递，而对象/数组按引用传递。对于对象和数组，如果您的函数在购物车数组中进行了更改（例如，通过添加要购买的商品），则使用该购物车数组的任何其他函数都将受到此添加的影响。那可能很棒，但是也可能不好。让我们想象一个糟糕的情况：</p>
<p>用户单击“购买”按钮，该按钮将调用产生网络请求的购物功能，并将购物车阵列发送到服务器。由于网络连接不良，购买功能必须继续重试请求。现在，如果与此同时，用户在网络请求开始之前意外地在他们实际上不想要的商品上单击“添加到购物车”按钮，该怎么办？如果发生这种情况并且网络请求开始，那么该购买功能将发送意外添加的项目，因为它具有对购物车数组的引用，该数组由addItemToCart函数通过添加不需要的项目进行了修改。</p>
<p>一个很好的解决方案是让addItemToCart始终克隆购物车，对其进行编辑并返回克隆。这样可以确保任何保存在购物车参考上的功能都不会受到任何更改的影响。</p>
<p>关于此方法有两个警告：</p>
<p>在某些情况下，您实际上可能想修改输入对象，但是当您采用这种编程习惯时，您会发现这些情况很少见。大多数事情都可以重构为没有副作用！ （请参见纯函数）</p>
<p>就性能而言，克隆大对象可能会非常昂贵。幸运的是，在实践中这并不是一个大问题，因为有很多很棒的库使这种编程方法能够快速进行，并且不像手动克隆对象和数组那样占用大量内存。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">CartItem</span> &#123;</span><br><span class="line">  <span class="attr">item</span>: <span class="title class_">Item</span>;</span><br><span class="line">  <span class="attr">date</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Item</span> &#123;</span><br><span class="line">  <span class="attr">tag</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Bad</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">addItemToCart</span>(<span class="params">cart: CartItem[], item: Item</span>): <span class="built_in">void</span> &#123;</span><br><span class="line">  cart.<span class="title function_">push</span>(&#123; item, <span class="attr">date</span>: <span class="title class_">Date</span>.<span class="title function_">now</span>() &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">addItemToCart</span>(<span class="params">cart: CartItem[], item: Item</span>): <span class="title class_">CartItem</span>[] &#123;</span><br><span class="line">  <span class="keyword">return</span> [...cart, &#123; item, <span class="attr">date</span>: <span class="title class_">Date</span>.<span class="title function_">now</span>() &#125;];</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h4 id="不写入全局函数"><a href="#不写入全局函数" class="headerlink" title="不写入全局函数"></a>不写入全局函数</h4><p>在JavaScript中污染globals是一种不好的做法，因为您可能会与另一个库发生冲突，并且API的用户在生产中遇到异常之前不会更聪明。让我们考虑一个例子：如果您想扩展JavaScript的本机数组方法，使之具有一个diff方法来显示两个数组之间的差异，该怎么办？您可以将新函数写入Array.prototype，但它可能与另一个试图执行相同操作的库冲突。如果另一个库只是使用diff来查找数组的第一个元素和最后一个元素之间的差异呢？这就是为什么只使用类并简单地扩展数组全局会更好的原因。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"><span class="keyword">declare</span> <span class="variable language_">global</span> &#123;</span><br><span class="line">  <span class="keyword">interface</span> <span class="title class_">Array</span>&lt;T&gt; &#123;</span><br><span class="line">    <span class="title function_">diff</span>(<span class="attr">other</span>: T[]): <span class="title class_">Array</span>&lt;T&gt;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">diff</span>) &#123;</span><br><span class="line">  <span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">diff</span> = <span class="keyword">function</span> &lt;T&gt;(<span class="attr">other</span>: T[]): T[] &#123;</span><br><span class="line">    <span class="keyword">const</span> hash = <span class="keyword">new</span> <span class="title class_">Set</span>(other);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">filter</span>(<span class="function"><span class="params">elem</span> =&gt;</span> !hash.<span class="title function_">has</span>(elem));</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyArray</span>&lt;T&gt; <span class="keyword">extends</span> <span class="title class_">Array</span>&lt;T&gt; &#123;</span><br><span class="line">  <span class="title function_">diff</span>(<span class="attr">other</span>: T[]): T[] &#123;</span><br><span class="line">    <span class="keyword">const</span> hash = <span class="keyword">new</span> <span class="title class_">Set</span>(other);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">filter</span>(<span class="function"><span class="params">elem</span> =&gt;</span> !hash.<span class="title function_">has</span>(elem));</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="偏好函数式编程胜过命令式编程"><a href="#偏好函数式编程胜过命令式编程" class="headerlink" title="偏好函数式编程胜过命令式编程"></a>偏好函数式编程胜过命令式编程</h4><p>尽可能的喜欢这种编程风格。<br><code>reduce</code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"><span class="keyword">const</span> contributions = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;Uncle Bobby&#x27;</span>,</span><br><span class="line">    <span class="attr">linesOfCode</span>: <span class="number">500</span></span><br><span class="line">  &#125;, &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;Suzie Q&#x27;</span>,</span><br><span class="line">    <span class="attr">linesOfCode</span>: <span class="number">1500</span></span><br><span class="line">  &#125;, &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;Jimmy Gosling&#x27;</span>,</span><br><span class="line">    <span class="attr">linesOfCode</span>: <span class="number">150</span></span><br><span class="line">  &#125;, &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;Gracie Hopper&#x27;</span>,</span><br><span class="line">    <span class="attr">linesOfCode</span>: <span class="number">1000</span></span><br><span class="line">  &#125;</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> totalOutput = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; contributions.<span class="property">length</span>; i++) &#123;</span><br><span class="line">  totalOutput += contributions[i].<span class="property">linesOfCode</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"><span class="keyword">const</span> contributions = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;Uncle Bobby&#x27;</span>,</span><br><span class="line">    <span class="attr">linesOfCode</span>: <span class="number">500</span></span><br><span class="line">  &#125;, &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;Suzie Q&#x27;</span>,</span><br><span class="line">    <span class="attr">linesOfCode</span>: <span class="number">1500</span></span><br><span class="line">  &#125;, &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;Jimmy Gosling&#x27;</span>,</span><br><span class="line">    <span class="attr">linesOfCode</span>: <span class="number">150</span></span><br><span class="line">  &#125;, &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;Gracie Hopper&#x27;</span>,</span><br><span class="line">    <span class="attr">linesOfCode</span>: <span class="number">1000</span></span><br><span class="line">  &#125;</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> totalOutput = contributions</span><br><span class="line">  .<span class="title function_">reduce</span>(<span class="function">(<span class="params">totalLines, output</span>) =&gt;</span> totalLines + output.<span class="property">linesOfCode</span>, <span class="number">0</span>);</span><br></pre></td></tr></table></figure>

<h4 id="封装条件语句"><a href="#封装条件语句" class="headerlink" title="封装条件语句"></a>封装条件语句</h4><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"><span class="keyword">if</span> (subscription.<span class="property">isTrial</span> || account.<span class="property">balance</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">canActivateService</span>(<span class="params">subscription: Subscription, account: Account</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> subscription.<span class="property">isTrial</span> || account.<span class="property">balance</span> &gt; <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_">canActivateService</span>(subscription, account)) &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="避免否定条件句"><a href="#避免否定条件句" class="headerlink" title="避免否定条件句"></a>避免否定条件句</h4><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">isEmailNotUsed</span>(<span class="params">email: <span class="built_in">string</span></span>): <span class="built_in">boolean</span> &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_">isEmailNotUsed</span>(email)) &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">isEmailUsed</span>(<span class="params">email</span>): <span class="built_in">boolean</span> &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="title function_">isEmailUsed</span>(node)) &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="避免条件句"><a href="#避免条件句" class="headerlink" title="避免条件句"></a>避免条件句</h4><p>这似乎是一项不可能完成的任务。一听到这个，大多数人都会说：“如果没有if语句，我怎么能做任何事情呢？”答案是，在许多情况下，可以使用多态性来实现相同的任务。第二个问题通常是，“很好，但我为什么要这么做呢？”答案是我们以前学到的一个干净的代码概念：函数应该只做一件事。当您有具有if语句的类和函数时，您是在告诉用户您的函数做了不止一件事。记住，只要做一件事。<br><code>abstract </code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Airplane</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="attr">type</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">  <span class="title function_">getCruisingAltitude</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">switch</span> (<span class="variable language_">this</span>.<span class="property">type</span>) &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;777&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">getMaxAltitude</span>() - <span class="variable language_">this</span>.<span class="title function_">getPassengerCount</span>();</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;Air Force One&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">getMaxAltitude</span>();</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;Cessna&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">getMaxAltitude</span>() - <span class="variable language_">this</span>.<span class="title function_">getFuelExpenditure</span>();</span><br><span class="line">      <span class="attr">default</span>:</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;Unknown airplane type.&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="title function_">getMaxAltitude</span>(): <span class="built_in">number</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"><span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Airplane</span> &#123;</span><br><span class="line">  <span class="keyword">protected</span> <span class="title function_">getMaxAltitude</span>(): <span class="built_in">number</span> &#123;</span><br><span class="line">    <span class="comment">// shared logic with subclasses ...</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Boeing777</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Airplane</span> &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="title function_">getCruisingAltitude</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">getMaxAltitude</span>() - <span class="variable language_">this</span>.<span class="title function_">getPassengerCount</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AirForceOne</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Airplane</span> &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="title function_">getCruisingAltitude</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">getMaxAltitude</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Cessna</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Airplane</span> &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="title function_">getCruisingAltitude</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">getMaxAltitude</span>() - <span class="variable language_">this</span>.<span class="title function_">getFuelExpenditure</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="避免类型检查"><a href="#避免类型检查" class="headerlink" title="避免类型检查"></a>避免类型检查</h4><p>TypeScript是JavaScript的一个严格的语法超集，它为语言添加了可选的静态类型检查。总是倾向于指定变量、参数和返回值的类型，以充分利用TypeScript特性的强大功能。它使重构更加容易。<br>TODO</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">travelToTexas</span>(<span class="params">vehicle: Bicycle | Car</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (vehicle <span class="keyword">instanceof</span> <span class="title class_">Bicycle</span>) &#123;</span><br><span class="line">    vehicle.<span class="title function_">pedal</span>(currentLocation, <span class="keyword">new</span> <span class="title class_">Location</span>(<span class="string">&#x27;texas&#x27;</span>));</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (vehicle <span class="keyword">instanceof</span> <span class="title class_">Car</span>) &#123;</span><br><span class="line">    vehicle.<span class="title function_">drive</span>(currentLocation, <span class="keyword">new</span> <span class="title class_">Location</span>(<span class="string">&#x27;texas&#x27;</span>));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Vehicle</span> = <span class="title class_">Bicycle</span> | <span class="title class_">Car</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">travelToTexas</span>(<span class="params">vehicle: Vehicle</span>) &#123;</span><br><span class="line">  vehicle.<span class="title function_">move</span>(currentLocation, <span class="keyword">new</span> <span class="title class_">Location</span>(<span class="string">&#x27;texas&#x27;</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="不要过度优化"><a href="#不要过度优化" class="headerlink" title="不要过度优化"></a>不要过度优化</h4><p>现代浏览器在运行时做了很多优化工作。很多时候，如果你在优化，那么你只是在浪费时间。有很好的资源可以看出哪里缺乏优化。同时瞄准那些目标，直到它们被修复。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"><span class="comment">// On old browsers, each iteration with uncached `list.length` would be costly</span></span><br><span class="line"><span class="comment">// because of `list.length` recomputation. In modern browsers, this is optimized.</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>, len = list.<span class="property">length</span>; i &lt; len; i++) &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; list.<span class="property">length</span>; i++) &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="删除死代码"><a href="#删除死代码" class="headerlink" title="删除死代码"></a>删除死代码</h4><p>死代码和重复代码一样糟糕。没有理由把它保存在你的代码库中。如果没有人叫它，就把它扔掉！如果您仍然需要它，它在您的版本历史中仍然是安全的。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">oldRequestModule</span>(<span class="params">url: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">requestModule</span>(<span class="params">url: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> req = requestModule;</span><br><span class="line"><span class="title function_">inventoryTracker</span>(<span class="string">&#x27;apples&#x27;</span>, req, <span class="string">&#x27;www.inventory-awesome.io&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">requestModule</span>(<span class="params">url: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> req = requestModule;</span><br><span class="line"><span class="title function_">inventoryTracker</span>(<span class="string">&#x27;apples&#x27;</span>, req, <span class="string">&#x27;www.inventory-awesome.io&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h4 id="使用迭代器和生成器"><a href="#使用迭代器和生成器" class="headerlink" title="使用迭代器和生成器"></a>使用迭代器和生成器</h4><p>当处理像流一样使用的数据集合时，请使用生成器和iterable。<br>有一些很好的理由：</p>
<ul>
<li>在被调用方决定访问多少项的意义上，将被调用方与生成器实现分离</li>
<li>延迟执行，项目按需流动</li>
<li>内置对使用for of语法迭代项的支持</li>
<li>iterables允许实现优化的迭代器模式<br>// TODO<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fibonacci</span>(<span class="params">n: <span class="built_in">number</span></span>): <span class="built_in">number</span>[] &#123;</span><br><span class="line">  <span class="keyword">if</span> (n === <span class="number">1</span>) <span class="keyword">return</span> [<span class="number">0</span>];</span><br><span class="line">  <span class="keyword">if</span> (n === <span class="number">2</span>) <span class="keyword">return</span> [<span class="number">0</span>, <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="attr">items</span>: <span class="built_in">number</span>[] = [<span class="number">0</span>, <span class="number">1</span>];</span><br><span class="line">  <span class="keyword">while</span> (items.<span class="property">length</span> &lt; n) &#123;</span><br><span class="line">    items.<span class="title function_">push</span>(items[items.<span class="property">length</span> - <span class="number">2</span>] + items[items.<span class="property">length</span> - <span class="number">1</span>]);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> items;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">print</span>(<span class="params">n: <span class="built_in">number</span></span>) &#123;</span><br><span class="line">  <span class="title function_">fibonacci</span>(n).<span class="title function_">forEach</span>(<span class="function"><span class="params">fib</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(fib));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Print first 10 Fibonacci numbers.</span></span><br><span class="line"><span class="title function_">print</span>(<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"><span class="comment">// Generates an infinite stream of Fibonacci numbers.</span></span><br><span class="line"><span class="comment">// The generator doesn&#x27;t keep the array of all numbers.</span></span><br><span class="line"><span class="keyword">function</span>* <span class="title function_">fibonacci</span>(): <span class="title class_">IterableIterator</span>&lt;<span class="built_in">number</span>&gt; &#123;</span><br><span class="line">  <span class="keyword">let</span> [a, b] = [<span class="number">0</span>, <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">    <span class="keyword">yield</span> a;</span><br><span class="line">    [a, b] = [b, a + b];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">print</span>(<span class="params">n: <span class="built_in">number</span></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> i = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> fib <span class="keyword">of</span> <span class="title function_">fibonacci</span>()) &#123;</span><br><span class="line">    <span class="keyword">if</span> (i++ === n) <span class="keyword">break</span>;  </span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(fib);</span><br><span class="line">  &#125;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Print first 10 Fibonacci numbers.</span></span><br><span class="line"><span class="title function_">print</span>(<span class="number">10</span>);</span><br></pre></td></tr></table></figure>
有些库允许以与本机数组类似的方式使用iterables，方法是链接map、slice、forEach等方法。请参阅itiriri以获取iterables的高级操作示例（或itiriri async以获取异步iterables的操作示例）。<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> itiriri <span class="keyword">from</span> <span class="string">&#x27;itiriri&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span>* <span class="title function_">fibonacci</span>(): <span class="title class_">IterableIterator</span>&lt;<span class="built_in">number</span>&gt; &#123;</span><br><span class="line">  <span class="keyword">let</span> [a, b] = [<span class="number">0</span>, <span class="number">1</span>];</span><br><span class="line"> </span><br><span class="line">  <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">    <span class="keyword">yield</span> a;</span><br><span class="line">    [a, b] = [b, a + b];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">itiriri</span>(<span class="title function_">fibonacci</span>())</span><br><span class="line">  .<span class="title function_">take</span>(<span class="number">10</span>)</span><br><span class="line">  .<span class="title function_">forEach</span>(<span class="function"><span class="params">fib</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(fib));</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="对象和数据结构"><a href="#对象和数据结构" class="headerlink" title="对象和数据结构"></a>对象和数据结构</h3><h4 id="使用getter和setter"><a href="#使用getter和setter" class="headerlink" title="使用getter和setter"></a>使用getter和setter</h4><p>TypeScript支持getter/setter语法。使用getter和setter从封装行为的对象访问数据可能比简单地在对象上查找属性要好。”为什么？”你可能会问。好吧，这里有一个原因列表：</p>
<ul>
<li>当你想做的不仅仅是获取一个对象属性，你不需要查找和更改代码库中的每个访问器。</li>
<li>使在执行集合时添加验证变得简单。</li>
<li>封装内部表示。</li>
<li>在获取和设置时易于添加日志记录和错误处理。</li>
<li>可以延迟加载对象的属性，例如从服务器获取。</li>
</ul>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">BankAccount</span> = &#123;</span><br><span class="line">  <span class="attr">balance</span>: <span class="built_in">number</span>;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> value = <span class="number">100</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="attr">account</span>: <span class="title class_">BankAccount</span> = &#123;</span><br><span class="line">  <span class="attr">balance</span>: <span class="number">0</span>,</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (value &lt; <span class="number">0</span>) &#123;</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;Cannot set negative balance.&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">account.<span class="property">balance</span> = value;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">BankAccount</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="attr">accountBalance</span>: <span class="built_in">number</span> = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">get</span> <span class="title function_">balance</span>(): <span class="built_in">number</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">accountBalance</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">set</span> <span class="title function_">balance</span>(<span class="params">value: <span class="built_in">number</span></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (value &lt; <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;Cannot set negative balance.&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">accountBalance</span> = value;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Now `BankAccount` encapsulates the validation logic.</span></span><br><span class="line"><span class="comment">// If one day the specifications change, and we need extra validation rule,</span></span><br><span class="line"><span class="comment">// we would have to alter only the `setter` implementation,</span></span><br><span class="line"><span class="comment">// leaving all dependent code unchanged.</span></span><br><span class="line"><span class="keyword">const</span> account = <span class="keyword">new</span> <span class="title class_">BankAccount</span>();</span><br><span class="line">account.<span class="property">balance</span> = <span class="number">100</span>;</span><br></pre></td></tr></table></figure>

<h4 id="使对象具有私有-受保护的成员"><a href="#使对象具有私有-受保护的成员" class="headerlink" title="使对象具有私有/受保护的成员"></a>使对象具有私有/受保护的成员</h4><p>TypeScript支持类成员上的public（默认）、protected和private访问器。<br>// TODO</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Circle</span> &#123;</span><br><span class="line">  <span class="attr">radius</span>: <span class="built_in">number</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">radius: <span class="built_in">number</span></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">radius</span> = radius;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">perimeter</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">2</span> * <span class="title class_">Math</span>.<span class="property">PI</span> * <span class="variable language_">this</span>.<span class="property">radius</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">surface</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Math</span>.<span class="property">PI</span> * <span class="variable language_">this</span>.<span class="property">radius</span> * <span class="variable language_">this</span>.<span class="property">radius</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Circle</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"><span class="keyword">private</span> <span class="keyword">readonly</span> radius: <span class="built_in">number</span></span>) &#123;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">perimeter</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">2</span> * <span class="title class_">Math</span>.<span class="property">PI</span> * <span class="variable language_">this</span>.<span class="property">radius</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">surface</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Math</span>.<span class="property">PI</span> * <span class="variable language_">this</span>.<span class="property">radius</span> * <span class="variable language_">this</span>.<span class="property">radius</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="偏好不变性"><a href="#偏好不变性" class="headerlink" title="偏好不变性"></a>偏好不变性</h4><p>TypeScript的类型系统允许您将接口/类上的单个属性标记为只读。这允许你以一种功能性的方式工作（意外的突变是不好的）。<br>对于更高级的场景，有一个内置类型Readonly，它接受类型T，并使用映射类型将其所有属性标记为只读（请参见映射类型）。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Config</span> &#123;</span><br><span class="line">  <span class="attr">host</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">port</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">db</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Config</span> &#123;</span><br><span class="line">  <span class="keyword">readonly</span> <span class="attr">host</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="keyword">readonly</span> <span class="attr">port</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="keyword">readonly</span> <span class="attr">db</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>对于数组，可以使用read only Array<T>创建只读数组。不允许进行push（）和fill（）等更改，但可以使用concat（）和slice（）等不更改值的功能。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"><span class="keyword">const</span> <span class="attr">array</span>: <span class="built_in">number</span>[] = [ <span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span> ];</span><br><span class="line">array = []; <span class="comment">// error</span></span><br><span class="line">array.<span class="title function_">push</span>(<span class="number">100</span>); <span class="comment">// array will updated</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"><span class="keyword">const</span> <span class="attr">array</span>: <span class="title class_">ReadonlyArray</span>&lt;<span class="built_in">number</span>&gt; = [ <span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span> ];</span><br><span class="line">array = []; <span class="comment">// error</span></span><br><span class="line">array.<span class="title function_">push</span>(<span class="number">100</span>); <span class="comment">// error</span></span><br></pre></td></tr></table></figure>

<p>在TypeScript3.4中声明只读参数要容易一些。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hoge</span>(<span class="params">args: <span class="keyword">readonly</span> <span class="built_in">string</span>[]</span>) &#123;</span><br><span class="line">  args.<span class="title function_">push</span>(<span class="number">1</span>); <span class="comment">// error</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>对于文本值，更喜欢const断言。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"><span class="keyword">const</span> config = &#123;</span><br><span class="line">  <span class="attr">hello</span>: <span class="string">&#x27;world&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line">config.<span class="property">hello</span> = <span class="string">&#x27;world&#x27;</span>; <span class="comment">// value is changed</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> array  = [ <span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span> ];</span><br><span class="line">array[<span class="number">0</span>] = <span class="number">10</span>; <span class="comment">// value is changed</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// writable objects is returned</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">readonlyData</span>(<span class="params">value: <span class="built_in">number</span></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123; value &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> result = <span class="title function_">readonlyData</span>(<span class="number">100</span>);</span><br><span class="line">result.<span class="property">value</span> = <span class="number">200</span>; <span class="comment">// value is changed</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"><span class="comment">// read-only object</span></span><br><span class="line"><span class="keyword">const</span> config = &#123;</span><br><span class="line">  <span class="attr">hello</span>: <span class="string">&#x27;world&#x27;</span></span><br><span class="line">&#125; <span class="keyword">as</span> <span class="keyword">const</span>;</span><br><span class="line">config.<span class="property">hello</span> = <span class="string">&#x27;world&#x27;</span>; <span class="comment">// error</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// read-only array</span></span><br><span class="line"><span class="keyword">const</span> array  = [ <span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span> ] <span class="keyword">as</span> <span class="keyword">const</span>;</span><br><span class="line">array[<span class="number">0</span>] = <span class="number">10</span>; <span class="comment">// error</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// You can return read-only objects</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">readonlyData</span>(<span class="params">value: <span class="built_in">number</span></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123; value &#125; <span class="keyword">as</span> <span class="keyword">const</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> result = <span class="title function_">readonlyData</span>(<span class="number">100</span>);</span><br><span class="line">result.<span class="property">value</span> = <span class="number">200</span>; <span class="comment">// error</span></span><br></pre></td></tr></table></figure>

<h4 id="类型与接口"><a href="#类型与接口" class="headerlink" title="类型与接口"></a>类型与接口</h4><p>当您可能需要并集或交集时，请使用类型。如果需要扩展或实现，请使用接口。然而，没有严格的规则，使用一个为你工作。<br>有关更详细的解释，请参阅关于TypeScript中类型和接口之间差异的回答。<br>// TODO</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">EmailConfig</span> &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">DbConfig</span> &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Config</span> &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//...</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Shape</span> = &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">EmailConfig</span> = &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">DbConfig</span> = &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Config</span>  = <span class="title class_">EmailConfig</span> | <span class="title class_">DbConfig</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Shape</span> &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Circle</span> <span class="keyword">implements</span> <span class="title class_">Shape</span> &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Square</span> <span class="keyword">implements</span> <span class="title class_">Shape</span> &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="类"><a href="#类" class="headerlink" title="类"></a>类</h3><h4 id="类应该很小"><a href="#类应该很小" class="headerlink" title="类应该很小"></a>类应该很小</h4><p>类的规模是由它的责任来衡量的。遵循单一责任原则，一个类应该是小的。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Dashboard</span> &#123;</span><br><span class="line">  <span class="title function_">getLanguage</span>(): <span class="built_in">string</span> &#123; <span class="comment">/* ... */</span> &#125;</span><br><span class="line">  <span class="title function_">setLanguage</span>(<span class="attr">language</span>: <span class="built_in">string</span>): <span class="built_in">void</span> &#123; <span class="comment">/* ... */</span> &#125;</span><br><span class="line">  <span class="title function_">showProgress</span>(): <span class="built_in">void</span> &#123; <span class="comment">/* ... */</span> &#125;</span><br><span class="line">  <span class="title function_">hideProgress</span>(): <span class="built_in">void</span> &#123; <span class="comment">/* ... */</span> &#125;</span><br><span class="line">  <span class="title function_">isDirty</span>(): <span class="built_in">boolean</span> &#123; <span class="comment">/* ... */</span> &#125;</span><br><span class="line">  <span class="title function_">disable</span>(): <span class="built_in">void</span> &#123; <span class="comment">/* ... */</span> &#125;</span><br><span class="line">  <span class="title function_">enable</span>(): <span class="built_in">void</span> &#123; <span class="comment">/* ... */</span> &#125;</span><br><span class="line">  <span class="title function_">addSubscription</span>(<span class="attr">subscription</span>: <span class="title class_">Subscription</span>): <span class="built_in">void</span> &#123; <span class="comment">/* ... */</span> &#125;</span><br><span class="line">  <span class="title function_">removeSubscription</span>(<span class="attr">subscription</span>: <span class="title class_">Subscription</span>): <span class="built_in">void</span> &#123; <span class="comment">/* ... */</span> &#125;</span><br><span class="line">  <span class="title function_">addUser</span>(<span class="attr">user</span>: <span class="title class_">User</span>): <span class="built_in">void</span> &#123; <span class="comment">/* ... */</span> &#125;</span><br><span class="line">  <span class="title function_">removeUser</span>(<span class="attr">user</span>: <span class="title class_">User</span>): <span class="built_in">void</span> &#123; <span class="comment">/* ... */</span> &#125;</span><br><span class="line">  <span class="title function_">goToHomePage</span>(): <span class="built_in">void</span> &#123; <span class="comment">/* ... */</span> &#125;</span><br><span class="line">  <span class="title function_">updateProfile</span>(<span class="attr">details</span>: <span class="title class_">UserDetails</span>): <span class="built_in">void</span> &#123; <span class="comment">/* ... */</span> &#125;</span><br><span class="line">  <span class="title function_">getVersion</span>(): <span class="built_in">string</span> &#123; <span class="comment">/* ... */</span> &#125;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Dashboard</span> &#123;</span><br><span class="line">  <span class="title function_">disable</span>(): <span class="built_in">void</span> &#123; <span class="comment">/* ... */</span> &#125;</span><br><span class="line">  <span class="title function_">enable</span>(): <span class="built_in">void</span> &#123; <span class="comment">/* ... */</span> &#125;</span><br><span class="line">  <span class="title function_">getVersion</span>(): <span class="built_in">string</span> &#123; <span class="comment">/* ... */</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// split the responsibilities by moving the remaining methods to other classes</span></span><br><span class="line"><span class="comment">// ...</span></span><br></pre></td></tr></table></figure>

<h4 id="高内聚低耦合"><a href="#高内聚低耦合" class="headerlink" title="高内聚低耦合"></a>高内聚低耦合</h4><p>内聚性定义了类成员相互关联的程度。理想情况下，类中的所有字段都应该由每个方法使用。然后我们说这个类的内聚性最大。然而，在实践中，这并不总是可能的，甚至是不可取的。然而，你应该更喜欢高凝聚力。</p>
<p>耦合是指两个类之间的关系或依赖程度。如果其中一个类中的更改不影响另一个，则称其为低耦合。</p>
<p>良好的软件设计具有高内聚性和低耦合性。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UserManager</span> &#123;</span><br><span class="line">  <span class="comment">// Bad: each private variable is used by one or another group of methods.</span></span><br><span class="line">  <span class="comment">// It makes clear evidence that the class is holding more than a single responsibility.</span></span><br><span class="line">  <span class="comment">// If I need only to create the service to get the transactions for a user,</span></span><br><span class="line">  <span class="comment">// I&#x27;m still forced to pass and instance of `emailSender`.</span></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span></span><br><span class="line"><span class="params">    <span class="keyword">private</span> <span class="keyword">readonly</span> db: Database,</span></span><br><span class="line"><span class="params">    <span class="keyword">private</span> <span class="keyword">readonly</span> emailSender: EmailSender</span>) &#123;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">getUser</span>(<span class="attr">id</span>: <span class="built_in">number</span>): <span class="title class_">Promise</span>&lt;<span class="title class_">User</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">await</span> db.<span class="property">users</span>.<span class="title function_">findOne</span>(&#123; id &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">getTransactions</span>(<span class="attr">userId</span>: <span class="built_in">number</span>): <span class="title class_">Promise</span>&lt;<span class="title class_">Transaction</span>[]&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">await</span> db.<span class="property">transactions</span>.<span class="title function_">find</span>(&#123; userId &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">sendGreeting</span>(): <span class="title class_">Promise</span>&lt;<span class="built_in">void</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">await</span> emailSender.<span class="title function_">send</span>(<span class="string">&#x27;Welcome!&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">sendNotification</span>(<span class="attr">text</span>: <span class="built_in">string</span>): <span class="title class_">Promise</span>&lt;<span class="built_in">void</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">await</span> emailSender.<span class="title function_">send</span>(text);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">sendNewsletter</span>(): <span class="title class_">Promise</span>&lt;<span class="built_in">void</span>&gt; &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"><span class="keyword">private</span> <span class="keyword">readonly</span> db: Database</span>) &#123;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">getUser</span>(<span class="attr">id</span>: <span class="built_in">number</span>): <span class="title class_">Promise</span>&lt;<span class="title class_">User</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">db</span>.<span class="property">users</span>.<span class="title function_">findOne</span>(&#123; id &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">getTransactions</span>(<span class="attr">userId</span>: <span class="built_in">number</span>): <span class="title class_">Promise</span>&lt;<span class="title class_">Transaction</span>[]&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">db</span>.<span class="property">transactions</span>.<span class="title function_">find</span>(&#123; userId &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UserNotifier</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"><span class="keyword">private</span> <span class="keyword">readonly</span> emailSender: EmailSender</span>) &#123;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">sendGreeting</span>(): <span class="title class_">Promise</span>&lt;<span class="built_in">void</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">emailSender</span>.<span class="title function_">send</span>(<span class="string">&#x27;Welcome!&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">sendNotification</span>(<span class="attr">text</span>: <span class="built_in">string</span>): <span class="title class_">Promise</span>&lt;<span class="built_in">void</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">emailSender</span>.<span class="title function_">send</span>(text);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">sendNewsletter</span>(): <span class="title class_">Promise</span>&lt;<span class="built_in">void</span>&gt; &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="喜欢组合胜过继承"><a href="#喜欢组合胜过继承" class="headerlink" title="喜欢组合胜过继承"></a>喜欢组合胜过继承</h4><p>正如“四人帮”在设计模式中所说的那样，您应该尽可能地选择组合而不是继承。使用继承有很多好的理由，使用组合也有很多好的理由。这句格言的要点是，如果你的大脑本能地去继承，那么试着去思考构图是否能更好地模拟你的问题。在某些情况下可以。<br>你可能会想，“我什么时候应该使用继承权？”这取决于你手头的问题，但这是一个很好的列表，说明什么时候继承比组合更有意义：</p>
<ul>
<li>您的继承表示“是”关系，而不是“有”关系（人-&gt;动物vs.用户-&gt;用户详细信息）。</li>
<li>您可以重用基类中的代码（人类可以像所有动物一样移动）。</li>
<li>您希望通过更改基类对派生类进行全局更改。（改变所有动物移动时的热量消耗）。</li>
</ul>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Employee</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span></span><br><span class="line"><span class="params">    <span class="keyword">private</span> <span class="keyword">readonly</span> name: <span class="built_in">string</span>,</span></span><br><span class="line"><span class="params">    <span class="keyword">private</span> <span class="keyword">readonly</span> email: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Bad because Employees &quot;have&quot; tax data. EmployeeTaxData is not a type of Employee</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">EmployeeTaxData</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Employee</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span></span><br><span class="line"><span class="params">    name: <span class="built_in">string</span>,</span></span><br><span class="line"><span class="params">    email: <span class="built_in">string</span>,</span></span><br><span class="line"><span class="params">    <span class="keyword">private</span> <span class="keyword">readonly</span> ssn: <span class="built_in">string</span>,</span></span><br><span class="line"><span class="params">    <span class="keyword">private</span> <span class="keyword">readonly</span> salary: <span class="built_in">number</span></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(name, email);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Employee</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="attr">taxData</span>: <span class="title class_">EmployeeTaxData</span>;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span></span><br><span class="line"><span class="params">    <span class="keyword">private</span> <span class="keyword">readonly</span> name: <span class="built_in">string</span>,</span></span><br><span class="line"><span class="params">    <span class="keyword">private</span> <span class="keyword">readonly</span> email: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">setTaxData</span>(<span class="attr">ssn</span>: <span class="built_in">string</span>, <span class="attr">salary</span>: <span class="built_in">number</span>): <span class="title class_">Employee</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">taxData</span> = <span class="keyword">new</span> <span class="title class_">EmployeeTaxData</span>(ssn, salary);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">EmployeeTaxData</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span></span><br><span class="line"><span class="params">    <span class="keyword">public</span> <span class="keyword">readonly</span> ssn: <span class="built_in">string</span>,</span></span><br><span class="line"><span class="params">    <span class="keyword">public</span> <span class="keyword">readonly</span> salary: <span class="built_in">number</span></span>) &#123;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="使用方法链接"><a href="#使用方法链接" class="headerlink" title="使用方法链接"></a>使用方法链接</h4><p>这种模式非常有用，在许多库中都很常用。它允许您的代码具有表现力，并且不太冗长。因此，请使用方法链接并查看代码的干净程度。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">QueryBuilder</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="attr">collection</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="keyword">private</span> <span class="attr">pageNumber</span>: <span class="built_in">number</span> = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">private</span> <span class="attr">itemsPerPage</span>: <span class="built_in">number</span> = <span class="number">100</span>;</span><br><span class="line">  <span class="keyword">private</span> <span class="attr">orderByFields</span>: <span class="built_in">string</span>[] = [];</span><br><span class="line"></span><br><span class="line">  <span class="title function_">from</span>(<span class="attr">collection</span>: <span class="built_in">string</span>): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">collection</span> = collection;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">page</span>(<span class="attr">number</span>: <span class="built_in">number</span>, <span class="attr">itemsPerPage</span>: <span class="built_in">number</span> = <span class="number">100</span>): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">pageNumber</span> = <span class="built_in">number</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">itemsPerPage</span> = itemsPerPage;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">orderBy</span>(...<span class="attr">fields</span>: <span class="built_in">string</span>[]): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">orderByFields</span> = fields;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">build</span>(): <span class="title class_">Query</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> queryBuilder = <span class="keyword">new</span> <span class="title class_">QueryBuilder</span>();</span><br><span class="line">queryBuilder.<span class="title function_">from</span>(<span class="string">&#x27;users&#x27;</span>);</span><br><span class="line">queryBuilder.<span class="title function_">page</span>(<span class="number">1</span>, <span class="number">100</span>);</span><br><span class="line">queryBuilder.<span class="title function_">orderBy</span>(<span class="string">&#x27;firstName&#x27;</span>, <span class="string">&#x27;lastName&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> query = queryBuilder.<span class="title function_">build</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">QueryBuilder</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="attr">collection</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="keyword">private</span> <span class="attr">pageNumber</span>: <span class="built_in">number</span> = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">private</span> <span class="attr">itemsPerPage</span>: <span class="built_in">number</span> = <span class="number">100</span>;</span><br><span class="line">  <span class="keyword">private</span> <span class="attr">orderByFields</span>: <span class="built_in">string</span>[] = [];</span><br><span class="line"></span><br><span class="line">  <span class="title function_">from</span>(<span class="attr">collection</span>: <span class="built_in">string</span>): <span class="variable language_">this</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">collection</span> = collection;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">page</span>(<span class="attr">number</span>: <span class="built_in">number</span>, <span class="attr">itemsPerPage</span>: <span class="built_in">number</span> = <span class="number">100</span>): <span class="variable language_">this</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">pageNumber</span> = <span class="built_in">number</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">itemsPerPage</span> = itemsPerPage;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">orderBy</span>(...<span class="attr">fields</span>: <span class="built_in">string</span>[]): <span class="variable language_">this</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">orderByFields</span> = fields;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">build</span>(): <span class="title class_">Query</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> query = <span class="keyword">new</span> <span class="title class_">QueryBuilder</span>()</span><br><span class="line">  .<span class="title function_">from</span>(<span class="string">&#x27;users&#x27;</span>)</span><br><span class="line">  .<span class="title function_">page</span>(<span class="number">1</span>, <span class="number">100</span>)</span><br><span class="line">  .<span class="title function_">orderBy</span>(<span class="string">&#x27;firstName&#x27;</span>, <span class="string">&#x27;lastName&#x27;</span>)</span><br><span class="line">  .<span class="title function_">build</span>();</span><br></pre></td></tr></table></figure>

<h3 id="SOLID"><a href="#SOLID" class="headerlink" title="SOLID"></a>SOLID</h3><p>SOLID 是由 Robert C. Martin 在面向对象设计的（OOD）中提出的五个原则，你可以在这里更一步了解关于@UncleBob，这五个原则（SOLID）就是：</p>
<p>单一职责原则（Single Responsibility Principle）：当需要修改某个类的时候原因有且只有一个<br>开放封闭原则（Open Closed Principle）：软件实体应该是可扩展，而不能可修改的<br>里氏替换原则（Liskov Substitution Principle）：子类的实例应该能够替换任何其超类的实例<br>接口分离原则（Interface Segregation Principle）：使用多个专门的接口比使用单一的总接口总要好<br>依赖倒置原则（Dependency Inversion Principle）：依赖于抽象不应该依赖于细节<br>这些原则使得程序员可以轻松地开发易于维护和扩展的软件。它们还使开发人员的代码能够容易地避免坏气味，轻松重构代码，并且也是敏捷或自适应软件开发的一部分。</p>
<h4 id="单一责任原则"><a href="#单一责任原则" class="headerlink" title="单一责任原则"></a>单一责任原则</h4><p>如干净代码中所述，“类更改的原因不应超过一个”。很容易把一个功能性很强的班级塞满，比如你在航班上只能带一个手提箱。这样做的问题是，你的类在概念上没有凝聚力，它会给它很多改变的理由。最小化您需要更改类的次数非常重要。这很重要，因为如果一个类中有太多的功能，并且您修改了其中的一部分，那么很难理解这将如何影响代码库中的其他依赖模块。<br>// TODO</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UserSettings</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"><span class="keyword">private</span> <span class="keyword">readonly</span> user: User</span>) &#123;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">changeSettings</span>(<span class="params">settings: UserSettings</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="title function_">verifyCredentials</span>()) &#123;</span><br><span class="line">      <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">verifyCredentials</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UserAuth</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"><span class="keyword">private</span> <span class="keyword">readonly</span> user: User</span>) &#123;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">verifyCredentials</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UserSettings</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">readonly</span> <span class="attr">auth</span>: <span class="title class_">UserAuth</span>;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"><span class="keyword">private</span> <span class="keyword">readonly</span> user: User</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">auth</span> = <span class="keyword">new</span> <span class="title class_">UserAuth</span>(user);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">changeSettings</span>(<span class="params">settings: UserSettings</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">auth</span>.<span class="title function_">verifyCredentials</span>()) &#123;</span><br><span class="line">      <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="开闭原理"><a href="#开闭原理" class="headerlink" title="开闭原理"></a>开闭原理</h4><p>正如Bertrand Meyer所说，“软件实体（类、模块、函数等）应该开放以供扩展，但关闭以供修改。”这意味着什么？这个原则基本上是说你应该允许用户在不改变现有代码的情况下添加新的功能。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AjaxAdapter</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Adapter</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">NodeAdapter</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Adapter</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">HttpRequester</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"><span class="keyword">private</span> <span class="keyword">readonly</span> adapter: Adapter</span>) &#123;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> fetch&lt;T&gt;(<span class="attr">url</span>: <span class="built_in">string</span>): <span class="title class_">Promise</span>&lt;T&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">adapter</span> <span class="keyword">instanceof</span> <span class="title class_">AjaxAdapter</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> response = <span class="keyword">await</span> makeAjaxCall&lt;T&gt;(url);</span><br><span class="line">      <span class="comment">// transform response and return</span></span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">adapter</span> <span class="keyword">instanceof</span> <span class="title class_">NodeAdapter</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> response = <span class="keyword">await</span> makeHttpCall&lt;T&gt;(url);</span><br><span class="line">      <span class="comment">// transform response and return</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> makeAjaxCall&lt;T&gt;(<span class="attr">url</span>: <span class="built_in">string</span>): <span class="title class_">Promise</span>&lt;T&gt; &#123;</span><br><span class="line">  <span class="comment">// request and return promise</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> makeHttpCall&lt;T&gt;(<span class="attr">url</span>: <span class="built_in">string</span>): <span class="title class_">Promise</span>&lt;T&gt; &#123;</span><br><span class="line">  <span class="comment">// request and return promise</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"><span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Adapter</span> &#123;</span><br><span class="line">  <span class="keyword">abstract</span> <span class="keyword">async</span> request&lt;T&gt;(<span class="attr">url</span>: <span class="built_in">string</span>): <span class="title class_">Promise</span>&lt;T&gt;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// code shared to subclasses ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AjaxAdapter</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Adapter</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> request&lt;T&gt;(<span class="attr">url</span>: <span class="built_in">string</span>): <span class="title class_">Promise</span>&lt;T&gt;&#123;</span><br><span class="line">    <span class="comment">// request and return promise</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">NodeAdapter</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Adapter</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> request&lt;T&gt;(<span class="attr">url</span>: <span class="built_in">string</span>): <span class="title class_">Promise</span>&lt;T&gt;&#123;</span><br><span class="line">    <span class="comment">// request and return promise</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">HttpRequester</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"><span class="keyword">private</span> <span class="keyword">readonly</span> adapter: Adapter</span>) &#123;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> fetch&lt;T&gt;(<span class="attr">url</span>: <span class="built_in">string</span>): <span class="title class_">Promise</span>&lt;T&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">adapter</span>.<span class="property">request</span>&lt;T&gt;(url);</span><br><span class="line">    <span class="comment">// transform response and return</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Liskov替代原理（LSP）"><a href="#Liskov替代原理（LSP）" class="headerlink" title="Liskov替代原理（LSP）"></a>Liskov替代原理（LSP）</h4><p>对于一个非常简单的概念来说，这是一个可怕的术语。它被正式定义为“如果s是T的一个子类型，那么T类型的对象可以替换为s类型的对象（即，s类型的对象可以替换T类型的对象），而不改变该程序的任何期望属性（正确性、执行的任务等）。”这是一个更可怕的定义。</p>
<p>最好的解释是，如果有父类和子类，那么父类和子类可以互换使用，而不会得到错误的结果。这可能仍然令人困惑，所以让我们看一看经典的正方形矩形示例。从数学上讲，正方形是一个长方形，但如果通过继承使用“is-a”关系对其建模，则很快就会遇到麻烦。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Rectangle</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span></span><br><span class="line"><span class="params">    <span class="keyword">protected</span> width: <span class="built_in">number</span> = <span class="number">0</span>,</span></span><br><span class="line"><span class="params">    <span class="keyword">protected</span> height: <span class="built_in">number</span> = <span class="number">0</span></span>) &#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">setColor</span>(<span class="attr">color</span>: <span class="built_in">string</span>): <span class="variable language_">this</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params">area: <span class="built_in">number</span></span>) &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">setWidth</span>(<span class="attr">width</span>: <span class="built_in">number</span>): <span class="variable language_">this</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">width</span> = width;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">setHeight</span>(<span class="attr">height</span>: <span class="built_in">number</span>): <span class="variable language_">this</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">height</span> = height;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">getArea</span>(): <span class="built_in">number</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">width</span> * <span class="variable language_">this</span>.<span class="property">height</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Square</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Rectangle</span> &#123;</span><br><span class="line">  <span class="title function_">setWidth</span>(<span class="attr">width</span>: <span class="built_in">number</span>): <span class="variable language_">this</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">width</span> = width;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">height</span> = width;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">setHeight</span>(<span class="attr">height</span>: <span class="built_in">number</span>): <span class="variable language_">this</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">width</span> = height;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">height</span> = height;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">renderLargeRectangles</span>(<span class="params">rectangles: Rectangle[]</span>) &#123;</span><br><span class="line">  rectangles.<span class="title function_">forEach</span>(<span class="function">(<span class="params">rectangle</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> area = rectangle</span><br><span class="line">      .<span class="title function_">setWidth</span>(<span class="number">4</span>)</span><br><span class="line">      .<span class="title function_">setHeight</span>(<span class="number">5</span>)</span><br><span class="line">      .<span class="title function_">getArea</span>(); <span class="comment">// BAD: Returns 25 for Square. Should be 20.</span></span><br><span class="line">    rectangle.<span class="title function_">render</span>(area);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> rectangles = [<span class="keyword">new</span> <span class="title class_">Rectangle</span>(), <span class="keyword">new</span> <span class="title class_">Rectangle</span>(), <span class="keyword">new</span> <span class="title class_">Square</span>()];</span><br><span class="line"><span class="title function_">renderLargeRectangles</span>(rectangles);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"><span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Shape</span> &#123;</span><br><span class="line">  <span class="title function_">setColor</span>(<span class="attr">color</span>: <span class="built_in">string</span>): <span class="variable language_">this</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params">area: <span class="built_in">number</span></span>) &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">abstract</span> <span class="title function_">getArea</span>(): <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Rectangle</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Shape</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span></span><br><span class="line"><span class="params">    <span class="keyword">private</span> <span class="keyword">readonly</span> width = <span class="number">0</span>,</span></span><br><span class="line"><span class="params">    <span class="keyword">private</span> <span class="keyword">readonly</span> height = <span class="number">0</span></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">getArea</span>(): <span class="built_in">number</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">width</span> * <span class="variable language_">this</span>.<span class="property">height</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Square</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Shape</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"><span class="keyword">private</span> <span class="keyword">readonly</span> length: <span class="built_in">number</span></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">getArea</span>(): <span class="built_in">number</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">length</span> * <span class="variable language_">this</span>.<span class="property">length</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">renderLargeShapes</span>(<span class="params">shapes: Shape[]</span>) &#123;</span><br><span class="line">  shapes.<span class="title function_">forEach</span>(<span class="function">(<span class="params">shape</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> area = shape.<span class="title function_">getArea</span>();</span><br><span class="line">    shape.<span class="title function_">render</span>(area);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> shapes = [<span class="keyword">new</span> <span class="title class_">Rectangle</span>(<span class="number">4</span>, <span class="number">5</span>), <span class="keyword">new</span> <span class="title class_">Rectangle</span>(<span class="number">4</span>, <span class="number">5</span>), <span class="keyword">new</span> <span class="title class_">Square</span>(<span class="number">5</span>)];</span><br><span class="line"><span class="title function_">renderLargeShapes</span>(shapes);</span><br></pre></td></tr></table></figure>

<h4 id="界面分离原理（ISP）"><a href="#界面分离原理（ISP）" class="headerlink" title="界面分离原理（ISP）"></a>界面分离原理（ISP）</h4><p>ISP声明“不应强迫客户依赖他们不使用的接口”。这一原则与单一责任原则密切相关。它的真正含义是，您应该始终以这样一种方式设计您的抽象，即使用公开方法的客户机不会得到整个饼图。这还包括强迫客户机实现他们实际上不需要的方法。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">SmartPrinter</span> &#123;</span><br><span class="line">  <span class="title function_">print</span>();</span><br><span class="line">  <span class="title function_">fax</span>();</span><br><span class="line">  <span class="title function_">scan</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AllInOnePrinter</span> <span class="keyword">implements</span> <span class="title class_">SmartPrinter</span> &#123;</span><br><span class="line">  <span class="title function_">print</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;  </span><br><span class="line">  </span><br><span class="line">  <span class="title function_">fax</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">scan</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">EconomicPrinter</span> <span class="keyword">implements</span> <span class="title class_">SmartPrinter</span> &#123;</span><br><span class="line">  <span class="title function_">print</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;  </span><br><span class="line">  </span><br><span class="line">  <span class="title function_">fax</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;Fax not supported.&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">scan</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;Scan not supported.&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Printer</span> &#123;</span><br><span class="line">  <span class="title function_">print</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Fax</span> &#123;</span><br><span class="line">  <span class="title function_">fax</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Scanner</span> &#123;</span><br><span class="line">  <span class="title function_">scan</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AllInOnePrinter</span> <span class="keyword">implements</span> <span class="title class_">Printer</span>, <span class="title class_">Fax</span>, <span class="title class_">Scanner</span> &#123;</span><br><span class="line">  <span class="title function_">print</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;  </span><br><span class="line">  </span><br><span class="line">  <span class="title function_">fax</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">scan</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">EconomicPrinter</span> <span class="keyword">implements</span> <span class="title class_">Printer</span> &#123;</span><br><span class="line">  <span class="title function_">print</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="依赖反演原理（DIP）"><a href="#依赖反演原理（DIP）" class="headerlink" title="依赖反演原理（DIP）"></a>依赖反演原理（DIP）</h4><p>这一原则规定了两件基本的事情：</p>
<ul>
<li>高级模块不应依赖于低级模块。两者都应该依赖于抽象。</li>
<li>抽象不应依赖于细节。细节应该取决于抽象。<br>一开始这可能很难理解，但是如果您使用过Angular，那么您已经看到了以依赖注入（DI）的形式实现这一原则。虽然它们不是完全相同的概念，但DIP使高级模块无法了解其低级模块的详细信息并设置它们。它可以通过DI来实现这一点。这样做的一个巨大好处是减少了模块之间的耦合。耦合是一种非常糟糕的开发模式，因为它使您的代码难以重构。<br>下倾通常通过使用控制反转（IoC）容器来实现。TypeScript的强大IoC容器的一个例子是InversifyJs</li>
</ul>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"><span class="keyword">import</span> &#123; readFile <span class="keyword">as</span> readFileCb &#125; <span class="keyword">from</span> <span class="string">&#x27;fs&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; promisify &#125; <span class="keyword">from</span> <span class="string">&#x27;util&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> readFile = <span class="title function_">promisify</span>(readFileCb);</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">ReportData</span> = &#123;</span><br><span class="line">  <span class="comment">// ..</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">XmlFormatter</span> &#123;</span><br><span class="line">  parse&lt;T&gt;(<span class="attr">content</span>: <span class="built_in">string</span>): T &#123;</span><br><span class="line">    <span class="comment">// Converts an XML string to an object T</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ReportReader</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// BAD: We have created a dependency on a specific request implementation.</span></span><br><span class="line">  <span class="comment">// We should just have ReportReader depend on a parse method: `parse`</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">readonly</span> formatter = <span class="keyword">new</span> <span class="title class_">XmlFormatter</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">read</span>(<span class="attr">path</span>: <span class="built_in">string</span>): <span class="title class_">Promise</span>&lt;<span class="title class_">ReportData</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> text = <span class="keyword">await</span> <span class="title function_">readFile</span>(path, <span class="string">&#x27;UTF8&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">formatter</span>.<span class="property">parse</span>&lt;<span class="title class_">ReportData</span>&gt;(text);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"><span class="keyword">const</span> reader = <span class="keyword">new</span> <span class="title class_">ReportReader</span>();</span><br><span class="line"><span class="keyword">await</span> report = <span class="keyword">await</span> reader.<span class="title function_">read</span>(<span class="string">&#x27;report.xml&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"><span class="keyword">import</span> &#123; readFile <span class="keyword">as</span> readFileCb &#125; <span class="keyword">from</span> <span class="string">&#x27;fs&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; promisify &#125; <span class="keyword">from</span> <span class="string">&#x27;util&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> readFile = <span class="title function_">promisify</span>(readFileCb);</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">ReportData</span> = &#123;</span><br><span class="line">  <span class="comment">// ..</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Formatter</span> &#123;</span><br><span class="line">  parse&lt;T&gt;(<span class="attr">content</span>: <span class="built_in">string</span>): T;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">XmlFormatter</span> <span class="keyword">implements</span> <span class="title class_">Formatter</span> &#123;</span><br><span class="line">  parse&lt;T&gt;(<span class="attr">content</span>: <span class="built_in">string</span>): T &#123;</span><br><span class="line">    <span class="comment">// Converts an XML string to an object T</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">JsonFormatter</span> <span class="keyword">implements</span> <span class="title class_">Formatter</span> &#123;</span><br><span class="line">  parse&lt;T&gt;(<span class="attr">content</span>: <span class="built_in">string</span>): T &#123;</span><br><span class="line">    <span class="comment">// Converts a JSON string to an object T</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ReportReader</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"><span class="keyword">private</span> <span class="keyword">readonly</span> formatter: Formatter</span>) &#123;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">read</span>(<span class="attr">path</span>: <span class="built_in">string</span>): <span class="title class_">Promise</span>&lt;<span class="title class_">ReportData</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> text = <span class="keyword">await</span> <span class="title function_">readFile</span>(path, <span class="string">&#x27;UTF8&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">formatter</span>.<span class="property">parse</span>&lt;<span class="title class_">ReportData</span>&gt;(text);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"><span class="keyword">const</span> reader = <span class="keyword">new</span> <span class="title class_">ReportReader</span>(<span class="keyword">new</span> <span class="title class_">XmlFormatter</span>());</span><br><span class="line"><span class="keyword">await</span> report = <span class="keyword">await</span> reader.<span class="title function_">read</span>(<span class="string">&#x27;report.xml&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// or if we had to read a json report</span></span><br><span class="line"><span class="keyword">const</span> reader = <span class="keyword">new</span> <span class="title class_">ReportReader</span>(<span class="keyword">new</span> <span class="title class_">JsonFormatter</span>());</span><br><span class="line"><span class="keyword">await</span> report = <span class="keyword">await</span> reader.<span class="title function_">read</span>(<span class="string">&#x27;report.json&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h3 id="单元测试"><a href="#单元测试" class="headerlink" title="单元测试"></a>单元测试</h3><p>测试比运输更重要。如果你没有测试或者数量不足，那么每次你发布代码的时候，你都不会确定你没有破坏任何东西。决定什么是一个足够的数量取决于你的团队，但是100%的覆盖率（所有的声明和分支）是你如何获得非常高的信心和开发者的安心。这意味着除了有一个好的测试框架外，还需要使用一个好的覆盖工具。<br>没有理由不写测试。有很多很好的JS测试框架支持TypeScript的类型，所以找一个你的团队喜欢的。当您找到一个适合您的团队的功能时，请始终为您引入的每个新功能/模块编写测试。如果您首选的方法是测试驱动开发（TDD），那就太好了，但重点是在启动任何功能或重构现有功能之前，确保您达到了覆盖率目标。</p>
<p>TDD的三定律</p>
<ul>
<li>除非要使失败的单元测试通过，否则不允许编写任何生产代码。</li>
<li>不允许您编写的单元测试超过了失败的数量；编译失败就是失败。</li>
<li>不允许您编写的生产代码超过足以通过一次失败的单元测试的数量。</li>
</ul>
<h4 id="F-I-R-S-T-规则"><a href="#F-I-R-S-T-规则" class="headerlink" title="F.I.R.S.T.规则"></a>F.I.R.S.T.规则</h4><p>清洁测试应遵循以下规则：</p>
<ul>
<li>快速测试应该很快，因为我们希望经常运行它们。</li>
<li>独立测试不应相互依赖。它们应该提供相同的输出，无论是独立运行还是以任何顺序一起运行。</li>
<li>可重复的测试应该在任何环境中都是可重复的，不应该有任何理由解释为什么它们会失败。</li>
<li>自验证测试的答案应为“通过”或“失败”。如果测试通过，则不需要比较日志文件来回答问题。</li>
<li>及时的单元测试应该在生产代码之前编写。如果在生产代码之后编写测试，可能会发现编写测试太难。</li>
</ul>
<h4 id="每次测试的单一概念"><a href="#每次测试的单一概念" class="headerlink" title="每次测试的单一概念"></a>每次测试的单一概念</h4><p>测试也应遵循单一责任原则。每个单元测试只生成一个断言。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"><span class="keyword">import</span> &#123; assert &#125; <span class="keyword">from</span> <span class="string">&#x27;chai&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_">describe</span>(<span class="string">&#x27;AwesomeDate&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&#x27;handles date boundaries&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="attr">date</span>: <span class="title class_">AwesomeDate</span>;</span><br><span class="line"></span><br><span class="line">    date = <span class="keyword">new</span> <span class="title class_">AwesomeDate</span>(<span class="string">&#x27;1/1/2015&#x27;</span>);</span><br><span class="line">    assert.<span class="title function_">equal</span>(<span class="string">&#x27;1/31/2015&#x27;</span>, date.<span class="title function_">addDays</span>(<span class="number">30</span>));</span><br><span class="line"></span><br><span class="line">    date = <span class="keyword">new</span> <span class="title class_">AwesomeDate</span>(<span class="string">&#x27;2/1/2016&#x27;</span>);</span><br><span class="line">    assert.<span class="title function_">equal</span>(<span class="string">&#x27;2/29/2016&#x27;</span>, date.<span class="title function_">addDays</span>(<span class="number">28</span>));</span><br><span class="line"></span><br><span class="line">    date = <span class="keyword">new</span> <span class="title class_">AwesomeDate</span>(<span class="string">&#x27;2/1/2015&#x27;</span>);</span><br><span class="line">    assert.<span class="title function_">equal</span>(<span class="string">&#x27;3/1/2015&#x27;</span>, date.<span class="title function_">addDays</span>(<span class="number">28</span>));</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"><span class="keyword">import</span> &#123; assert &#125; <span class="keyword">from</span> <span class="string">&#x27;chai&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_">describe</span>(<span class="string">&#x27;AwesomeDate&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&#x27;handles 30-day months&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> date = <span class="keyword">new</span> <span class="title class_">AwesomeDate</span>(<span class="string">&#x27;1/1/2015&#x27;</span>);</span><br><span class="line">    assert.<span class="title function_">equal</span>(<span class="string">&#x27;1/31/2015&#x27;</span>, date.<span class="title function_">addDays</span>(<span class="number">30</span>));</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&#x27;handles leap year&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> date = <span class="keyword">new</span> <span class="title class_">AwesomeDate</span>(<span class="string">&#x27;2/1/2016&#x27;</span>);</span><br><span class="line">    assert.<span class="title function_">equal</span>(<span class="string">&#x27;2/29/2016&#x27;</span>, date.<span class="title function_">addDays</span>(<span class="number">28</span>));</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&#x27;handles non-leap year&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> date = <span class="keyword">new</span> <span class="title class_">AwesomeDate</span>(<span class="string">&#x27;2/1/2015&#x27;</span>);</span><br><span class="line">    assert.<span class="title function_">equal</span>(<span class="string">&#x27;3/1/2015&#x27;</span>, date.<span class="title function_">addDays</span>(<span class="number">28</span>));</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="测试的名称应该表明它的意图"><a href="#测试的名称应该表明它的意图" class="headerlink" title="测试的名称应该表明它的意图"></a>测试的名称应该表明它的意图</h4><p>当一个测试失败时，它的名字是可能出错的第一个指示。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"><span class="title function_">describe</span>(<span class="string">&#x27;Calendar&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&#x27;2/29/2020&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&#x27;throws&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"><span class="title function_">describe</span>(<span class="string">&#x27;Calendar&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&#x27;should handle leap year&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&#x27;should throw when format is invalid&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="并发性"><a href="#并发性" class="headerlink" title="并发性"></a>并发性</h3><h4 id="Prefer-promises-vs-callbacks-宁可承诺也不要回调"><a href="#Prefer-promises-vs-callbacks-宁可承诺也不要回调" class="headerlink" title="Prefer promises vs callbacks 宁可承诺也不要回调"></a>Prefer promises vs callbacks 宁可承诺也不要回调</h4><p>回调是不干净的，它们导致大量的嵌套（回调地狱）。<br>有些实用程序使用回调样式将现有函数转换为返回promises的版本（对于Node.js，请参见util.promisify，对于一般用途，请参见pify，es6 promisify）</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"><span class="keyword">import</span> &#123; get &#125; <span class="keyword">from</span> <span class="string">&#x27;request&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; writeFile &#125; <span class="keyword">from</span> <span class="string">&#x27;fs&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">downloadPage</span>(<span class="params">url: <span class="built_in">string</span>, saveTo: <span class="built_in">string</span>, callback: (error: <span class="built_in">Error</span>, content?: <span class="built_in">string</span>) =&gt; <span class="built_in">void</span></span>) &#123;</span><br><span class="line">  <span class="title function_">get</span>(url, <span class="function">(<span class="params">error, response</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (error) &#123;</span><br><span class="line">      <span class="title function_">callback</span>(error);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="title function_">writeFile</span>(saveTo, response.<span class="property">body</span>, <span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (error) &#123;</span><br><span class="line">          <span class="title function_">callback</span>(error);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="title function_">callback</span>(<span class="literal">null</span>, response.<span class="property">body</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">downloadPage</span>(<span class="string">&#x27;https://en.wikipedia.org/wiki/Robert_Cecil_Martin&#x27;</span>, <span class="string">&#x27;article.html&#x27;</span>, <span class="function">(<span class="params">error, content</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (error) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(error);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(content);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"><span class="keyword">import</span> &#123; get &#125; <span class="keyword">from</span> <span class="string">&#x27;request&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; writeFile &#125; <span class="keyword">from</span> <span class="string">&#x27;fs&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; promisify &#125; <span class="keyword">from</span> <span class="string">&#x27;util&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> write = <span class="title function_">promisify</span>(writeFile);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">downloadPage</span>(<span class="params">url: <span class="built_in">string</span>, saveTo: <span class="built_in">string</span></span>): <span class="title class_">Promise</span>&lt;<span class="built_in">string</span>&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">get</span>(url)</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function"><span class="params">response</span> =&gt;</span> <span class="title function_">write</span>(saveTo, response));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">downloadPage</span>(<span class="string">&#x27;https://en.wikipedia.org/wiki/Robert_Cecil_Martin&#x27;</span>, <span class="string">&#x27;article.html&#x27;</span>)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function"><span class="params">content</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(content))</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="function"><span class="params">error</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">error</span>(error));  </span><br></pre></td></tr></table></figure>
<p>Promises supports a few helper methods that help make code more conscise:</p>
<p>Pattern    Description<br>Promise.resolve(value)    Convert a value into a resolved promise.<br>Promise.reject(error)    Convert an error into a rejected promise.<br>Promise.all(promises)    Returns a new promise which is fulfilled with an array of fulfillment values for the passed promises or rejects with the reason of the first promise that rejects.<br>Promise.race(promises)    Returns a new promise which is fulfilled/rejected with the result/error of the first settled promise from the array of passed promises.<br>Promise.all is especially useful when there is a need to run tasks in parallel. Promise.race makes it easier to implement things like timeouts for promises.</p>
<p>Promises支持一些帮助程序方法，这些方法有助于使代码更精确：<br>模式描述</p>
<p>承诺。解决（价值）将价值转换为已解决的承诺。</p>
<p>承诺。拒绝（错误）将错误转换为拒绝的承诺。</p>
<p>承诺。all（promises）返回一个新的承诺，该承诺通过一系列实现值来实现已传递的承诺，或者以拒绝的第一个承诺的原因拒绝。</p>
<p>Promise.race（promises）返回一个新的Promise，该Promise被实现/拒绝，结果/错误来自传递的promises数组中的第一个已确定的Promise。</p>
<p>Promise.all在需要并行运行任务时特别有用。Promise.race使实现承诺超时之类的事情变得更容易。</p>
<h4 id="Async-Await-比-Promise-更干净"><a href="#Async-Await-比-Promise-更干净" class="headerlink" title="Async/Await 比 Promise 更干净"></a>Async/Await 比 Promise 更干净</h4><p>使用async/await语法，您可以编写比链式承诺更干净、更易于理解的代码。在以async关键字为前缀的函数中，可以告诉JavaScript运行时暂停wait关键字上的代码执行（当用于promise时）。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"><span class="keyword">import</span> &#123; get &#125; <span class="keyword">from</span> <span class="string">&#x27;request&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; writeFile &#125; <span class="keyword">from</span> <span class="string">&#x27;fs&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; promisify &#125; <span class="keyword">from</span> <span class="string">&#x27;util&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> write = util.<span class="title function_">promisify</span>(writeFile);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">downloadPage</span>(<span class="params">url: <span class="built_in">string</span>, saveTo: <span class="built_in">string</span></span>): <span class="title class_">Promise</span>&lt;<span class="built_in">string</span>&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">get</span>(url).<span class="title function_">then</span>(<span class="function"><span class="params">response</span> =&gt;</span> <span class="title function_">write</span>(saveTo, response));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">downloadPage</span>(<span class="string">&#x27;https://en.wikipedia.org/wiki/Robert_Cecil_Martin&#x27;</span>, <span class="string">&#x27;article.html&#x27;</span>)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function"><span class="params">content</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(content))</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="function"><span class="params">error</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">error</span>(error));  </span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"><span class="keyword">import</span> &#123; get &#125; <span class="keyword">from</span> <span class="string">&#x27;request&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; writeFile &#125; <span class="keyword">from</span> <span class="string">&#x27;fs&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; promisify &#125; <span class="keyword">from</span> <span class="string">&#x27;util&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> write = <span class="title function_">promisify</span>(writeFile);</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">downloadPage</span>(<span class="params">url: <span class="built_in">string</span>, saveTo: <span class="built_in">string</span></span>): <span class="title class_">Promise</span>&lt;<span class="built_in">string</span>&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="title function_">get</span>(url);</span><br><span class="line">  <span class="keyword">await</span> <span class="title function_">write</span>(saveTo, response);</span><br><span class="line">  <span class="keyword">return</span> response;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// somewhere in an async function</span></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> content = <span class="keyword">await</span> <span class="title function_">downloadPage</span>(<span class="string">&#x27;https://en.wikipedia.org/wiki/Robert_Cecil_Martin&#x27;</span>, <span class="string">&#x27;article.html&#x27;</span>);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(content);</span><br><span class="line">&#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">error</span>(error);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="错误处理"><a href="#错误处理" class="headerlink" title="错误处理"></a>错误处理</h3><p>抛出错误是件好事！它们意味着运行时已经成功地识别出程序中的某些错误，并通过停止当前堆栈上的函数执行、终止进程（在节点中）和在控制台中用堆栈跟踪通知您来通知您。</p>
<h4 id="总是使用错误来抛出或拒绝"><a href="#总是使用错误来抛出或拒绝" class="headerlink" title="总是使用错误来抛出或拒绝"></a>总是使用错误来抛出或拒绝</h4><p>JavaScript和TypeScript允许抛出任何对象。承诺也可以以任何理由拒绝。<br>建议对错误类型使用throw语法。这是因为用catch语法可能会在更高级别的代码中捕获错误。在那里捕捉字符串消息会非常混乱，并且会使调试更加痛苦。<br>出于同样的原因，您应该拒绝带有错误类型的承诺。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">calculateTotal</span>(<span class="params">items: Item[]</span>): <span class="built_in">number</span> &#123;</span><br><span class="line">  <span class="keyword">throw</span> <span class="string">&#x27;Not implemented.&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">get</span>(<span class="params"></span>): <span class="title class_">Promise</span>&lt;<span class="title class_">Item</span>[]&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(<span class="string">&#x27;Not implemented.&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">calculateTotal</span>(<span class="params">items: Item[]</span>): <span class="built_in">number</span> &#123;</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;Not implemented.&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">get</span>(<span class="params"></span>): <span class="title class_">Promise</span>&lt;<span class="title class_">Item</span>[]&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;Not implemented.&#x27;</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// or equivalent to:</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">get</span>(<span class="params"></span>): <span class="title class_">Promise</span>&lt;<span class="title class_">Item</span>[]&gt; &#123;</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;Not implemented.&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>使用错误类型的好处是它受语法try/catch/finally支持，并且隐式地说，所有错误都具有堆栈属性，这对于调试来说非常强大。<br>还有另一种选择，不使用throw语法，而是始终返回自定义错误对象。TypeScript使这更容易。考虑以下示例：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">Result</span>&lt;R&gt; = &#123; <span class="attr">isError</span>: <span class="literal">false</span>, <span class="attr">value</span>: R &#125;;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Failure</span>&lt;E&gt; = &#123; <span class="attr">isError</span>: <span class="literal">true</span>, <span class="attr">error</span>: E &#125;;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Failable</span>&lt;R, E&gt; = <span class="title class_">Result</span>&lt;R&gt; | <span class="title class_">Failure</span>&lt;E&gt;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">calculateTotal</span>(<span class="params">items: Item[]</span>): <span class="title class_">Failable</span>&lt;<span class="built_in">number</span>, <span class="string">&#x27;empty&#x27;</span>&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (items.<span class="property">length</span> === <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123; <span class="attr">isError</span>: <span class="literal">true</span>, <span class="attr">error</span>: <span class="string">&#x27;empty&#x27;</span> &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="keyword">return</span> &#123; <span class="attr">isError</span>: <span class="literal">false</span>, <span class="attr">value</span>: <span class="number">42</span> &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="不要忽略捕获的错误"><a href="#不要忽略捕获的错误" class="headerlink" title="不要忽略捕获的错误"></a>不要忽略捕获的错误</h4><p>对捕获到的错误不做任何事情都不会给您修复或响应所述错误的能力。将错误记录到控制台（console.log）并没有比它在打印到控制台的大量内容中丢失更好。如果您在try/catch中包装任何一位代码，这意味着您认为可能会在那里发生错误，因此您应该有一个计划，或创建一个代码路径，以便在发生错误时使用。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="title function_">functionThatMightThrow</span>();</span><br><span class="line">&#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// or even worse</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="title function_">functionThatMightThrow</span>();</span><br><span class="line">&#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">  <span class="comment">// ignore error</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"><span class="keyword">import</span> &#123; logger &#125; <span class="keyword">from</span> <span class="string">&#x27;./logging&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="title function_">functionThatMightThrow</span>();</span><br><span class="line">&#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">  logger.<span class="title function_">log</span>(error);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="不要忽视被拒绝的承诺"><a href="#不要忽视被拒绝的承诺" class="headerlink" title="不要忽视被拒绝的承诺"></a>不要忽视被拒绝的承诺</h4><p>出于同样的原因，您不应该忽略try/catch中捕获的错误。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"><span class="title function_">getUser</span>()</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">user: User</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">sendEmail</span>(user.<span class="property">email</span>, <span class="string">&#x27;Welcome!&#x27;</span>);</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"><span class="keyword">import</span> &#123; logger &#125; <span class="keyword">from</span> <span class="string">&#x27;./logging&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">getUser</span>()</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">user: User</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">sendEmail</span>(user.<span class="property">email</span>, <span class="string">&#x27;Welcome!&#x27;</span>);</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">    logger.<span class="title function_">log</span>(error);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// or using the async/await syntax:</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> user = <span class="keyword">await</span> <span class="title function_">getUser</span>();</span><br><span class="line">  <span class="keyword">await</span> <span class="title function_">sendEmail</span>(user.<span class="property">email</span>, <span class="string">&#x27;Welcome!&#x27;</span>);</span><br><span class="line">&#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">  logger.<span class="title function_">log</span>(error);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="格式化"><a href="#格式化" class="headerlink" title="格式化"></a>格式化</h3><p>格式化是主观的。就像这里的许多规则一样，没有什么硬性规定是你必须遵守的。重点是不要在格式上争论。有很多工具可以自动完成这项工作。使用一个！对于工程师来说，就格式问题争论是浪费时间和金钱。要遵循的一般规则是保持格式规则的一致性。</p>
<p>对于TypeScript，有一个强大的工具TSLint。它是一个静态分析工具，可以帮助您显著提高代码的可读性和可维护性。您可以在项目中引用准备好使用的TSLint配置：</p>
<ul>
<li>TSLint Config Standard-标准样式规则</li>
<li>TSLint配置Airbnb-Airbnb风格指南</li>
<li>TSLint干净代码-TSLint规则灵感来自干净代码：敏捷软件工艺手册</li>
<li>TSLint react-与react和JSX相关的lint规则</li>
<li>TSLint+Prettier-Prettier代码格式化程序的lint规则</li>
<li>TSLint的ESLint规则-TypeScript的ESLint规则</li>
<li>不可变-在TypeScript中禁用变异的规则</li>
<li>另请参阅这个伟大的TypeScript样式指南和编码约定源代码。</li>
</ul>
<h4 id="使用一致的大写"><a href="#使用一致的大写" class="headerlink" title="使用一致的大写"></a>使用一致的大写</h4><p>大写告诉你很多关于你的变量，函数等。这些规则是主观的，所以你的团队可以选择他们想要的。关键是，无论你们选择什么，只要保持一致。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">DAYS_IN_WEEK</span> = <span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> daysInMonth = <span class="number">30</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> songs = [<span class="string">&#x27;Back In Black&#x27;</span>, <span class="string">&#x27;Stairway to Heaven&#x27;</span>, <span class="string">&#x27;Hey Jude&#x27;</span>];</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Artists</span> = [<span class="string">&#x27;ACDC&#x27;</span>, <span class="string">&#x27;Led Zeppelin&#x27;</span>, <span class="string">&#x27;The Beatles&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">eraseDatabase</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">restore_database</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> animal = &#123; <span class="comment">/* ... */</span> &#125;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Container</span> = &#123; <span class="comment">/* ... */</span> &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">DAYS_IN_WEEK</span> = <span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">DAYS_IN_MONTH</span> = <span class="number">30</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">SONGS</span> = [<span class="string">&#x27;Back In Black&#x27;</span>, <span class="string">&#x27;Stairway to Heaven&#x27;</span>, <span class="string">&#x27;Hey Jude&#x27;</span>];</span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">ARTISTS</span> = [<span class="string">&#x27;ACDC&#x27;</span>, <span class="string">&#x27;Led Zeppelin&#x27;</span>, <span class="string">&#x27;The Beatles&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">eraseDatabase</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">restoreDatabase</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Animal</span> = &#123; <span class="comment">/* ... */</span> &#125;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Container</span> = &#123; <span class="comment">/* ... */</span> &#125;</span><br></pre></td></tr></table></figure>

<p>更喜欢对类、接口、类型和命名空间名称使用PascalCase。<br>更喜欢对变量、函数和类成员使用camelCase。</p>
<h4 id="函数调用方和被调用方应关闭"><a href="#函数调用方和被调用方应关闭" class="headerlink" title="函数调用方和被调用方应关闭"></a>函数调用方和被调用方应关闭</h4><p>如果一个函数调用另一个函数，请在源文件中垂直关闭这些函数。理想情况下，让呼叫者位于被呼叫者的正上方。我们倾向于自上而下阅读代码，就像报纸一样。因此，让您的代码以这种方式读取。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">PerformanceReview</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"><span class="keyword">private</span> <span class="keyword">readonly</span> employee: Employee</span>) &#123;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="title function_">lookupPeers</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> db.<span class="title function_">lookup</span>(<span class="variable language_">this</span>.<span class="property">employee</span>.<span class="property">id</span>, <span class="string">&#x27;peers&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="title function_">lookupManager</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> db.<span class="title function_">lookup</span>(<span class="variable language_">this</span>.<span class="property">employee</span>, <span class="string">&#x27;manager&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="title function_">getPeerReviews</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> peers = <span class="variable language_">this</span>.<span class="title function_">lookupPeers</span>();</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">review</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">getPeerReviews</span>();</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">getManagerReview</span>();</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">getSelfReview</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="title function_">getManagerReview</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> manager = <span class="variable language_">this</span>.<span class="title function_">lookupManager</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="title function_">getSelfReview</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> review = <span class="keyword">new</span> <span class="title class_">PerformanceReview</span>(employee);</span><br><span class="line">review.<span class="title function_">review</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">PerformanceReview</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"><span class="keyword">private</span> <span class="keyword">readonly</span> employee: Employee</span>) &#123;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">review</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">getPeerReviews</span>();</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">getManagerReview</span>();</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">getSelfReview</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="title function_">getPeerReviews</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> peers = <span class="variable language_">this</span>.<span class="title function_">lookupPeers</span>();</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="title function_">lookupPeers</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> db.<span class="title function_">lookup</span>(<span class="variable language_">this</span>.<span class="property">employee</span>.<span class="property">id</span>, <span class="string">&#x27;peers&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="title function_">getManagerReview</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> manager = <span class="variable language_">this</span>.<span class="title function_">lookupManager</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="title function_">lookupManager</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> db.<span class="title function_">lookup</span>(<span class="variable language_">this</span>.<span class="property">employee</span>, <span class="string">&#x27;manager&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="title function_">getSelfReview</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> review = <span class="keyword">new</span> <span class="title class_">PerformanceReview</span>(employee);</span><br><span class="line">review.<span class="title function_">review</span>();</span><br></pre></td></tr></table></figure>

<h4 id="组织导入"><a href="#组织导入" class="headerlink" title="组织导入"></a>组织导入</h4><p>使用干净且易于阅读的导入语句，您可以快速查看当前代码的依赖项。请确保对导入语句应用以下良好做法：</p>
<ul>
<li>导入语句应按字母顺序排列和分组。</li>
<li>应删除未使用的导入。</li>
<li>命名导入必须按字母顺序排列（即从’foo’导入{A，B，C}；）</li>
<li>导入源必须在组内按字母顺序排列，即：Import<em>as foo from’a’；Import</em>as bar from’b’；</li>
<li>导入组由空行划定。</li>
<li>集团必须遵守以下顺序：<ul>
<li><ul>
<li>polyfill（即导入“reflect metadata”；）</li>
</ul>
</li>
<li><ul>
<li>节点内置模块（即从’fs’导入fs；）</li>
</ul>
</li>
<li><ul>
<li>外部模块（即从“itiriri”导入{query}；）</li>
</ul>
</li>
<li><ul>
<li>内部模块（即从’src/services/UserService’导入{UserService}；）</li>
</ul>
</li>
<li><ul>
<li>来自父目录的模块（即从’../foo’导入foo；从’../../foo/qx’导入qux；）</li>
</ul>
</li>
<li><ul>
<li>来自同一个或同级目录的模块（即从“./bar”导入bar；从“./bar/baz”导入baz）</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">TypeDefinition</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;../types/typeDefinition&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">AttributeTypes</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;../model/attribute&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">ApiCredentials</span>, <span class="title class_">Adapters</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./common/api/authorization&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> fs <span class="keyword">from</span> <span class="string">&#x27;fs&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">ConfigPlugin</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./plugins/config/configPlugin&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">BindingScopeEnum</span>, <span class="title class_">Container</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;inversify&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;reflect-metadata&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;reflect-metadata&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> fs <span class="keyword">from</span> <span class="string">&#x27;fs&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">BindingScopeEnum</span>, <span class="title class_">Container</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;inversify&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">AttributeTypes</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;../model/attribute&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">TypeDefinition</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;../types/typeDefinition&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">ApiCredentials</span>, <span class="title class_">Adapters</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./common/api/authorization&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">ConfigPlugin</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./plugins/config/configPlugin&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h4 id="使用类型脚本别名"><a href="#使用类型脚本别名" class="headerlink" title="使用类型脚本别名"></a>使用类型脚本别名</h4><p>通过在tsconfig.json的compileoptions部分中定义路径和baseUrl属性创建更漂亮的导入<br>这将避免在进行导入时使用长的相对路径。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">UserService</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;../../../services/UserService&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">UserService</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@services/UserService&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// tsconfig.json</span></span><br><span class="line">...</span><br><span class="line">  <span class="string">&quot;compilerOptions&quot;</span>: &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="string">&quot;baseUrl&quot;</span>: <span class="string">&quot;src&quot;</span>,</span><br><span class="line">    <span class="string">&quot;paths&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;@services&quot;</span>: [<span class="string">&quot;services/*&quot;</span>]</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">  &#125;</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<h3 id="评论"><a href="#评论" class="headerlink" title="评论"></a>评论</h3><p>使用评论意味着没有评论就无法表达。代码应该是真相的唯一来源。<br>不要评论坏代码重写它。<br>-布莱恩·W·克尼根和P·J·普劳格</p>
<h4 id="更喜欢自解释的代码而不是注释"><a href="#更喜欢自解释的代码而不是注释" class="headerlink" title="更喜欢自解释的代码而不是注释"></a>更喜欢自解释的代码而不是注释</h4><p>评论是道歉，不是要求。好的代码大多是文档本身。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"><span class="comment">// Check if subscription is active.</span></span><br><span class="line"><span class="keyword">if</span> (subscription.<span class="property">endDate</span> &gt; <span class="title class_">Date</span>.<span class="property">now</span>) &#123;  &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"><span class="keyword">const</span> isSubscriptionActive = subscription.<span class="property">endDate</span> &gt; <span class="title class_">Date</span>.<span class="property">now</span>;</span><br><span class="line"><span class="keyword">if</span> (isSubscriptionActive) &#123; <span class="comment">/* ... */</span> &#125;</span><br></pre></td></tr></table></figure>

<h4 id="不要在代码库中遗漏注释掉的代码"><a href="#不要在代码库中遗漏注释掉的代码" class="headerlink" title="不要在代码库中遗漏注释掉的代码"></a>不要在代码库中遗漏注释掉的代码</h4><p>版本控制存在是有原因的。在你的历史中留下旧代码。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">User</span> = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">email</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="comment">// age: number;</span></span><br><span class="line">  <span class="comment">// jobPosition: string;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">User</span> = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">email</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="没有日志评论"><a href="#没有日志评论" class="headerlink" title="没有日志评论"></a>没有日志评论</h4><p>记住，使用版本控制！不需要死代码、注释代码，尤其是日志注释。使用git日志获取历史记录！</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 2016-12-20: Removed monads, didn&#x27;t understand them (RM)</span></span><br><span class="line"><span class="comment"> * 2016-10-01: Improved using special monads (JP)</span></span><br><span class="line"><span class="comment"> * 2016-02-03: Added type-checking (LI)</span></span><br><span class="line"><span class="comment"> * 2015-03-14: Implemented combine (JR)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">combine</span>(<span class="params">a: <span class="built_in">number</span>, b: <span class="built_in">number</span></span>): <span class="built_in">number</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">combine</span>(<span class="params">a: <span class="built_in">number</span>, b: <span class="built_in">number</span></span>): <span class="built_in">number</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="避免位置标记"><a href="#避免位置标记" class="headerlink" title="避免位置标记"></a>避免位置标记</h4><p>它们通常只是增加噪音。让函数和变量名以及适当的缩进和格式为代码提供可视化结构。<br>大多数IDE支持代码折叠功能，允许您折叠/扩展代码块（请参见Visual Studio代码折叠区域）。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">// Client class</span></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">address</span>: <span class="title class_">Address</span>;</span><br><span class="line">  <span class="attr">contact</span>: <span class="title class_">Contact</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line">  <span class="comment">// public methods</span></span><br><span class="line">  <span class="comment">////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line">  <span class="keyword">public</span> <span class="title function_">describe</span>(): <span class="built_in">string</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line">  <span class="comment">// private methods</span></span><br><span class="line">  <span class="comment">////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line">  <span class="keyword">private</span> <span class="title function_">describeAddress</span>(): <span class="built_in">string</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="title function_">describeContact</span>(): <span class="built_in">string</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">address</span>: <span class="title class_">Address</span>;</span><br><span class="line">  <span class="attr">contact</span>: <span class="title class_">Contact</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="title function_">describe</span>(): <span class="built_in">string</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="title function_">describeAddress</span>(): <span class="built_in">string</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="title function_">describeContact</span>(): <span class="built_in">string</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h4 id="待办事项注释"><a href="#待办事项注释" class="headerlink" title="待办事项注释"></a>待办事项注释</h4><p>当您发现需要在代码中留下注释以便以后进行一些改进时，可以使用//to do注释来完成。大多数IDE对这些注释都有特殊的支持，因此您可以快速浏览todo的整个列表。<br>不过，请记住，TODO注释不是错误代码的借口。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getActiveSubscriptions</span>(<span class="params"></span>): <span class="title class_">Promise</span>&lt;<span class="title class_">Subscription</span>[]&gt; &#123;</span><br><span class="line">  <span class="comment">// ensure `dueDate` is indexed.</span></span><br><span class="line">  <span class="keyword">return</span> db.<span class="property">subscriptions</span>.<span class="title function_">find</span>(&#123; <span class="attr">dueDate</span>: &#123; <span class="attr">$lte</span>: <span class="keyword">new</span> <span class="title class_">Date</span>() &#125; &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getActiveSubscriptions</span>(<span class="params"></span>): <span class="title class_">Promise</span>&lt;<span class="title class_">Subscription</span>[]&gt; &#123;</span><br><span class="line">  <span class="comment">// <span class="doctag">TODO:</span> ensure `dueDate` is indexed.</span></span><br><span class="line">  <span class="keyword">return</span> db.<span class="property">subscriptions</span>.<span class="title function_">find</span>(&#123; <span class="attr">dueDate</span>: &#123; <span class="attr">$lte</span>: <span class="keyword">new</span> <span class="title class_">Date</span>() &#125; &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bad</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/02/23/WSL/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kil">
      <meta itemprop="description" content="心如止水，潜心修行">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Kil Notes">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/02/23/WSL/" class="post-title-link" itemprop="url">WSL</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-02-23 22:26:23" itemprop="dateCreated datePublished" datetime="2020-02-23T22:26:23+08:00">2020-02-23</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Tool/" itemprop="url" rel="index"><span itemprop="name">Tool</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h2><img src="/2020/02/23/WSL/seven_pc.png" class="">

<h2 id="安装失败"><a href="#安装失败" class="headerlink" title="安装失败"></a>安装失败</h2><p>设置子系统失败</p>
<img src="/2020/02/23/WSL/wsl_error1.png" class="">


<p>也没有商店</p>
<img src="/2020/02/23/WSL/wsl_win_old.png" class="">
<p>猜测windows企业版本问题, 重装专业版</p>
<h2 id="安装成功"><a href="#安装成功" class="headerlink" title="安装成功"></a>安装成功</h2><h3 id="开启子系统"><a href="#开启子系统" class="headerlink" title="开启子系统"></a>开启子系统</h3><p>Windows设置主页 搜索：启用或关闭Windows功能<br>勾选</p>
<ul>
<li><input checked="" disabled="" type="checkbox"> 适用于 Linux 的 Windows 子系统</li>
</ul>
<h3 id="设置开发者权限"><a href="#设置开发者权限" class="headerlink" title="设置开发者权限"></a>设置开发者权限</h3><p>Windows设置主页 搜索：开发者选项<br>勾选</p>
<ul>
<li><input checked="" disabled="" type="checkbox"> 开发人员模式</li>
</ul>
<h3 id="商店下载"><a href="#商店下载" class="headerlink" title="商店下载"></a>商店下载</h3><p>商店搜索：ubuntu<br>安装第一个</p>
<h3 id="vscode"><a href="#vscode" class="headerlink" title="vscode"></a>vscode</h3><p>安装插件：Remote - WSL</p>
<h4 id="vscode-error"><a href="#vscode-error" class="headerlink" title="vscode error"></a>vscode error</h4><p>vscode server for wsl closed unexpectedly<br>wsl –shutdown<br>wsl</p>
<p>sh: 1: /c/Users/Administrator/.vscode/extensions/ms-vscode-remote.remote-wsl-0.58.2/scripts/wslServer.sh: Permission denied</p>
<p>cd /c/Users/Administrator/.vscode/extensions/ms-vscode-remote.remote-wsl-0.58.2/scripts<br>chmod +x *</p>
<h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><h3 id="node环境变量配置-（安装的包-无法使用）"><a href="#node环境变量配置-（安装的包-无法使用）" class="headerlink" title="node环境变量配置 （安装的包 无法使用）"></a>node环境变量配置 （安装的包 无法使用）</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ tsc</span><br><span class="line">zsh: command not found: tsc</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ sudo vi ~/.zshrc</span><br><span class="line">// 添加</span><br><span class="line">export NODE_HOME=/home/kil/.npm-global</span><br><span class="line">export PATH=$NODE_HOME/bin:$PATH</span><br><span class="line">$ source ~/.zshrc</span><br><span class="line">$ tsc -v</span><br><span class="line">Version 3.8.2</span><br></pre></td></tr></table></figure>

<p>seven:<br>那你要把home目录的 node_module 加到path里<br>node_module 里应该有个bin目录<br>把那个目录加到你path里<br>你看看global的模块目录在哪<br>You can run npm list -g to see which global libraries are installed and where they’re located.<br>那你应该在 .zshrc里export<br><a target="_blank" rel="noopener" href="https://askubuntu.com/questions/476246/when-i-use-zsh-how-do-i-set-path-in-etc-profile-d">When I use ZSH, how do I set PATH in /etc/profile.d?</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/02/23/Git/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kil">
      <meta itemprop="description" content="心如止水，潜心修行">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Kil Notes">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/02/23/Git/" class="post-title-link" itemprop="url">Git</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-02-23 19:07:58" itemprop="dateCreated datePublished" datetime="2020-02-23T19:07:58+08:00">2020-02-23</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Git/" itemprop="url" rel="index"><span itemprop="name">Git</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="基础"><a href="#基础" class="headerlink" title="基础"></a>基础</h1><img src="/2020/02/23/Git/git1.png" class="">

<p>How to change the URI (URL) for a remote Git repository?<br>git remote set-url origin new.git.url/here</p>
<p>yarn add <a target="_blank" rel="noopener" href="https://github.com/fancyapps/fancybox">https://github.com/fancyapps/fancybox</a> [remote url]<br>yarn add ssh://github.com/fancyapps/fancybox#3.0  [branch]<br>yarn add <a target="_blank" rel="noopener" href="https://github.com/fancyapps/fancybox#5cda5b529ce3fb6c167a55d42ee5a316e921d95f">https://github.com/fancyapps/fancybox#5cda5b529ce3fb6c167a55d42ee5a316e921d95f</a> [commit]</p>
<h2 id="ubuntu-安装最新版本"><a href="#ubuntu-安装最新版本" class="headerlink" title="ubuntu 安装最新版本"></a>ubuntu 安装最新版本</h2><p><a target="_blank" rel="noopener" href="https://github.com/git/git/releases">gitVersion</a><br>因为 Ubuntu 自带的源中，Git 版本就是这么低，所以需要加入一个源，带有最新 Git 版本的源</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo add-apt-repository ppa:git-core/ppa</span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install git</span><br></pre></td></tr></table></figure>

<h2 id="merge"><a href="#merge" class="headerlink" title="merge"></a>merge</h2><p>cms垒哥没有merge 到 dev<br>seven：merge 本地；本地dev 分支需要拉一下</p>
<h2 id="查看文件修改内容"><a href="#查看文件修改内容" class="headerlink" title="查看文件修改内容"></a>查看文件修改内容</h2><p>git diff test.text</p>
<h1 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h1><h3 id="ssh-密钥"><a href="#ssh-密钥" class="headerlink" title="ssh 密钥"></a>ssh 密钥</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen</span><br></pre></td></tr></table></figure>

<h3 id="github-com代理"><a href="#github-com代理" class="headerlink" title="github.com代理"></a>github.com代理</h3><p>选择 “编辑PAC用户自定规则” 会打开一个简单编辑器。<br>在其中添加自定义的PAC规则，每行一条，规则格式参考 <a target="_blank" rel="noopener" href="https://adblockplus.org/en/filter-cheatsheet">https://adblockplus.org/en/filter-cheatsheet</a></p>
<p>简单来说 ||a.com 这条规则即可匹配 a.com/xxx x.a.com/xxx xx.x.a.com/xxx 这些url</p>
<h3 id="全局配置"><a href="#全局配置" class="headerlink" title="全局配置"></a>全局配置</h3><p>用户名</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git config --global user.name <span class="string">&quot;name&quot;</span></span><br></pre></td></tr></table></figure>

<p>邮箱</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git config --global user.email <span class="string">&quot;email@gmail.com&quot;</span></span><br></pre></td></tr></table></figure>

<p>验证连接</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh -T git@github.com</span><br><span class="line">Hi KilFront! You&#x27;ve successfully authenticated, but GitHub does not provide shell access.</span><br></pre></td></tr></table></figure>

<h3 id="单项目配置"><a href="#单项目配置" class="headerlink" title="单项目配置"></a>单项目配置</h3><p>git为不同的项目设置不同的用户名</p>
<p>每个git项目下都会有一个隐藏的.git文件夹</p>
<p>两种方式<br>open config 命令打开，添加如下配置：<br>[user]<br>    name = XXX(自己的名称英文)<br>    email = XXXX(邮箱)</p>
<p>命令：<br>git  config  user.name  “xxxxx”</p>
<h3 id="代理"><a href="#代理" class="headerlink" title="代理"></a>代理</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#只对github.com</span></span><br><span class="line">git config --global http.https://github.com.proxy socks5://127.0.0.1:1080</span><br><span class="line"></span><br><span class="line"><span class="comment">#取消代理</span></span><br><span class="line">git config --global --<span class="built_in">unset</span> http.https://github.com.proxy)</span><br></pre></td></tr></table></figure>

<h4 id="仅为-GitHub-设置代理"><a href="#仅为-GitHub-设置代理" class="headerlink" title="仅为 GitHub 设置代理"></a>仅为 GitHub 设置代理</h4><p>git 代理<br>设置 git config –global http.<a target="_blank" rel="noopener" href="https://github.com.proxy/">https://github.com.proxy</a> socks5://127.0.0.1:1086<br>设置完成后, ~/.gitconfig 文件中会增加以下条目:</p>
<p>[http “<a href="https://github.com&quot;]">https://github.com&quot;]</a><br>    proxy = socks5://127.0.0.1:1086</p>
<p>ssh 代理<br>修改 ~/.ssh/config 文件</p>
<p>Host github.com<br>    User git<br>    ProxyCommand nc -v -x 127.0.0.1:1086 %h %p</p>
<h2 id="token"><a href="#token" class="headerlink" title="token"></a>token</h2><p>gitlab import github   授权</p>
<img src="/2020/02/23/Git/register.png" class="">

<h1 id="指令"><a href="#指令" class="headerlink" title="指令"></a>指令</h1><p>git配置<br>git config –list</p>
<h2 id="提交"><a href="#提交" class="headerlink" title="提交"></a>提交</h2><p>git commit -am “some str”<br>git push</p>
<p>git commit -am ‘str’命令只能提交已经追踪过且修改了的文件，新增文件就必须使用git add . &amp;&amp; git commit -m 命令；</p>
<h2 id="版本回滚"><a href="#版本回滚" class="headerlink" title="版本回滚"></a>版本回滚</h2><h3 id="revert"><a href="#revert" class="headerlink" title="revert"></a>revert</h3><p>git revert HEAD^</p>
<h3 id="reset"><a href="#reset" class="headerlink" title="reset"></a>reset</h3><p>注意：回滚前先checkout 一个分支进行保留</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git reset --hard ff19b5644e7470728d5a10f57f244f9754fb4d58</span><br><span class="line">git add .</span><br><span class="line">git commit -m update</span><br><span class="line">git push origin dev -f</span><br></pre></td></tr></table></figure>

<p>-f : force 暴力</p>
<p>Pushing to <a href="mailto:&#103;&#105;&#116;&#x40;&#103;&#x69;&#116;&#104;&#x75;&#98;&#x2e;&#x63;&#x6f;&#109;">&#103;&#105;&#116;&#x40;&#103;&#x69;&#116;&#104;&#x75;&#98;&#x2e;&#x63;&#x6f;&#109;</a>:519ebayproject/519ebayproject.git<br>To <a href="mailto:&#x67;&#105;&#116;&#x40;&#x67;&#105;&#x74;&#x68;&#x75;&#x62;&#x2e;&#99;&#x6f;&#109;">&#x67;&#105;&#116;&#x40;&#x67;&#105;&#x74;&#x68;&#x75;&#x62;&#x2e;&#99;&#x6f;&#109;</a>:519ebayproject/519ebayproject.git<br> ! [rejected]        master -&gt; master (non-fast-forward)<br>error: failed to push some refs to ‘<a href="mailto:&#103;&#x69;&#116;&#x40;&#103;&#x69;&#116;&#104;&#x75;&#98;&#46;&#x63;&#x6f;&#x6d;">&#103;&#x69;&#116;&#x40;&#103;&#x69;&#116;&#104;&#x75;&#98;&#46;&#x63;&#x6f;&#x6d;</a>:519ebayproject/519ebayproject.git’<br>hint: Updates were rejected because the tip of your current branch is behind<br>hint: its remote counterpart. Merge the remote changes (e.g. ‘git pull’)<br>hint: before pushing again.<br>hint: See the ‘Note about fast-forwards’ in ‘git push –help’ for details.<br>我遇到造成这个问题的原因，一般是因为执行了git reset命令，版本回退后没有恢复，造成本地仓库的提交版本号落后于远端仓库的提交版本号。<br>可以执行 git push -f命令去强制提交</p>
<hr>
<p>git fetch –all<br>git reset –hard origin/master<br>git pull //可以省略</p>
<h3 id="回滚之后的操作"><a href="#回滚之后的操作" class="headerlink" title="回滚之后的操作"></a>回滚之后的操作</h3><p>git log  找到想退回的版本</p>
<h3 id="未暂存文件"><a href="#未暂存文件" class="headerlink" title="未暂存文件"></a>未暂存文件</h3><p>git reset 3e5236a</p>
<h3 id="暂存文件"><a href="#暂存文件" class="headerlink" title="暂存文件"></a>暂存文件</h3><p>git reset –hard 3e5236a</p>
<h2 id="历史提交记录"><a href="#历史提交记录" class="headerlink" title="历史提交记录"></a>历史提交记录</h2><p>git log</p>
<h2 id="重置origin"><a href="#重置origin" class="headerlink" title="重置origin"></a>重置origin</h2><p>git remote set-url origin <a href="mailto:&#103;&#x69;&#116;&#64;&#103;&#x69;&#116;&#104;&#x75;&#x62;&#46;&#99;&#111;&#x6d;">&#103;&#x69;&#116;&#64;&#103;&#x69;&#116;&#104;&#x75;&#x62;&#46;&#99;&#111;&#x6d;</a>:ApowoGames/cordova-plugin-keyboard.git</p>
<h2 id="删除远程已提交的文件"><a href="#删除远程已提交的文件" class="headerlink" title="删除远程已提交的文件"></a>删除远程已提交的文件</h2><p><a target="_blank" rel="noopener" href="https://www.liaoxuefeng.com/wiki/896043488029600/900002180232448">https://www.liaoxuefeng.com/wiki/896043488029600/900002180232448</a><br>首先删除本地 文件<br>git status<br>deleted:    test.txt</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ git rm test.txt</span><br><span class="line">rm &#x27;test.txt&#x27;</span><br><span class="line"></span><br><span class="line">$ git commit -m &quot;remove test.txt&quot;</span><br><span class="line">[master d46f35e] remove test.txt</span><br><span class="line"> 1 file changed, 1 deletion(-)</span><br><span class="line"> delete mode 100644 test.txt</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 从上往下，这步可省略</span><br><span class="line">git rm -r --cached 文件/文件夹名称</span><br><span class="line"># 修改本地 .gitignore</span><br><span class="line">git add .</span><br><span class="line">git commit -m &#x27;&#x27;</span><br><span class="line">git push origin master</span><br></pre></td></tr></table></figure>

<p>git rm -r –cached xxx.iml　　//-r 是递归的意思   当最后面是文件夹的时候有用</p>
<h2 id="放弃修改"><a href="#放弃修改" class="headerlink" title="放弃修改"></a>放弃修改</h2><h3 id="文件修改"><a href="#文件修改" class="headerlink" title="文件修改"></a>文件修改</h3><p>单个文件/文件夹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git checkout -- filename</span><br></pre></td></tr></table></figure>

<p>所有文件/文件夹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git checkout .</span><br></pre></td></tr></table></figure>

<h3 id="新增文件"><a href="#新增文件" class="headerlink" title="新增文件"></a>新增文件</h3><p>单个文件/文件夹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ rm filename / rm dir -rf</span><br></pre></td></tr></table></figure>

<p>所有文件/文件夹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git clean -xdf</span><br></pre></td></tr></table></figure>

<h3 id="本地修改-新增了一堆文件，已经git-add到暂存区，想放弃修改。"><a href="#本地修改-新增了一堆文件，已经git-add到暂存区，想放弃修改。" class="headerlink" title="本地修改/新增了一堆文件，已经git add到暂存区，想放弃修改。"></a>本地修改/新增了一堆文件，已经git add到暂存区，想放弃修改。</h3><p>单个文件/文件夹：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git reset HEAD filename</span><br></pre></td></tr></table></figure>

<p>所有文件/文件夹：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git reset HEAD .</span><br></pre></td></tr></table></figure>

<h3 id="本地通过git-add-amp-git-commit-之后，想要撤销此次commit"><a href="#本地通过git-add-amp-git-commit-之后，想要撤销此次commit" class="headerlink" title="本地通过git add &amp; git commit 之后，想要撤销此次commit"></a>本地通过git add &amp; git commit 之后，想要撤销此次commit</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git reset commit_id</span><br></pre></td></tr></table></figure>

<h2 id="暂存"><a href="#暂存" class="headerlink" title="暂存"></a>暂存</h2><p>我们有时会遇到这样的情况，正在dev分支开发新功能，做到一半时有人过来反馈一个bug，让马上解决，但是新功能做到了一半你又不想提交，这时就可以使用<code>git stash</code>命令先把当前进度保存起来，然后切换到另一个分支去修改bug，修改完提交后，再切回dev分支，使用<code>git stash pop</code>来恢复之前的进度继续开发新功能。</p>
<h2 id="清除已删除的分支"><a href="#清除已删除的分支" class="headerlink" title="清除已删除的分支"></a>清除已删除的分支</h2><h3 id="git-branch-a"><a href="#git-branch-a" class="headerlink" title="git branch -a"></a>git branch -a</h3><p>命令可以查看所有本地分支和远程分支（git branch -r 可以只查看远程分支）<br>发现很多在远程仓库已经删除的分支在本地依然可以看到。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">git branch -a</span><br><span class="line">  alpha</span><br><span class="line">* dev</span><br><span class="line">feature_ng</span><br><span class="line">  feature_pretty</span><br><span class="line">  master</span><br><span class="line">  test_top</span><br><span class="line">  remotes/origin/alpha</span><br><span class="line">  remotes/origin/alpha_feature_share</span><br><span class="line">  remotes/origin/dev</span><br><span class="line">  remotes/origin/develop</span><br><span class="line">  remotes/origin/learn_pixi</span><br><span class="line">  remotes/origin/master</span><br><span class="line">  remotes/origin/temp_avatar</span><br></pre></td></tr></table></figure>

<h3 id="git-remote-show-origin"><a href="#git-remote-show-origin" class="headerlink" title="git remote show origin"></a>git remote show origin</h3><p>查看remote地址，远程分支，还有本地分支与之相对应关系等信息。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">$ git remote show origin</span><br><span class="line">* remote origin</span><br><span class="line">  Fetch URL: git@code.apowo.com:PixelPai/platform-client.git</span><br><span class="line">  Push  URL: git@code.apowo.com:PixelPai/platform-client.git</span><br><span class="line">  HEAD branch: master</span><br><span class="line">  Remote branches:</span><br><span class="line">    alpha                                        tracked</span><br><span class="line">    dev                                          tracked</span><br><span class="line">    feature_ng                                   tracked</span><br><span class="line">    feature_pretty                               tracked</span><br><span class="line">    master                                       tracked</span><br><span class="line">    refs/remotes/origin/game-core                stale (use &#x27;git remote prune&#x27; to remove)</span><br><span class="line">    refs/remotes/origin/learn_pixi               stale (use &#x27;git remote prune&#x27; to remove)</span><br><span class="line">    refs/remotes/origin/temp_avatar              stale (use &#x27;git remote prune&#x27; to remove)</span><br><span class="line">  Local refs configured for &#x27;git push&#x27;:</span><br><span class="line">    alpha          pushes to alpha          (up to date)</span><br><span class="line">    dev            pushes to dev            (up to date)</span><br><span class="line">    feature_ng     pushes to feature_ng     (up to date)</span><br><span class="line">    feature_pretty pushes to feature_pretty (up to date)</span><br><span class="line">    master         pushes to master         (local out of date)</span><br></pre></td></tr></table></figure>

<h3 id="git-remote-prune-origin"><a href="#git-remote-prune-origin" class="headerlink" title="git remote prune origin"></a>git remote prune origin</h3><p>prune 删除<br>那些远程仓库已经不存在的分支，根据提示，使用 git remote prune origin 命令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ git remote prune origin</span><br><span class="line">Pruning origin</span><br><span class="line">URL: git@code.apowo.com:PixelPai/platform-client.git</span><br><span class="line"> * [pruned] origin/alpha_feature_share</span><br><span class="line"> * [pruned] origin/develop</span><br><span class="line"> * [pruned] origin/feature_maker_avatar</span><br><span class="line"> * [pruned] origin/feature_new_game_cover</span><br><span class="line"> * [pruned] origin/temp_avatar</span><br></pre></td></tr></table></figure>

<h2 id="再次添加gitlab分支"><a href="#再次添加gitlab分支" class="headerlink" title="再次添加gitlab分支"></a>再次添加gitlab分支</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"># niekaifa @ niekaifadeMacBook-Pro in ~/workspace/apowo/cordova-plugin-android-keyboard on git:master o [16:56:02] </span><br><span class="line">$ git remote -v</span><br><span class="line">origin  git@github.com:ApowoGames/cordova-plugin-android-keyboard.git (fetch)</span><br><span class="line">origin  git@github.com:ApowoGames/cordova-plugin-android-keyboard.git (push)</span><br><span class="line"></span><br><span class="line"># niekaifa @ niekaifadeMacBook-Pro in ~/workspace/apowo/cordova-plugin-android-keyboard on git:master o [16:56:07] </span><br><span class="line">$ git remote add gitlab git@code.apowo.com:opensource/cordova-plugin-android-keyboard.git</span><br><span class="line"></span><br><span class="line"># niekaifa @ niekaifadeMacBook-Pro in ~/workspace/apowo/cordova-plugin-android-keyboard on git:master o [16:56:33] </span><br><span class="line">$ git status</span><br><span class="line">On branch master</span><br><span class="line">nothing to commit, working tree clean</span><br><span class="line"></span><br><span class="line"># niekaifa @ niekaifadeMacBook-Pro in ~/workspace/apowo/cordova-plugin-android-keyboard on git:master o [16:56:36] </span><br><span class="line">$ git push gitlab master</span><br><span class="line">Enumerating objects: 5, done.</span><br><span class="line">Counting objects: 100% (5/5), done.</span><br><span class="line">Delta compression using up to 4 threads</span><br><span class="line">Compressing objects: 100% (3/3), done.</span><br><span class="line">Writing objects: 100% (3/3), 323 bytes | 323.00 KiB/s, done.</span><br><span class="line">Total 3 (delta 2), reused 0 (delta 0)</span><br><span class="line">To code.apowo.com:opensource/cordova-plugin-android-keyboard.git</span><br><span class="line">   bab51cf..2d1bf8f  master -&gt; master</span><br></pre></td></tr></table></figure>

<h2 id="gitlab-添加插件"><a href="#gitlab-添加插件" class="headerlink" title="gitlab 添加插件"></a>gitlab 添加插件</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ cordova plugin add git+https://code.apowo.com/opensource/cordova-plugin-android-keyboard </span><br><span class="line">Installing &quot;cordova-plugin-android-keyboard&quot; for android</span><br><span class="line">Adding cordova-plugin-android-keyboard to package.json</span><br></pre></td></tr></table></figure>

<h2 id="依赖gitlab项目"><a href="#依赖gitlab项目" class="headerlink" title="依赖gitlab项目"></a>依赖gitlab项目</h2><p>yarn add git+<a target="_blank" rel="noopener" href="https://code.apowo.com/PixelPai/gamecore_pkt.git">https://code.apowo.com/PixelPai/gamecore_pkt.git</a></p>
<p>yarn add git+ssh://<a href="mailto:&#103;&#x69;&#116;&#x40;&#x63;&#111;&#100;&#x65;&#x2e;&#97;&#x70;&#111;&#x77;&#111;&#46;&#x63;&#111;&#109;">&#103;&#x69;&#116;&#x40;&#x63;&#111;&#100;&#x65;&#x2e;&#97;&#x70;&#111;&#x77;&#111;&#46;&#x63;&#111;&#109;</a>:PixelPai/gamecore_pkt.git<br>ci 里面加的是ssh的key 来通过gitlab的验证的 你请求的是<a target="_blank" rel="noopener" href="https://code.apwo.com/">https://code.apwo.com</a>  如果是你本地 会在命令行中弹出 输入账号密码的提示 来通过http的验证<br>那么问题来了 你要通过http来请求嘛 如果需要 你去研究一下 怎么通过gitlab 的access-token拉取代码 然后改下ci<br>如果不需要 就改成通过git请求的；git+ssh</p>
<h1 id="错误"><a href="#错误" class="headerlink" title="错误"></a>错误</h1><h3 id="index-lock"><a href="#index-lock" class="headerlink" title="index.lock"></a>index.lock</h3><p>error:<br>Another git process seems to be running in this repository, e.g.<br>an editor opened by ‘git commit’. Please make sure all processes<br>are terminated then try again. If it still fails, a git process<br>may have crashed in this repository earlier:<br>remove the file manually to continue.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd .git</span><br><span class="line">rm index.lock</span><br></pre></td></tr></table></figure>
<p>应该是windows对进程的管理有个上锁机制，正常情况下，会上锁，进程结束，然后解锁进程。但是由于我强制关闭了运行中的git,导致git崩溃，已经上锁的index.lock没有来得及解锁而仍然存在。当我再用git add的时候，git发现已经存在了index.lock这个文件，导致报错。</p>
<h3 id="vscode-使用git"><a href="#vscode-使用git" class="headerlink" title="vscode 使用git"></a>vscode 使用git</h3><p>error：<br>git push –set-upstream origin master<br>执行一下就行</p>
<p>error：<br>Host key verification failed.<br>fatal: Could not read from remote repository.</p>
<p>Please make sure you have the correct access rights<br>and the repository exists.</p>
<p>wsl 和 windows 的混淆<br>我不是在wsl code . 启动的vscode<br>wsl 中的密钥 无法在windows中使用<br>在windows 生成密钥；命令行提交验证一次，就可以了</p>
<h3 id="gitignore文件"><a href="#gitignore文件" class="headerlink" title="gitignore文件"></a>gitignore文件</h3><p>$ git add .<br>warning: adding embedded git repository: tooqing-webapp<br>hint: You’ve added another git repository inside your current repository.<br>hint: Clones of the outer repository will not contain the contents of<br>hint: the embedded repository and will not know how to obtain it.<br>hint: If you meant to add a submodule, use:<br>hint:<br>hint:   git submodule add <url> tooqing-webapp<br>hint:<br>hint: If you added this path by mistake, you can remove it from the<br>hint: index with:<br>hint:<br>hint:   git rm –cached tooqing-webapp<br>hint:<br>hint: See “git help submodule” for more information.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git rm --cached tooqing-webapp</span><br><span class="line">git submodule add git@code.apowo.com:PixelPai/tooqing-webapp.git tooqing-webapp</span><br><span class="line">git add .</span><br><span class="line">git commit -m &#x27;cache&#x27;</span><br><span class="line">git pull origin dev</span><br></pre></td></tr></table></figure>

<h1 id="vscoed-中应用"><a href="#vscoed-中应用" class="headerlink" title="vscoed 中应用"></a>vscoed 中应用</h1><h3 id="push"><a href="#push" class="headerlink" title="push"></a>push</h3><h4 id="暂存所有更改"><a href="#暂存所有更改" class="headerlink" title="暂存所有更改"></a>暂存所有更改</h4><p>更改处 ‘+’</p>
<h4 id="提交已暂存文件"><a href="#提交已暂存文件" class="headerlink" title="提交已暂存文件"></a>提交已暂存文件</h4><p>更多操作… &gt; 提交已暂存文件<br>输入本次提交内容 描述文字</p>
<h4 id="推送-push"><a href="#推送-push" class="headerlink" title="推送 push"></a>推送 push</h4><p>更多操作… &gt; 推送</p>
<h3 id="pull"><a href="#pull" class="headerlink" title="pull"></a>pull</h3><p>更多操作… &gt; 拉取</p>
<h1 id="gitignore"><a href="#gitignore" class="headerlink" title="gitignore"></a>gitignore</h1><p>忽略所有 .a 结尾的文件<br>*.a</p>
<p>但 lib.a 除外<br>!lib.a</p>
<p>仅仅忽略项目根目录下的 TODO 文件，不包括 subdir/TODO<br>/TODO</p>
<p>忽略 build/ 目录下的所有文件<br>build/</p>
<p>会忽略 doc/notes.txt 但不包括 doc/server/notes.txt<br>doc/notes.txt</p>
<h1 id="依赖git上的库"><a href="#依赖git上的库" class="headerlink" title="依赖git上的库"></a>依赖git上的库</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add git+ssh://git@code.apowo.com:PixelPai/game-core.git#dev</span><br></pre></td></tr></table></figure>

<h1 id="子模块"><a href="#子模块" class="headerlink" title="子模块"></a>子模块</h1><h2 id="自模块冲突"><a href="#自模块冲突" class="headerlink" title="自模块冲突"></a>自模块冲突</h2><p>git submodule foreach git checkout master //所有子工程切换到master分支<br>git submodule foreach git pull          //所有子工程更新代码<br>git add 所有子工程目录<br>git commit -m “update submodule”      //这里的提交应该是更新commit id<br>//使其保持最新，与master相同</p>
<h2 id="添加"><a href="#添加" class="headerlink" title="添加"></a>添加</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git submodule add https://github.com/maonx/vimwiki-assets.git</span><br></pre></td></tr></table></figure>

<h3 id="指定分支"><a href="#指定分支" class="headerlink" title="指定分支"></a>指定分支</h3><p>git submodule add -b rpc <a href="mailto:&#103;&#105;&#x74;&#x40;&#x63;&#x6f;&#100;&#101;&#46;&#x61;&#112;&#111;&#119;&#x6f;&#x2e;&#x63;&#x6f;&#x6d;">&#103;&#105;&#x74;&#x40;&#x63;&#x6f;&#100;&#101;&#46;&#x61;&#112;&#111;&#119;&#x6f;&#x2e;&#x63;&#x6f;&#x6d;</a>:PixelPai/game-core.git src/game-core</p>
<h2 id="初始化"><a href="#初始化" class="headerlink" title="初始化"></a>初始化</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git submodule update --init</span><br></pre></td></tr></table></figure>

<h2 id="删除"><a href="#删除" class="headerlink" title="删除"></a>删除</h2><p>1、Delete the relevant section from the .gitmodules file.<br>2、Stage the .gitmodules changes:<br>   git add .gitmodules<br>3、Delete the relevant section from .git/config.<br>4、Remove the submodule files from the working tree and index:<br>   git rm –cached path_to_submodule (no trailing slash).<br>5、Remove the submodule’s .git directory:<br>   rm -rf .git/modules/path_to_submodule<br>6、Commit the changes:<br>   git commit -m “Removed submodule <name>“<br>7、Delete the now untracked submodule files:<br>   rm -rf path_to_submodule</p>
<p>逆初始化模块，其中{MOD_NAME}为模块目录，执行后可发现模块目录被清空<br>git submodule deinit {MOD_NAME}<br>删除.gitmodules中记录的模块信息（–cached选项清除.git/modules中的缓存）<br>git rm –cached {MOD_NAME}<br>提交更改到代码库，可观察到’.gitmodules’内容发生变更<br>git commit -am “Remove a submodule.” </p>
<p>删除子模块<br>有时子模块的项目维护地址发生了变化，或者需要替换子模块，就需要删除原有的子模块。</p>
<p>删除子模块较复杂，步骤如下：</p>
<p>rm -rf 子模块目录 删除子模块目录及源码<br>vi .gitmodules 删除项目目录下.gitmodules文件中子模块相关条目<br>vi .git/config 删除配置项中子模块相关条目<br>rm .git/module/* 删除模块下的子模块目录，每个子模块对应一个目录，注意只删除对应的子模块目录即可<br>执行完成后，再执行添加子模块命令即可，如果仍然报错，执行如下：</p>
<p>git rm –cached 子模块名称</p>
<p>完成删除后，提交到仓库即可。</p>
<h2 id="切换分支"><a href="#切换分支" class="headerlink" title="切换分支"></a>切换分支</h2><p>git submodule set-branch –branch feature_apk tooqing-webapp</p>
<h2 id="子模块中的子模块"><a href="#子模块中的子模块" class="headerlink" title="子模块中的子模块"></a>子模块中的子模块</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"># niekaifa @ niekaifadeMacBook-Pro in ~/workspace/apowo/tooqing-cordova/tooqing-webapp on git:feature_ipad x [16:48:11] </span><br><span class="line">$ cd public/gdk </span><br><span class="line"></span><br><span class="line"># niekaifa @ niekaifadeMacBook-Pro in ~/workspace/apowo/tooqing-cordova/tooqing-webapp/public/gdk on git:571cb30 o [16:48:19] </span><br><span class="line">$ git remote -v</span><br><span class="line">origin  https://code.apowo.com/PixelPai/apowo-jssdk (fetch)</span><br><span class="line">origin  https://code.apowo.com/PixelPai/apowo-jssdk (push)</span><br><span class="line"></span><br><span class="line"># niekaifa @ niekaifadeMacBook-Pro in ~/workspace/apowo/tooqing-cordova/tooqing-webapp/public/gdk on git:571cb30 o [16:48:22] </span><br><span class="line">$ git remote set url git@code.apowo.com:PixelPai/apowo-jssdk.git</span><br><span class="line">error: Unknown subcommand: set</span><br><span class="line">usage: git remote [-v | --verbose]</span><br><span class="line">   or: git remote add [-t &lt;branch&gt;] [-m &lt;master&gt;] [-f] [--tags | --no-tags] [--mirror=&lt;fetch|push&gt;] &lt;name&gt; &lt;url&gt;</span><br><span class="line">   or: git remote rename &lt;old&gt; &lt;new&gt;</span><br><span class="line">   or: git remote remove &lt;name&gt;</span><br><span class="line">   or: git remote set-head &lt;name&gt; (-a | --auto | -d | --delete | &lt;branch&gt;)</span><br><span class="line">   or: git remote [-v | --verbose] show [-n] &lt;name&gt;</span><br><span class="line">   or: git remote prune [-n | --dry-run] &lt;name&gt;</span><br><span class="line">   or: git remote [-v | --verbose] update [-p | --prune] [(&lt;group&gt; | &lt;remote&gt;)...]</span><br><span class="line">   or: git remote set-branches [--add] &lt;name&gt; &lt;branch&gt;...</span><br><span class="line">   or: git remote get-url [--push] [--all] &lt;name&gt;</span><br><span class="line">   or: git remote set-url [--push] &lt;name&gt; &lt;newurl&gt; [&lt;oldurl&gt;]</span><br><span class="line">   or: git remote set-url --add &lt;name&gt; &lt;newurl&gt;</span><br><span class="line">   or: git remote set-url --delete &lt;name&gt; &lt;url&gt;</span><br><span class="line"></span><br><span class="line">    -v, --verbose         be verbose; must be placed before a subcommand</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># niekaifa @ niekaifadeMacBook-Pro in ~/workspace/apowo/tooqing-cordova/tooqing-webapp/public/gdk on git:571cb30 o [16:50:02] C:129</span><br><span class="line">$ git remote set-url origin git@code.apowo.com:PixelPai/apowo-jssdk.git</span><br><span class="line"></span><br><span class="line"># niekaifa @ niekaifadeMacBook-Pro in ~/workspace/apowo/tooqing-cordova/tooqing-webapp/public/gdk on git:571cb30 o [16:50:23] </span><br><span class="line">$ git remote -v</span><br><span class="line">origin  git@code.apowo.com:PixelPai/apowo-jssdk.git (fetch)</span><br><span class="line">origin  git@code.apowo.com:PixelPai/apowo-jssdk.git (push)</span><br></pre></td></tr></table></figure>

<h1 id="runner"><a href="#runner" class="headerlink" title="runner"></a>runner</h1><h2 id="update"><a href="#update" class="headerlink" title="update"></a>update</h2><p>Ubuntu上默认直接安装了gitlab-runner，但其实安装的版本为10.5.0</p>
<p>问题：ci成功，但是没有记录<br>This job does not have a trace.</p>
<p>原因：版本太低，需要升级</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># For Debian/Ubuntu/Mint</span><br><span class="line">curl -L https://packages.gitlab.com/install/repositories/runner/gitlab-runner/script.deb.sh | sudo bash</span><br><span class="line"></span><br><span class="line"># For RHEL/CentOS/Fedora</span><br><span class="line">curl -L https://packages.gitlab.com/install/repositories/runner/gitlab-runner/script.rpm.sh | sudo bash</span><br></pre></td></tr></table></figure>
<p>再安装最近版本的gitlab-runner:<br>apt install gitlab-runner</p>
<h2 id="commond"><a href="#commond" class="headerlink" title="commond"></a>commond</h2><p>gitlab-runner list<br>ubuntu@gitlab-runner:~$ sudo gitlab-runner list<br>Runtime platform                                    arch=amd64 os=linux pid=5248 revision=775dd39d version=13.8.0<br>Listing configured runners                          ConfigFile=/etc/gitlab-runner/config.toml<br>office-docker-runner                                Executor=docker Token=ab4ebb4e3471ff403c3ea1660db90b URL=<a target="_blank" rel="noopener" href="https://code.apowo.com/">https://code.apowo.com/</a><br>office internal gitlab-runner on PVE                Executor=shell Token=xtpd6UJrwhKWGi9MXyNa URL=<a target="_blank" rel="noopener" href="https://code.apowo.com/">https://code.apowo.com/</a><br>pve-ubuntu-test-runner                              Executor=shell Token=dBbekMdeG8nDHLaK1KQU URL=<a target="_blank" rel="noopener" href="https://code.apowo.com/">https://code.apowo.com</a><br>meshtalk-ci                                         Executor=docker Token=32xMwemzbdqgmENUxePD URL=<a target="_blank" rel="noopener" href="https://code.apowo.com/">https://code.apowo.com/</a><br>only for android app build                          Executor=docker Token=uHD7nWC4NB12we3AGb5q URL=<a target="_blank" rel="noopener" href="https://code.apowo.com/">https://code.apowo.com/</a></p>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>sudo curl –output /usr/local/bin/gitlab-runner “<a target="_blank" rel="noopener" href="https://gitlab-runner-downloads.s3.amazonaws.com/latest/binaries/gitlab-runner-darwin-amd64&quot;">https://gitlab-runner-downloads.s3.amazonaws.com/latest/binaries/gitlab-runner-darwin-amd64&quot;</a><br>给权限<br>sudo chmod +x /usr/local/bin/gitlab-runner</p>
<h2 id="注册"><a href="#注册" class="headerlink" title="注册"></a>注册</h2><p>gitlab-runner register</p>
<img src="/2020/02/23/Git/register.png" class="">

<p>Enter the GitLab instance URL (for example, <a target="_blank" rel="noopener" href="https://gitlab.com/">https://gitlab.com/</a>):<br><a target="_blank" rel="noopener" href="https://code.apowo.com/">https://code.apowo.com/</a><br>Enter the registration token:<br>zwE8ePU2N8Ngcwanszgq<br>Enter a description for the runner:<br>[niekaifadeMacBook-Pro.local]: test<br>Enter tags for the runner (comma-separated):<br>test<br>Registering runner… succeeded                     runner=zwE8ePU2<br>Enter an executor: virtualbox, docker-ssh+machine, kubernetes, custom, docker-ssh, ssh, docker+machine, docker, parallels, shell:<br>shell<br>Runner registered successfully. Feel free to start it, but if it’s running already the config should be automatically reloaded! </p>
<h2 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h2><p>gitlab-runner install<br>gitlab-runner start</p>
<h2 id="start-runner"><a href="#start-runner" class="headerlink" title="start runner"></a>start runner</h2><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">test-job1:</span></span><br><span class="line">  <span class="attr">tags:</span> </span><br><span class="line">    <span class="bullet">-</span> <span class="string">custom01</span>   <span class="string">//一定要指定</span> <span class="string">tags</span> <span class="string">，runner注册的时候填的tags</span></span><br><span class="line">  <span class="attr">script:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">echo</span> <span class="string">&quot;This job tests something&quot;</span></span><br></pre></td></tr></table></figure>
<img src="/2020/02/23/Git/runner.png" class="">

<h2 id="unregister"><a href="#unregister" class="headerlink" title="unregister"></a>unregister</h2><p>gitlab-runner unregister –name test-runner</p>
<h2 id="verify"><a href="#verify" class="headerlink" title="verify"></a>verify</h2><p>gitlab-runner verify</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Verifying runner... is alive                        runner=fee9938e</span><br><span class="line">Verifying runner... is alive                        runner=0db52b31</span><br><span class="line">Verifying runner... is alive                        runner=826f687f</span><br><span class="line">Verifying runner... is alive                        runner=32773c0f</span><br></pre></td></tr></table></figure>

<h3 id="delete"><a href="#delete" class="headerlink" title="delete"></a>delete</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">ubuntu@ci-runner:~$ gitlab-runner verify --delete</span><br><span class="line">Runtime platform                                    arch=amd64 os=linux pid=10756 revision=54944146 version=13.10.0</span><br><span class="line">WARNING: Running in user-mode.</span><br><span class="line">WARNING: The user-mode requires you to manually start builds processing:</span><br><span class="line">WARNING: $ gitlab-runner run</span><br><span class="line">WARNING: Use sudo for system-mode:</span><br><span class="line">WARNING: $ sudo gitlab-runner...</span><br><span class="line"></span><br><span class="line">ERROR: Verifying runner... is removed               runner=Sf9cFJ7R</span><br><span class="line">Verifying runner... is alive                        runner=UmV1JciW</span><br><span class="line">Updated /home/ubuntu/.gitlab-runner/config.toml</span><br></pre></td></tr></table></figure>



<h2 id="yml-语法"><a href="#yml-语法" class="headerlink" title="yml 语法"></a>yml 语法</h2><p><a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000010442764">https://segmentfault.com/a/1190000010442764</a></p>
<h2 id="CI-CD"><a href="#CI-CD" class="headerlink" title="CI/CD"></a>CI/CD</h2><p>CI：Continuous Integration<br>CD：Continuous Delivery<br>CD：Continuous Deployment </p>
<h2 id="Basic-CI-CD-workflow"><a href="#Basic-CI-CD-workflow" class="headerlink" title="Basic CI/CD workflow"></a>Basic CI/CD workflow</h2><img src="/2020/02/23/Git/ci.png" class="">

<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">stages:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">build_compiler</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">build</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">build_dev</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">merge_build_test</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">deploy</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="attr">before_script:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">echo</span> <span class="string">&quot;before_scipt&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="attr">test:</span></span><br><span class="line">  <span class="attr">stage:</span></span><br><span class="line">    <span class="string">build_compiler</span></span><br><span class="line">  <span class="attr">tags:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">test</span></span><br><span class="line">  <span class="attr">script:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">echo</span> <span class="string">&quot;test&quot;</span></span><br></pre></td></tr></table></figure>

<h2 id="本地执行"><a href="#本地执行" class="headerlink" title="本地执行"></a>本地执行</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">$  gitlab-runner exec shell test</span><br><span class="line">Runtime platform                                    arch=amd64 os=darwin pid=58199 revision=775dd39d version=13.8.0</span><br><span class="line">Running with gitlab-runner 13.8.0 (775dd39d)</span><br><span class="line">Preparing the &quot;shell&quot; executor</span><br><span class="line">Using Shell executor...</span><br><span class="line">executor not supported                              job=1 project=0 referee=metrics</span><br><span class="line">Preparing environment</span><br><span class="line">Running on niekaifadeMacBook-Pro.local...</span><br><span class="line">Getting source from Git repository</span><br><span class="line">Fetching changes...</span><br><span class="line">Initialized empty Git repository in /Users/niekaifa/workspace/apowo/ci-test/builds/0/project-0/.git/</span><br><span class="line">Created fresh repository.</span><br><span class="line">Checking out bd79ba14 as master...</span><br><span class="line">Skipping Git submodules setup</span><br><span class="line">Executing &quot;step_script&quot; stage of the job script</span><br><span class="line">$ echo &quot;before_scipt&quot;</span><br><span class="line">before_scipt</span><br><span class="line">$ echo &quot;test&quot;</span><br><span class="line">test</span><br><span class="line">Job succeeded</span><br></pre></td></tr></table></figure>

<h2 id="线上打tag"><a href="#线上打tag" class="headerlink" title="线上打tag"></a>线上打tag</h2><h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><h3 id="gitlab-Runner-is-offline-last-contact-was-about-some-hours-ago"><a href="#gitlab-Runner-is-offline-last-contact-was-about-some-hours-ago" class="headerlink" title="gitlab: Runner is offline, last contact was about some hours ago"></a>gitlab: Runner is offline, last contact was about some hours ago</h3><p>解决：<br>gitlab-runner restart</p>
<h3 id="注册后"><a href="#注册后" class="headerlink" title="注册后"></a>注册后</h3><h1 id="git-flow"><a href="#git-flow" class="headerlink" title="git-flow"></a>git-flow</h1><p>brew install git-flow-avh</p>
<p>git flow version</p>
<p>初始化：<br>git flow init</p>
<p>Initialized empty Git repository in /Users/savokiss/demos/gitflow/.git/<br>No branches exist yet. Base branches must be created now.<br>Branch name for production releases: [master]<br>Branch name for “next release” development: [develop]</p>
<p>How to name your supporting branch prefixes?<br>Feature branches? [feature/]<br>Bugfix branches? [bugfix/]<br>Release branches? [release/]<br>Hotfix branches? [hotfix/]<br>Support branches? [support/]<br>Version tag prefix? [] v<br>Hooks and filters directory? [/Users/savokiss/demos/gitflow/.git/hooks]</p>
<p>开始新的功能分支<br>git flow feature start auth</p>
<p>一般都是先提交分支，测试通过后才finish</p>
<p>提交信息规范</p>
<p>提交信息应该描述 “做了什么” 和 “这么做的原因”，主要由 header， body，footer组成。<br>header的格式：<type>: <subject></p>
<p>type 用于说明提交的类型：<br>feature： 新功能<br>fix: 问题修复<br>docs: 文档<br>style: 调整格式（不影响代码运行）<br>refactor: 重构<br>test: 增加测试<br>chore: 构建过程或辅助工具的变动<br>revert: 撤销以前的提交<br>scope 用于说明提交的影响范围，内容根据具体项目而定。</p>
<p>完成feature/auth分支<br>$ git flow feature finish auth<br>Switched to branch ‘develop’<br>Updating e69b22c..f7f48e2<br>Fast-forward</p>
<h1 id="gitflow-0"><a href="#gitflow-0" class="headerlink" title="gitflow | 0"></a>gitflow | 0</h1><p> README.md | 4 ++++<br> 2 files changed, 4 insertions(+)<br> create mode 100644 # gitflow<br> create mode 100644 README.md<br>Deleted branch feature/auth (was f7f48e2).</p>
<p>Summary of actions:</p>
<ul>
<li>The feature branch ‘feature/auth’ was merged into ‘develop’</li>
<li>Feature branch ‘feature/auth’ has been locally deleted</li>
<li>You are now on branch ‘develop’</li>
</ul>
<h2 id="提交信息规范"><a href="#提交信息规范" class="headerlink" title="提交信息规范"></a>提交信息规范</h2><p>提交信息应该描述 “做了什么” 和 “这么做的原因”，主要由 header， body，footer组成。<br>header的格式：<type>: <subject></p>
<p>type 用于说明提交的类型：</p>
<ol>
<li>feature： 新功能</li>
<li>fix: 问题修复</li>
<li>docs: 文档</li>
<li>style: 调整格式（不影响代码运行）</li>
<li>refactor: 重构</li>
<li>test: 增加测试</li>
<li>chore: 构建过程或辅助工具的变动</li>
<li>revert: 撤销以前的提交</li>
<li>scope 用于说明提交的影响范围，内容根据具体项目而定。</li>
</ol>
<h1 id="问题-1"><a href="#问题-1" class="headerlink" title="问题"></a>问题</h1><h2 id="提交代码，但github上的绿格子没有变绿"><a href="#提交代码，但github上的绿格子没有变绿" class="headerlink" title="提交代码，但github上的绿格子没有变绿"></a>提交代码，但github上的绿格子没有变绿</h2><ul>
<li>检查下在本仓库上的帐号与github上是否一致</li>
<li>master分支<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># niekaifa @ Mac-mini in ~/ikyu/KilFront/vue-project on git:master o [15:58:05] </span><br><span class="line">$ git config user.email                      </span><br><span class="line">kaifawebb@gmail.com</span><br><span class="line"></span><br><span class="line"># niekaifa @ Mac-mini in ~/ikyu/KilFront/vue-project on git:master o [15:58:02] C:130</span><br><span class="line">$ git config user.email &quot;kaifawebb@gmail.com&quot;</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="警告"><a href="#警告" class="headerlink" title="警告"></a>警告</h2><p>We found a potential security vulnerability in one of your dependencies<br>github上删除 package-lock.json</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/02/23/Nodejs/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kil">
      <meta itemprop="description" content="心如止水，潜心修行">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Kil Notes">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/02/23/Nodejs/" class="post-title-link" itemprop="url">Nodejs</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-02-23 18:58:37" itemprop="dateCreated datePublished" datetime="2020-02-23T18:58:37+08:00">2020-02-23</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Nodejs/" itemprop="url" rel="index"><span itemprop="name">Nodejs</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Base"><a href="#Base" class="headerlink" title="Base"></a>Base</h1><p>历史版本：<a target="_blank" rel="noopener" href="https://nodejs.org/zh-cn/download/releases/">https://nodejs.org/zh-cn/download/releases/</a><br>版本一览表：<a target="_blank" rel="noopener" href="https://github.com/nodejs/Release">https://github.com/nodejs/Release</a></p>
<h2 id="查看当前镜像源"><a href="#查看当前镜像源" class="headerlink" title="查看当前镜像源"></a>查看当前镜像源</h2><p>npm config get registry</p>
<h1 id="what"><a href="#what" class="headerlink" title="what"></a>what</h1><p>JavaScript的服务器版本</p>
<p>优点：</p>
<ul>
<li>便于前端人员上手</li>
<li>性能高 （基于chrome v8引擎开发，v8引擎会做预编译，比原生代码快）</li>
<li>利于和前端代码整合  （比如校验，前后用一套）</li>
</ul>
<p>用途：</p>
<ul>
<li>很少用于主力服务器开发语言</li>
<li>中间层语言 (大公司会用，为了安全)<ul>
<li>充分利用已有代码、增强主服务代码的独立性</li>
<li>安全性</li>
<li>性能</li>
<li>丰富接口功能</li>
</ul>
</li>
<li>工具开发  （webpack）</li>
</ul>
<img src="/2020/02/23/Nodejs/middle.png" class="">


<h1 id="nvm"><a href="#nvm" class="headerlink" title="nvm"></a>nvm</h1><p>node 版本管理器</p>
<h2 id="install"><a href="#install" class="headerlink" title="install"></a>install</h2><p>curl -o- <a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/nvm-sh/nvm/v0.37.2/install.sh">https://raw.githubusercontent.com/nvm-sh/nvm/v0.37.2/install.sh</a> | bash</p>
<p>nvm   command not found<br>.zshrc 添加如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source ~/.nvm/nvm.sh</span><br></pre></td></tr></table></figure>

<h2 id="uninstall"><a href="#uninstall" class="headerlink" title="uninstall"></a>uninstall</h2><p>$ nvm use system<br>$ npm uninstall -g a_module</p>
<h2 id="use"><a href="#use" class="headerlink" title="use"></a>use</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ nvm install 14.16.0</span><br><span class="line">Downloading and installing node v14.16.0...</span><br><span class="line">Downloading https://nodejs.org/dist/v14.16.0/node-v14.16.0-darwin-x64.tar.xz...</span><br><span class="line">################################################################################################# 100.0%</span><br><span class="line">Computing checksum with shasum -a 256</span><br><span class="line">Checksums matched!</span><br><span class="line">Now using node v14.16.0 (npm v6.14.11)</span><br><span class="line">Creating default alias: default -&gt; 14.16.0 (-&gt; v14.16.0)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ nvm use v14.16.0</span><br><span class="line">Now using node v14.16.0 (npm v6.14.11)</span><br></pre></td></tr></table></figure>

<h2 id="查看安装的版本"><a href="#查看安装的版本" class="headerlink" title="查看安装的版本"></a>查看安装的版本</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">$ nvm ls</span><br><span class="line">-&gt;     v12.22.1</span><br><span class="line">       v14.16.0</span><br><span class="line">         system</span><br><span class="line">default -&gt; 14.16.0 (-&gt; v14.16.0)</span><br><span class="line">iojs -&gt; N/A (default)</span><br><span class="line">unstable -&gt; N/A (default)</span><br><span class="line">node -&gt; stable (-&gt; v14.16.0) (default)</span><br><span class="line">stable -&gt; 14.16 (-&gt; v14.16.0) (default)</span><br><span class="line">lts/* -&gt; lts/fermium (-&gt; N/A)</span><br><span class="line">lts/argon -&gt; v4.9.1 (-&gt; N/A)</span><br><span class="line">lts/boron -&gt; v6.17.1 (-&gt; N/A)</span><br><span class="line">lts/carbon -&gt; v8.17.0 (-&gt; N/A)</span><br><span class="line">lts/dubnium -&gt; v10.24.1 (-&gt; N/A)</span><br><span class="line">lts/erbium -&gt; v12.22.1</span><br><span class="line">lts/fermium -&gt; v14.16.1 (-&gt; N/A)</span><br></pre></td></tr></table></figure>

<h2 id="设置默认版本"><a href="#设置默认版本" class="headerlink" title="设置默认版本"></a>设置默认版本</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ nvm alias default 16.14.2</span><br><span class="line"># nvm set default node.js version 16.14.2</span><br><span class="line"></span><br><span class="line">$ node -v</span><br><span class="line"># v16.14.2</span><br></pre></td></tr></table></figure>

<h1 id="npx"><a href="#npx" class="headerlink" title="npx"></a>npx</h1><p>Node 自带 npm 模块，所以可以直接使用 npx 命令。万一不能用，就要手动安装一下。<br>$ npm install -g npx</p>
<h2 id="调用项目安装的模块"><a href="#调用项目安装的模块" class="headerlink" title="调用项目安装的模块"></a>调用项目安装的模块</h2><p>npx 想要解决的主要问题，就是调用项目内部安装的模块。比如，项目内部安装了测试工具 Mocha。</p>
<p>$ npm install -D mocha<br>一般来说，调用 Mocha ，只能在项目脚本和 package.json 的scripts字段里面， 如果想在命令行下调用，必须像下面这样。</p>
<p>项目的根目录下执行<br>$ node-modules/.bin/mocha –version<br>npx 就是想解决这个问题，让项目内部安装的模块用起来更方便，只要像下面这样调用就行了。</p>
<p>$ npx mocha –version</p>
<h2 id="cordova项目"><a href="#cordova项目" class="headerlink" title="cordova项目"></a>cordova项目</h2><p>npx cordova-hcp build</p>
<h1 id="npm"><a href="#npm" class="headerlink" title="npm"></a>npm</h1><p>npm —— nodejs package manager<br>cnpm —— 企业npm<br>yarn —— Facebook</p>
<h2 id="package版本号"><a href="#package版本号" class="headerlink" title="package版本号"></a>package版本号</h2><p>波浪符号（<del>）：他会更新到当前minor version（也就是中间的那位数字）中最新的版本。放到我们的例子中就是：body-parser:</del>1.15.2，这个库会去匹配更新到1.15.x的最新版本，如果出了一个新的版本为1.16.0，则不会自动升级。波浪符号是曾经npm安装时候的默认符号，现在已经变为了插入符号。<br>插入符号（^）：这个符号就显得非常的灵活了，他将会把当前库的版本更新到当前major version（也就是第一位数字）中最新的版本。放到我们的例子中就是：bluebird:^3.3.4，这个库会去匹配3.x.x中最新的版本，但是他不会自动更新到4.0.0。</p>
<h3 id="快捷启动"><a href="#快捷启动" class="headerlink" title="快捷启动"></a>快捷启动</h3><img src="/2020/02/23/Nodejs/npm-run.png" class="">
<p>设置 -&gt; 扩展 -&gt; npm -&gt; Auto Delect<br>资源管理器 -&gt; npm脚本</p>
<h2 id="config"><a href="#config" class="headerlink" title="config"></a>config</h2><p><a target="_blank" rel="noopener" href="https://docs.npmjs.com/cli/v6/commands/npm-config">config</a><br>list<br>npm config list</p>
<p>set<br>npm config set key value</p>
<h2 id="install-1"><a href="#install-1" class="headerlink" title="install"></a>install</h2><p>npm install <a target="_blank" rel="noopener" href="https://github.com/visionmedia/express">https://github.com/visionmedia/express</a> throws error.</p>
<h2 id="npm-install-express-works"><a href="#npm-install-express-works" class="headerlink" title="npm install express works."></a>npm install express works.</h2><p>Because <a target="_blank" rel="noopener" href="https://github.com/visionmedia/express">https://github.com/visionmedia/express</a> is the URL of a web page and not an npm module. Use this flavor: git+{url}.git</p>
<p>git+<a target="_blank" rel="noopener" href="https://github.com/visionmedia/express.git">https://github.com/visionmedia/express.git</a><br>or this flavor if you need SSH:</p>
<p>git+ssh://<a href="mailto:&#103;&#105;&#x74;&#x40;&#103;&#105;&#x74;&#104;&#x75;&#98;&#x2e;&#99;&#111;&#x6d;">&#103;&#105;&#x74;&#x40;&#103;&#105;&#x74;&#104;&#x75;&#98;&#x2e;&#99;&#111;&#x6d;</a>/visionmedia/express.git</p>
<h3 id="permission-denied"><a href="#permission-denied" class="headerlink" title="permission denied"></a>permission denied</h3><p>npm config set unsafe-perm=true</p>
<h3 id="spawn-cmd-exe-ENOENT-using-WSL"><a href="#spawn-cmd-exe-ENOENT-using-WSL" class="headerlink" title="spawn cmd.exe ENOENT using WSL"></a>spawn cmd.exe ENOENT using WSL</h3><p>This error stems from the fact that CRA tries to open your browser:<br>In order to skip opening the browser, add<br>BROWSER=none<br>to your .env or .env.local file</p>
<h2 id="包"><a href="#包" class="headerlink" title="包"></a>包</h2><h3 id="rimraf"><a href="#rimraf" class="headerlink" title="rimraf"></a>rimraf</h3><p>The UNIX command rm -rf for node.</p>
<h3 id="npm-run-all"><a href="#npm-run-all" class="headerlink" title="npm-run-all"></a>npm-run-all</h3><p>A CLI tool to run multiple npm-scripts in parallel or sequential.</p>
<p>Both run-s and run-p are shorthand commands. run-s is for sequential, run-p is for parallel. We can make simple plans with those commands.</p>
<h3 id="wait-on"><a href="#wait-on" class="headerlink" title="wait-on"></a>wait-on</h3><p>wait-on is a cross-platform command line utility which will wait for files, ports, sockets, and http(s) resources to become available (or not available using reverse mode)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">wait-on file1 &amp;&amp; NEXT_CMD # wait for file1, then exec NEXT_CMD </span><br><span class="line">wait-on f1 f2 &amp;&amp; NEXT_CMD # wait for both f1 and f2, the exec NEXT_CMD </span><br><span class="line">wait-on http://localhost:8000/foo &amp;&amp; NEXT_CMD # wait for http 2XX HEAD </span><br><span class="line">wait-on https://myserver/foo &amp;&amp; NEXT_CMD # wait for https 2XX HEAD </span><br><span class="line">wait-on http-get://localhost:8000/foo &amp;&amp; NEXT_CMD # wait for http 2XX GET </span><br><span class="line">wait-on https-get://myserver/foo &amp;&amp; NEXT_CMD # wait for https 2XX GET </span><br><span class="line">wait-on tcp:4000 &amp;&amp; NEXT_CMD # wait for service to listen on a TCP port </span><br><span class="line">wait-on socket:/path/mysock # wait for service to listen on domain socket </span><br><span class="line">wait-on http://unix:/var/SOCKPATH:/a/foo # wait for http HEAD on domain socket </span><br><span class="line">wait-on http-get://unix:/var/SOCKPATH:/a/foo # wait for http GET on domain socket</span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;electron:serve&quot;</span><span class="punctuation">:</span> <span class="string">&quot;wait-on http-get://localhost:4200/ &amp;&amp; npm run electron:serve-tsc &amp;&amp; electron . --serve&quot;</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure>

<h3 id="class-transformer"><a href="#class-transformer" class="headerlink" title="class-transformer"></a>class-transformer</h3><p>普通对象是 <code>Object</code>类的实例对象。当使用 <code>&#123;&#125;</code>符号创建时，它们又被叫做 字面量 对象。类对象是具有自己定义的构造函数，属性和方法的类的实例。通常，您通过“类”表示法定义它们。</p>
<h3 id="archiver"><a href="#archiver" class="headerlink" title="archiver"></a>archiver</h3><p>压缩文件</p>
<h3 id="fs-extra"><a href="#fs-extra" class="headerlink" title="fs-extra"></a>fs-extra</h3><h4 id="ensureFile-创建文件"><a href="#ensureFile-创建文件" class="headerlink" title="ensureFile 创建文件"></a>ensureFile 创建文件</h4><p>确保文件存在。如果被请求的文件的目录不存在,创建这些目录。如果文件已经存在,它不修改。<br>异步:<br>createFile()<br>同步:<br>createFileSync(),ensureFileSync()</p>
<h2 id="npx-1"><a href="#npx-1" class="headerlink" title="npx"></a>npx</h2><h3 id="检查版本"><a href="#检查版本" class="headerlink" title="检查版本"></a>检查版本</h3><p>查看本项目依赖版本<br>当前项目的路径去找：node_modules</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ npx webpack -v</span><br><span class="line">webpack 5.11.1</span><br><span class="line">webpack-cli 4.3.0</span><br></pre></td></tr></table></figure>

<h2 id="npm-link"><a href="#npm-link" class="headerlink" title="npm link"></a>npm link</h2><p>把本地的模块link到一个我们的npm的标准的模块里面去</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/lib/node_modules/toolchain -&gt; </span><br><span class="line">/home/kil/.npm-global/lib/node_modules/generator-toolchain -&gt; /d/code/github/toolchain</span><br></pre></td></tr></table></figure>

<h2 id="将插件发布到npm"><a href="#将插件发布到npm" class="headerlink" title="将插件发布到npm"></a>将插件发布到npm</h2><p>npm login<br>npm pulish</p>
<h1 id="指令"><a href="#指令" class="headerlink" title="指令"></a>指令</h1><p>npm 查看全局安装过的包</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm list --depth=0 --global</span><br></pre></td></tr></table></figure>
<p>npm list    显示安装过的包<br>-g    指全局安装过的包<br>–depth 0    限制输出模块层级</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ npm list -g</span><br><span class="line">/home/kil/.npm-global/lib</span><br><span class="line">├─┬ node-sass@4.13.1</span><br><span class="line">│ ├── async-foreach@0.1.3</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#全局查看包</span><br><span class="line">$ npm ls --global pnpm</span><br><span class="line">/Users/niekaifa/.nvm/versions/node/v14.16.0/lib</span><br><span class="line">└── pnpm@6.30.1</span><br><span class="line"></span><br><span class="line">#删除全局包</span><br><span class="line">$ npm rm --global pnpm</span><br><span class="line">removed 1 package in 0.151s</span><br><span class="line"></span><br><span class="line">$ npm ls --global pnpm</span><br><span class="line">/Users/niekaifa/.nvm/versions/node/v14.16.0/lib</span><br><span class="line">└── (empty)</span><br><span class="line"></span><br><span class="line">#安装全局包</span><br><span class="line">$ npm install -g pnpm</span><br></pre></td></tr></table></figure>

<h1 id="process"><a href="#process" class="headerlink" title="process"></a>process</h1><p>在node中，有全局变量process表示的是当前的node进程。process.env包含着关于系统环境的信息。但是process.env中并不存在NODE_ENV这个东西。NODE_ENV是用户一个自定义的变量，在webpack中它的用途是判断生产环境或开发环境的依据的。</p>
<p>为了查看 process的基本信息，我们可以进入到 node 的repl 环境中，然后执行 process.env 命令，查看相关信息</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">process.env &#123;</span><br><span class="line">  NVM_INC: &#x27;/Users/niekaifa/.nvm/versions/node/v14.16.0/include/node&#x27;,</span><br><span class="line">  npm_package_devDependencies_awesome_typescript_loader: &#x27;^5.2.1&#x27;,</span><br><span class="line">  npm_package_dependencies__angular_forms: &#x27;11.2.7&#x27;,</span><br><span class="line">  npm_package_dependencies__angular_router: &#x27;11.2.7&#x27;,</span><br><span class="line">  npm_package_devDependencies_source_map_loader: &#x27;^0.2.4&#x27;,</span><br><span class="line">  TERM_PROGRAM: &#x27;vscode&#x27;,</span><br><span class="line">  npm_package_devDependencies_file_loader: &#x27;^2.0.0&#x27;,</span><br><span class="line">  NODE: &#x27;/Users/niekaifa/.nvm/versions/node/v14.16.0/bin/node&#x27;,</span><br><span class="line">  npm_config_version_git_tag: &#x27;true&#x27;,</span><br><span class="line">  npm_package_dependencies_moment: &#x27;^2.23.0&#x27;,</span><br><span class="line">  npm_package_devDependencies_terser_webpack_plugin: &#x27;^1.2.3&#x27;,</span><br><span class="line">  npm_package_devDependencies_typescript: &#x27;~4.1.5&#x27;,</span><br><span class="line">  ANDROID_HOME: &#x27;/Users/niekaifa/Library/Android/sdk&#x27;,</span><br><span class="line">  NVM_CD_FLAGS: &#x27;-q&#x27;,</span><br></pre></td></tr></table></figure>

<h2 id="cross-env"><a href="#cross-env" class="headerlink" title="cross-env"></a>cross-env</h2><p>它是运行跨平台设置和使用环境变量的脚本。</p>
<p>它的作用是啥？<br>当我们使用 NODE_ENV = production 来设置环境变量的时候，大多数windows命令会提示将会阻塞或者异常，或者，windows不支持NODE_ENV=development的这样的设置方式，会报错。因此 cross-env 出现了。我们就可以使用 cross-env命令，这样我们就不必担心平台设置或使用环境变量了。也就是说 cross-env 能够提供一个设置环境变量的scripts，这样我们就能够以unix方式设置环境变量，然而在windows上也能够兼容的。<br>要使用该命令的话，我们首先需要在我们的项目中进行安装该命令，安装方式如下：</p>
<p>npm install –save-dev cross-env</p>
<p>然后在package.json中的scripts命令如下如下：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;dev&quot;</span><span class="punctuation">:</span> <span class="string">&quot;cross-env NODE_ENV=development webpack-dev-server --progress --colors --devtool cheap-module-eval-source-map --hot --inline&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;build&quot;</span><span class="punctuation">:</span> <span class="string">&quot;cross-env NODE_ENV=production webpack --progress --colors --devtool cheap-module-source-map&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;build:dll&quot;</span><span class="punctuation">:</span> <span class="string">&quot;webpack --config webpack.dll.config.js&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h1 id="API"><a href="#API" class="headerlink" title="API"></a>API</h1><h2 id="fs-文件系统"><a href="#fs-文件系统" class="headerlink" title="fs 文件系统"></a>fs 文件系统</h2><h3 id="fs-existsSync-path"><a href="#fs-existsSync-path" class="headerlink" title="fs.existsSync(path)"></a>fs.existsSync(path)</h3><p>path <string> | <Buffer> | <URL><br>返回: <boolean><br>如果路径存在，则返回 true，否则返回 false。</p>
<h3 id="stat"><a href="#stat" class="headerlink" title="stat"></a>stat</h3><p>1.异步版：fs.stat(path,callback):<br>    path是一个表示路径的字符串,callback接收两个参数(err,stats),其中stats就是fs.stats的一个实例；</p>
<p>2.同步版：fs.statSync(path)<br>   只接收一个path变量，fs.statSync(path)其实是一个fs.stats的一个实例；</p>
<p>3.再来看fs.stats有以下方法:<br>    stats.isFile()<br>    stats.isDirectory()<br>    stats.isBlockDevice()<br>    stats.isCharacterDevice()<br>    stats.isSymbolicLink() (only valid with fs.lstat())<br>    stats.isFIFO()<br>    stats.isSocket()</p>
<h2 id="path"><a href="#path" class="headerlink" title="path"></a>path</h2><p>path.resolve<br>方法会把一个路径或路径片段的序列解析为一个绝对路径。</p>
<h3 id="posix"><a href="#posix" class="headerlink" title="posix"></a>posix</h3><p>path.posix 返回POSIX(Mac/Linux)系统的path执行<br>返回的对象总会按照POSIX(Mac/Linux)的方式处理路径。</p>
<h2 id="os操作系统"><a href="#os操作系统" class="headerlink" title="os操作系统"></a>os操作系统</h2><h3 id="os-homedir"><a href="#os-homedir" class="headerlink" title="os.homedir()"></a>os.homedir()</h3><p>返回当前用户的主目录的字符串路径。</p>
<h2 id="request"><a href="#request" class="headerlink" title="request"></a>request</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> res = <span class="title function_">request</span>(<span class="string">&#x27;GET&#x27;</span>, <span class="string">`https://osd-alpha.tooqing.com/app/batchupdate/v<span class="subst">$&#123;cordovaHcp.previous_batch_update_version&#125;</span>/chcp.manifest`</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;previous&#x27;</span>, <span class="title class_">JSON</span>.<span class="title function_">parse</span>(res.<span class="title function_">getBody</span>()));</span><br></pre></td></tr></table></figure>

<h1 id="升级"><a href="#升级" class="headerlink" title="升级"></a>升级</h1><h2 id="使用npm安装全局n模块"><a href="#使用npm安装全局n模块" class="headerlink" title="使用npm安装全局n模块"></a>使用npm安装全局n模块</h2><p>npm install -g n</p>
<h2 id="使用n模块升级node"><a href="#使用n模块升级node" class="headerlink" title="使用n模块升级node"></a>使用n模块升级node</h2><h3 id="升级到稳定版"><a href="#升级到稳定版" class="headerlink" title="升级到稳定版"></a>升级到稳定版</h3><p>sudo n stable</p>
<p>安装成功 node -v</p>
<h3 id="最新版"><a href="#最新版" class="headerlink" title="最新版"></a>最新版</h3><p>n latest</p>
<h2 id="更新全局安装包"><a href="#更新全局安装包" class="headerlink" title="更新全局安装包"></a>更新全局安装包</h2><p>npm update -g jshint</p>
<p>设置环境变量<br>To reset the command location hash either start a new shell, or execute PATH=”$PATH”<br>PATH=”$PATH”<br>root@VM-0-4-ubuntu:~# node –version<br>v15.3.0</p>
<h1 id="模块系统"><a href="#模块系统" class="headerlink" title="模块系统"></a>模块系统</h1><h2 id="定义模块"><a href="#定义模块" class="headerlink" title="定义模块"></a>定义模块</h2><h3 id="exports"><a href="#exports" class="headerlink" title="exports"></a>exports</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">exports</span>.<span class="property">a</span> = <span class="number">12</span>;</span><br><span class="line"><span class="built_in">exports</span>.<span class="property">b</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">5</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="module"><a href="#module" class="headerlink" title="module"></a>module</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;aaa&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="keyword">class</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">a, b</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">a</span> = a;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">b</span> = b;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">sum</span>(<span class="params"></span>)&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="引入模块"><a href="#引入模块" class="headerlink" title="引入模块"></a>引入模块</h2><p>require</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"></span><br><span class="line">fs.<span class="title function_">writeFile</span>(<span class="string">&#x27;a.txt&#x27;</span>, <span class="string">&#x27;adsdfs&#x27;</span>, <span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (err) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;有错&#x27;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;成功&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="两种方法"><a href="#两种方法" class="headerlink" title="两种方法"></a>两种方法</h3><p>1、系统node_modules/本地node_modules/父目录node_modules</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>(<span class="string">&#x27;http&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>2、自定义模块/具体地址</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>(<span class="string">&#x27;/xx/xx/http&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h1 id="koa"><a href="#koa" class="headerlink" title="koa"></a>koa</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">Koa</span> = <span class="built_in">require</span>(<span class="string">&#x27;koa&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> server = <span class="keyword">new</span> <span class="title class_">Koa</span>();</span><br><span class="line">server.<span class="title function_">listen</span>(<span class="number">8081</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;server start&#x27;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">server.<span class="title function_">use</span>(<span class="keyword">async</span> ctx =&gt; &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;query:&#x27;</span>, ctx.<span class="property">query</span>);</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">let</span> &#123;a, b&#125; = ctx.<span class="property">query</span>;</span><br><span class="line"></span><br><span class="line">  ctx.<span class="title function_">set</span>(<span class="string">&#x27;Access-Control-Allow-Origin&#x27;</span>, <span class="string">&#x27;*&#x27;</span>);</span><br><span class="line">  ctx.<span class="property">body</span>=<span class="built_in">parseInt</span>(a) + <span class="built_in">parseInt</span>(b);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h1 id="npm-1"><a href="#npm-1" class="headerlink" title="npm"></a>npm</h1><h2 id="script"><a href="#script" class="headerlink" title="script"></a>script</h2><p>npm 允许在package.json文件里面，使用scripts字段定义脚本命令。</p>
<h3 id="传参"><a href="#传参" class="headerlink" title="传参"></a>传参</h3><p>–</p>
<h3 id="执行顺序"><a href="#执行顺序" class="headerlink" title="执行顺序"></a>执行顺序</h3><p>如果是并行执行（即同时的平行执行），可以使用&amp;符号。<br>$ npm run script1.js &amp; npm run script2.js<br>如果是继发执行（即只有前一个任务成功，才执行下一个任务），可以使用&amp;&amp;符号。<br>$ npm run script1.js &amp;&amp; npm run script2.js</p>
<h3 id="钩子"><a href="#钩子" class="headerlink" title="钩子"></a>钩子</h3><p>npm 脚本有pre和post两个钩子。举例来说，build脚本命令的钩子就是prebuild和postbuild。</p>
<p>“prebuild”: “echo I run before the build script”,<br>“build”: “cross-env NODE_ENV=production webpack”,<br>“postbuild”: “echo I run after the build script”</p>
<p>用户执行npm run build的时候，会自动按照下面的顺序执行。<br>npm run prebuild &amp;&amp; npm run build &amp;&amp; npm run postbuild</p>
<h3 id="简写形式"><a href="#简写形式" class="headerlink" title="简写形式"></a>简写形式</h3><p>四个常用的 npm 脚本有简写形式。</p>
<p>npm start是npm run start<br>npm stop是npm run stop的简写<br>npm test是npm run test的简写<br>npm restart是npm run stop &amp;&amp; npm run restart &amp;&amp; npm run start的简写</p>
<h2 id="electron"><a href="#electron" class="headerlink" title="electron"></a>electron</h2><h3 id="安装慢"><a href="#安装慢" class="headerlink" title="安装慢"></a>安装慢</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">$ npm install -g electron</span><br><span class="line">/usr/local/bin/electron -&gt; /usr/local/lib/node_modules/electron/cli.js</span><br><span class="line"></span><br><span class="line">&gt; core-js@3.6.5 postinstall /usr/local/lib/node_modules/electron/node_modules/core-js</span><br><span class="line">&gt; node -e &quot;try&#123;require(&#x27;./postinstall&#x27;)&#125;catch(e)&#123;&#125;&quot;</span><br><span class="line"></span><br><span class="line">Thank you for using core-js ( https://github.com/zloirock/core-js ) for polyfilling JavaScript standard library!</span><br><span class="line"></span><br><span class="line">The project needs your help! Please consider supporting of core-js on Open Collective or Patreon:</span><br><span class="line">&gt; https://opencollective.com/core-js</span><br><span class="line">&gt; https://www.patreon.com/zloirock</span><br><span class="line"></span><br><span class="line">Also, the author of core-js ( https://github.com/zloirock ) is looking for a good job -)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&gt; electron@9.1.0 postinstall /usr/local/lib/node_modules/electron</span><br><span class="line">&gt; node install.js</span><br><span class="line"></span><br><span class="line">Downloading electron-v9.1.0-darwin-x64.zip: [=----------------] 6% ETA: 42269.4 seconds ^C</span><br></pre></td></tr></table></figure>

<h3 id="解决办法"><a href="#解决办法" class="headerlink" title="解决办法"></a>解决办法</h3><p>npm config set electron_mirror <a target="_blank" rel="noopener" href="http://npm.taobao.org/mirrors/electron/">http://npm.taobao.org/mirrors/electron/</a></p>
<p>npm config set electron_custom_dir “8.1.1”</p>
<p>然后再全局安装 Electron：</p>
<p>npm install electron -g</p>
<h3 id="快速成功"><a href="#快速成功" class="headerlink" title="快速成功"></a>快速成功</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ npm install electron -g</span><br><span class="line">/usr/local/bin/electron -&gt; /usr/local/lib/node_modules/electron/cli.js</span><br><span class="line"></span><br><span class="line">&gt; electron@9.1.0 postinstall /usr/local/lib/node_modules/electron</span><br><span class="line">&gt; node install.js</span><br><span class="line"></span><br><span class="line">+ electron@9.1.0</span><br><span class="line">updated 1 package in 27.249s</span><br></pre></td></tr></table></figure>


<h1 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h1><p>要理解node-gyp首先要知道什么是gyp(<a target="_blank" rel="noopener" href="https://gyp.gsrc.io/index.md)%E3%80%82gyp%E5%85%B6%E5%AE%9E%E6%98%AF%E4%B8%80%E4%B8%AA%E7%94%A8%E6%9D%A5%E7%94%9F%E6%88%90%E9%A1%B9%E7%9B%AE%E6%96%87%E4%BB%B6%E7%9A%84%E5%B7%A5%E5%85%B7%EF%BC%8C%E4%B8%80%E5%BC%80%E5%A7%8B%E6%98%AF%E8%AE%BE%E8%AE%A1%E7%BB%99chromium%E9%A1%B9%E7%9B%AE%E4%BD%BF%E7%94%A8%E7%9A%84%EF%BC%8C%E5%90%8E%E6%9D%A5%E5%A4%A7%E5%AE%B6%E5%8F%91%E7%8E%B0%E6%AF%94%E8%BE%83%E5%A5%BD%E7%94%A8%E5%B0%B1%E7%94%A8%E5%88%B0%E4%BA%86%E5%85%B6%E4%BB%96%E5%9C%B0%E6%96%B9%E3%80%82%E7%94%9F%E6%88%90%E9%A1%B9%E7%9B%AE%E6%96%87%E4%BB%B6%E5%90%8E%E5%B0%B1%E5%8F%AF%E4%BB%A5%E8%B0%83%E7%94%A8GCC">https://gyp.gsrc.io/index.md)。gyp其实是一个用来生成项目文件的工具，一开始是设计给chromium项目使用的，后来大家发现比较好用就用到了其他地方。生成项目文件后就可以调用GCC</a>, vsbuild, xcode等编译平台来编译。至于为什么要有node-gyp，是由于node程序中需要调用一些其他语言编写的工具甚至是dll，需要先编译一下，否则就会有跨平台的问题，例如在windows上运行的软件copy到mac上就不能用了，但是如果源码支持，编译一下，在mac上还是可以用的。</p>
<h2 id="debug"><a href="#debug" class="headerlink" title="debug"></a>debug</h2><p>{<br>  “version”: “0.2.0”,<br>  “configurations”: [<br>      {<br>          “type”: “node”,<br>          “request”: “launch”,<br>          “name”: “Launch Program”,<br>          “program”: “${workspaceFolder}/state.js”<br>      }<br>  ]<br>}</p>
<h2 id="本地和线上依赖版本统一"><a href="#本地和线上依赖版本统一" class="headerlink" title="本地和线上依赖版本统一"></a>本地和线上依赖版本统一</h2><p>package-lock.json</p>
<h1 id="最简单的服务器"><a href="#最简单的服务器" class="headerlink" title="最简单的服务器"></a>最简单的服务器</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">&#x27;http&#x27;</span>);</span><br><span class="line"></span><br><span class="line">http.<span class="title function_">createServer</span>(<span class="keyword">function</span>(<span class="params">req, res</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;req&#x27;</span>, req);</span><br><span class="line">  res.<span class="title function_">end</span>(<span class="string">&#x27;Hello world&#x27;</span>);</span><br><span class="line">&#125;).<span class="title function_">listen</span>(<span class="number">8082</span>);</span><br></pre></td></tr></table></figure>

<h1 id="serve"><a href="#serve" class="headerlink" title="serve"></a>serve</h1><p>npm i -g serve</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/02/23/Windows/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kil">
      <meta itemprop="description" content="心如止水，潜心修行">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Kil Notes">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/02/23/Windows/" class="post-title-link" itemprop="url">Windows</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-02-23 18:56:38" itemprop="dateCreated datePublished" datetime="2020-02-23T18:56:38+08:00">2020-02-23</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Windows/" itemprop="url" rel="index"><span itemprop="name">Windows</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Base"><a href="#Base" class="headerlink" title="Base"></a>Base</h1><h2 id="version"><a href="#version" class="headerlink" title="version"></a>version</h2><p>win + R<br>输入：winver</p>
<h2 id="指令"><a href="#指令" class="headerlink" title="指令"></a>指令</h2><h3 id="进入D盘"><a href="#进入D盘" class="headerlink" title="进入D盘"></a>进入D盘</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d:</span><br></pre></td></tr></table></figure>

<h3 id="查看文件夹里面的内容"><a href="#查看文件夹里面的内容" class="headerlink" title="查看文件夹里面的内容"></a>查看文件夹里面的内容</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dir</span><br></pre></td></tr></table></figure>

<h3 id="查看文件内容"><a href="#查看文件内容" class="headerlink" title="查看文件内容"></a>查看文件内容</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">type id_rsa.pub</span><br></pre></td></tr></table></figure>

<h3 id="打开文件夹"><a href="#打开文件夹" class="headerlink" title="打开文件夹"></a>打开文件夹</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">start .</span><br></pre></td></tr></table></figure>

<h2 id="快捷键"><a href="#快捷键" class="headerlink" title="快捷键"></a>快捷键</h2><p><span class="custom_red">win + I</span> windows设置主页</p>
<h3 id="回到桌面"><a href="#回到桌面" class="headerlink" title="回到桌面"></a>回到桌面</h3><p><code>win + D</code></p>
<h3 id="截图"><a href="#截图" class="headerlink" title="截图"></a>截图</h3><p>Print Screen 屏幕截图键<br>PRINT SCREEN SYSRQ</p>
<h3 id="Chrome"><a href="#Chrome" class="headerlink" title="Chrome"></a>Chrome</h3><p>打开新的标签页，并跳转到该标签页<br><code>Ctrl + t</code><br><a target="_blank" rel="noopener" href="https://support.google.com/chrome/answer/157179?hl=zh-Hans">https://support.google.com/chrome/answer/157179?hl=zh-Hans</a></p>
<h3 id="打开磁盘"><a href="#打开磁盘" class="headerlink" title="打开磁盘"></a>打开磁盘</h3><p><code>win + E</code></p>
<h2 id="环境变量配置"><a href="#环境变量配置" class="headerlink" title="环境变量配置"></a>环境变量配置</h2><p>系统属性 &gt; 环境变量(n) &gt; 系统变量 &gt; 点击 <code>Path 一行</code> &gt; 新建(N) &gt; 粘贴软件路径 （F:\vscode\Microsoft VS Code)</p>
<h2 id="系统重装"><a href="#系统重装" class="headerlink" title="系统重装"></a>系统重装</h2><h3 id="U盘启动盘制作"><a href="#U盘启动盘制作" class="headerlink" title="U盘启动盘制作"></a>U盘启动盘制作</h3><p><a target="_blank" rel="noopener" href="https://www.laomaotao.net/">老毛桃</a><br><a target="_blank" rel="noopener" href="https://www.laomaotao.net/doc/udiskwinpe.html">老毛桃教程</a></p>
<h3 id="系统下载"><a href="#系统下载" class="headerlink" title="系统下载"></a>系统下载</h3><p><a target="_blank" rel="noopener" href="https://msdn.itellyou.cn/">msdn</a><br>选择：consumer editions，里面包含家庭版、教育版、专业版</p>
<p>下载后，进行SHA1校验（<a target="_blank" rel="noopener" href="https://share.weiyun.com/5gtDK6E">iHasher</a>），复制到U盘根目录</p>
<h3 id="引导安装后，激活"><a href="#引导安装后，激活" class="headerlink" title="引导安装后，激活"></a>引导安装后，激活</h3><p>1.淘宝买激活码<br>2.用破解工具：<a target="_blank" rel="noopener" href="http://www.yishimei.cn/network/319.html">http://www.yishimei.cn/network/319.html</a></p>
<h2 id="设置"><a href="#设置" class="headerlink" title="设置"></a>设置</h2><h3 id="默认浏览器"><a href="#默认浏览器" class="headerlink" title="默认浏览器"></a>默认浏览器</h3><p><a target="_blank" rel="noopener" href="https://support.microsoft.com/zh-cn/help/4028606/windows-10-change-your-default-browser">https://support.microsoft.com/zh-cn/help/4028606/windows-10-change-your-default-browser</a></p>
<h3 id="语言设置"><a href="#语言设置" class="headerlink" title="语言设置"></a>语言设置</h3><img src="/2020/02/23/Windows/language.png" class="">

<h3 id="设置开机启动"><a href="#设置开机启动" class="headerlink" title="设置开机启动"></a>设置开机启动</h3><p>禁用<br>win 搜索框搜索：msconfig，打开系统配置，切换到启动项，打开任务资源管理器，切换到启动</p>
<p>启用<br>win + R；输入指令：shell:startup, 复制图标即可</p>
<h3 id="代理"><a href="#代理" class="headerlink" title="代理"></a>代理</h3><p>windows<br>cmd<br>设置临时代理（关闭cmd即设置的代理消失）<br>set all_proxy=socks5://127.0.0.1:10808 (端口号为你代理软件socks5协议的端口)<br>删除临时代理<br>set all_proxy=<br>查看当前环境变量<br>set<br>查看当前公网ip判断代理是否成功<br>curl cip.cc</p>
<p>powershell<br>设置临时代理（关闭powershell即设置的代理消失）<br>$env:all_proxy=”socks5://127.0.0.1:10808” (端口号为你代理软件socks5协议的端口)<br>删除当前临时代理<br>$env:all_proxy=””<br>查看当前环境变量<br>ls env:*<br>暂不知晓curl 和 ping层面上检测代理是否成功,设置完临时代理，通过命令行界面已成功获得下载相关速度</p>
<h1 id="Issues"><a href="#Issues" class="headerlink" title="Issues"></a>Issues</h1><h2 id="Please-run-SwitchHosts-as-an-Administrator-原因"><a href="#Please-run-SwitchHosts-as-an-Administrator-原因" class="headerlink" title="Please run SwitchHosts! as an Administrator 原因"></a>Please run SwitchHosts! as an Administrator 原因</h2><ol>
<li>进入 C:\Windows\System32\drivers\etc，查看hosts文件属性</li>
<li>1 取消文件只读状态</li>
<li>修改用户权限,文件属性-&gt;安全</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/02/23/%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%B7%A5%E5%85%B7/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kil">
      <meta itemprop="description" content="心如止水，潜心修行">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Kil Notes">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/02/23/%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%B7%A5%E5%85%B7/" class="post-title-link" itemprop="url">命令行工具</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-02-23 18:19:54" itemprop="dateCreated datePublished" datetime="2020-02-23T18:19:54+08:00">2020-02-23</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Tool/" itemprop="url" rel="index"><span itemprop="name">Tool</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Base"><a href="#Base" class="headerlink" title="Base"></a>Base</h1><h2 id="zsh设置代理"><a href="#zsh设置代理" class="headerlink" title="zsh设置代理"></a>zsh设置代理</h2><p>brew下载太慢</p>
<p>sudo vim ~/.zshrc 添加<br>export ALL_PROXY=socks5://127.0.0.1:1086</p>
<h2 id="终端主题"><a href="#终端主题" class="headerlink" title="终端主题"></a>终端主题</h2><img src="/2020/02/23/%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%B7%A5%E5%85%B7/terminal_theme.png" class="">

<p>第一步 → 把 oh-my-zsh 项目 Clone 下来：</p>
<p>git clone <a target="_blank" rel="noopener" href="https://github.com/robbyrussell/oh-my-zsh.git">https://github.com/robbyrussell/oh-my-zsh.git</a> ~/.oh-my-zsh<br>第二步 → 复制 .zshrc</p>
<p><code>cp ~/.oh-my-zsh/templates/zshrc.zsh-template ~/.zshrc</code><br>第三步 → 更改你的默认 Shell</p>
<p>chsh -s /bin/zsh</p>
<h2 id="配置-zsh-的主题为-ys"><a href="#配置-zsh-的主题为-ys" class="headerlink" title="配置 zsh 的主题为 ys"></a>配置 zsh 的主题为 ys</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ vim ~/.zshrc </span><br><span class="line">ZSH_THEME=<span class="string">&quot;ys&quot;</span></span><br><span class="line"></span><br><span class="line">// 生效</span><br><span class="line">$ <span class="built_in">source</span> ~/.zshrc</span><br></pre></td></tr></table></figure>


<h2 id="telnet"><a href="#telnet" class="headerlink" title="telnet"></a>telnet</h2><h3 id="windows-开启"><a href="#windows-开启" class="headerlink" title="windows 开启"></a>windows 开启</h3><p>Windows 设置 &gt; 启用或关闭 Windows 功能 &gt; - [x] Telnet Client </p>
<h3 id="测试端口是否启用"><a href="#测试端口是否启用" class="headerlink" title="测试端口是否启用"></a>测试端口是否启用</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">telnet 127.0.0.1 8080</span><br></pre></td></tr></table></figure>
<p>启用失败：<br>正在连接127.0.0.1…无法打开到主机的连接。 在端口 8080: 连接失败</p>
<p>启用成功：<br>Connected to 127.0.0.1.<br>cmd 窗口名 Telnet 127.0.0.1</p>
<h2 id="which"><a href="#which" class="headerlink" title="which"></a>which</h2><p>查看可执行文件的位置</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">which</span> node</span><br><span class="line">/usr/bin/node</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/6/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><span class="page-number current">7</span><a class="page-number" href="/page/8/">8</a><a class="page-number" href="/page/9/">9</a><a class="extend next" rel="next" href="/page/8/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">kil</p>
  <div class="site-description" itemprop="description">心如止水，潜心修行</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">83</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">35</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">70</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/kilfront" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;kilfront" rel="noopener" target="_blank"><i class="github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:kaifaweb@163.com" title="E-Mail → mailto:kaifaweb@163.com" rel="noopener" target="_blank"><i class="envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class=""></i>
  </span>
  <span class="author" itemprop="copyrightHolder">kil</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="//code.jquery.com/jquery.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
